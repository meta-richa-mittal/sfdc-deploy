<apex:page standardStylesheets="false" showChat="false" showHeader="false" sidebar="false" Controller="PrintCustomerOrderInvoiceCtrl">
    <html ng-app="InvoicePrintPreviewModule" >
        <head>
            <c:CSSFiles Application="{!Application}" Application_Images="{!Application_Images}" Assests="{!Assests}" />
            <c:JsFiles Application="{!Application}" Application_Images="{!Application_Images}" Assests="{!Assests}" />  
            <apex:stylesheet value="{!Application}/css/PrintPreviewStyle.css"/>
            <apex:stylesheet value="{!Application}/css/Printcss.css"/>
            <apex:stylesheet value="{!Application}/css/PrintCustomerOrderInvoice.css"/>
            <link href="https://fonts.googleapis.com/css?family=Material+Icons&display=block" rel="stylesheet" />
            <link rel="stylesheet" href="{!JSENCODE(Assests)}/web-font/dist/bp-icons.css" />
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@blackpurl/web-components@0.1.1-beta.12/dist/themes/light.css"/>
            <script type="module" src="https://cdn.jsdelivr.net/npm/@blackpurl/web-components@0.1.1-beta.12/dist/index.js"></script>
			<script type="module" src="{!JSENCODE(Assests)}/LIT/dist/index.js" />
            
            <style type="text/css">
            	
            
            </style>
            
            <script type="text/javascript">
             var InvoicePrintPreviewModule = angular.module('InvoicePrintPreviewModule', []);
             
             /* Start: Added By Pooja 13 Feb. 2017 */
             InvoicePrintPreviewModule.filter('tel', function () {
               return function (tel) {
                   return formatTel(tel);
               };
            });
             /* End: Added By Pooja 13 Feb. 2017 */
             
             
                    InvoicePrintPreviewModule.controller('InvoicePrintPreviewController', function($scope, $window, $q, $timeout, InvoicePrintPreviewInfoService) {
                        if($scope.InvoicePrintPreviewModel == undefined) {
                            $scope.InvoicePrintPreviewModel = {};
                        }
                        $scope.parseFloat = parseFloat;
                        $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo=[];
                        $scope.InvoicePrintPreviewModel.printview = function(){
                             $timeout($window.print, 0);
                        }
                        $scope.InvoicePrintPreviewModel.showContent = false;
                        $scope.InvoicePrintPreviewModel.isDisplayTaxInvoice = {!isDisplayTaxInvoice};
                        
                        function successResponseBinding (successfulSearchResult) {
          	      			$scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo=successfulSearchResult;
                              $scope.InvoicePrintPreviewModel.companyLogoURL = $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.LogoURL;
                              $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.AmountPaid=0;
                              $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.balanceDue=0; // Ticket#1984: Added By Pooja 3 May 2017
                              for(var v = 0 ;v < $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Transactions.length;v++){
                                  if($scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Transactions[v].Method !== 'Charge Account') {
                                      $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.AmountPaid += $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Transactions[v].Amount;
                                  }
                              }
                              
                             if($scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsTaxIncludingPricing) {
                                  $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.balanceDue += $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.SubTotal - $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.AmountPaid;
                             } else {
                                  $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.balanceDue += $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.Total - $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.AmountPaid;
                             }
                             if($scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Third-Party' 
                                  && ($scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services 
                                  && $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services.length
                                  && $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail
                                  && $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail.TotalThirdPartyDeductibleAmount)) {
                                  $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.balanceDue -= $scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail.TotalThirdPartyDeductibleAmount; 
                             }
                           if(Object.keys($scope.InvoicePrintPreviewModel.InvoicePrintPreviewInfo).length != 0){
                              $scope.InvoicePrintPreviewModel.showContent = true;
                          }
                          else{
                              Notification.error("{!$Label.Generic_Error}");
                          } 
                        
                        }
                        $scope.LoadPrintPreview = function () {
                            $scope.InvoicePrintPreviewModel.customerInvoiceId = "{!JSENCODE(URLENCODE($CurrentPage.parameters.id))}";
                            $scope.InvoicePrintPreviewModel.isFinalized = "{!JSENCODE(URLENCODE($CurrentPage.parameters.isFinalized))}"; // Ticket#1984: Added By Pooja 3 May 2017
                            $scope.InvoicePrintPreviewModel.brandingLocationId = "{!JSENCODE(URLENCODE($CurrentPage.parameters.brandingLocationId))}";
                            $scope.InvoicePrintPreviewModel.isHidePartNumbersOnDocuments = {!isHidePartNumbersOnDocuments};
                            
                            // Start: Ticket#1984: Added By Pooja 5 May 2017
                            if($scope.InvoicePrintPreviewModel.isFinalized == undefined || $scope.InvoicePrintPreviewModel.isFinalized == null || $scope.InvoicePrintPreviewModel.isFinalized == ''){
                                $scope.InvoicePrintPreviewModel.isFinalized = 'true';
                            }
                            
                            
                            if($scope.InvoicePrintPreviewModel.isFinalized == 'true'){
                                $scope.InvoicePrintPreviewModel.isFinalized = true;
                            }else{
                                $scope.InvoicePrintPreviewModel.isFinalized = false;   // Ticket#1984: Added By Pooja 5 May 2017
                            }
                            // End: Ticket#1984: Added By Pooja 5 May 2017
                            
                            if($scope.InvoicePrintPreviewModel.customerInvoiceId == undefined){
                                $scope.InvoicePrintPreviewModel.customerInvoiceId = '';
                            }
                            if($scope.InvoicePrintPreviewModel.brandingLocationId) {
                            	 InvoicePrintPreviewInfoService.InvoicePrintPreviewDetailsWithBrandingLocation($scope.InvoicePrintPreviewModel.customerInvoiceId, $scope.InvoicePrintPreviewModel.isFinalized, $scope.InvoicePrintPreviewModel.brandingLocationId) //Ticket#1984: $scope.InvoicePrintPreviewModel.isFinalized: Parameter Added By Pooja 3 May 2017
                                .then(
                                    function (successfulSearchResult) {
                                      successResponseBinding(successfulSearchResult);
                                    },
                                    function (errorSearchResult) {
                                        responseData = errorSearchResult;
                                    }
                                );
                            } else {
                            
                            	 InvoicePrintPreviewInfoService.InvoicePrintPreviewDetails($scope.InvoicePrintPreviewModel.customerInvoiceId, $scope.InvoicePrintPreviewModel.isFinalized) //Ticket#1984: $scope.InvoicePrintPreviewModel.isFinalized: Parameter Added By Pooja 3 May 2017
                                .then(
                                    function (successfulSearchResult) {
                                      successResponseBinding(successfulSearchResult);
                                    },
                                    function (errorSearchResult) {
                                        responseData = errorSearchResult;
                                    }
                                );
                            
                            }
                           
                        }
                  })
                  
                  
                    InvoicePrintPreviewModule.service("InvoicePrintPreviewInfoService", function ($q) {
                    this.InvoicePrintPreviewDetails = function (InvoicePrintPreviewId, isFinalized) {
                        InvoicePrintPreviewId = encodeString(InvoicePrintPreviewId);
                        var deferred = $q.defer();
                        
                        // Ticket#1984: getCOInvoiceDetails -> getCOInvoiceDetailsWithFinalize and isFinalized parameter: Changed By Pooja 3 May 2017
                        Visualforce.remoting.Manager.invokeAction(
                            '{!$RemoteAction.PrintCustomerOrderInvoiceCtrl.getCOInvoiceDetailsWithFinalize}',
                                InvoicePrintPreviewId,isFinalized,
                            function (result, event) {
                            if (event.type == 'exception') {
                                deferred.reject(event.message);
                            } else {
                                var InvoicePrintPreview = decodeString(result);
                                var find = '\''; 
                                var re = new RegExp(find, 'g');
                                InvoicePrintPreview = InvoicePrintPreview.replace(re, '');
                                deferred.resolve(JSON.parse(InvoicePrintPreview));
                            }
                        }, {
                            escape : true
                        });
                        return deferred.promise;
                    },
                    this.InvoicePrintPreviewDetailsWithBrandingLocation = function (InvoicePrintPreviewId, isFinalized, brandingLocationId) {
                        InvoicePrintPreviewId = encodeString(InvoicePrintPreviewId);
                        brandingLocationId = encodeString(brandingLocationId);
                        var deferred = $q.defer();
                        
                        Visualforce.remoting.Manager.invokeAction(
                            '{!$RemoteAction.PrintCustomerOrderInvoiceCtrl.getCOInvoiceDetailsWithBrandingLocation}',
                                InvoicePrintPreviewId, isFinalized, brandingLocationId,
                            function (result, event) {
                            if (event.type == 'exception') {
                                deferred.reject(event.message);
                            } else {
                                var InvoicePrintPreview = decodeString(result);
                                var find = '\''; 
                                var re = new RegExp(find, 'g');
                                InvoicePrintPreview = InvoicePrintPreview.replace(re, '');
                                deferred.resolve(JSON.parse(InvoicePrintPreview));
                            }
                        }, {
                            escape : true
                        });
                        return deferred.promise;
                    }
            });
            
            </script>
        </head>
        
        <body ng-controller="InvoicePrintPreviewController" ng-init="LoadPrintPreview()" ng-cloak="ng-cloak"><!-- Added by kajal 12/08/2016 Deal Invoice -->
           <div class="watermark" ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.OrderStatus === 'Quote'">
                <img src="{!URLFOR($Resource.Application_Images, 'quote_watermark.png')}" width="500px" height="150px"/>
           </div>
           <div class="content" ng-show="InvoicePrintPreviewModel.showContent">
                <div class="PrintSection mainSection ServiceWorksheetSection">
                    <div id="PrintPreview" class ="printpreview">
                        <div class="main_section row">
                            <div class="row rowGeneral">
                                <div class="content PrintSection ServiceWorksheetPreview" >
                                    <div class="WorksheetHeaderSection">
                                        <div class="col-md-12 MB20">
											<button class="btn C11 T4 addmoreinfoBtn active_btn pull-right MR0" ng-click="InvoicePrintPreviewModel.printview()">Print</button>
										</div>
                                        <div class = "col-md-12 P0">
                                             <span class="pull-left">
                                            <img ng-src="{{InvoicePrintPreviewModel.companyLogoURL}}" height="180px;" width="180px;" class="bp-company-logo-fit-contain"/><!-- height="80px;" edited by kajal 12th april, 2017 #1847 -->
                                             </span>
                                             <div class="StoreInfoBlock" >
                                                <p class="text-capitalize storeName">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.CompanyName}}</p>
                                               <div class="storeAddress pull-left">
                                                    <p class="AddressLine">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.Address1}} {{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.Address2}}</p>
                                                    <p class="AddressLine">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.City}} &nbsp;&nbsp; {{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.State}}&nbsp;&nbsp;{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.PostalCode}} </p>
                                                    <p class="AddressLine"><label class="T3">P:</label> {{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.BusinessPhone}}</p>
                                                    <p class="AddressLine"><label class="T3">E:</label> {{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.BusinessEmail}}</p>
                                                    <p class="AddressLine1" ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.TaxId != '' && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.Country != 'Australia'">Tax ID: {{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.TaxId}}</p>
                                                    <p class="AddressLine1" ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.TaxId != '' && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.Country == 'Australia'">ABN: {{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CompanyInfo.TaxId}}</p>
                                                </div>
                                            </div>
                                             <h2 class="text-uppercase packagingSlip" ng-class="{'adjust-width-for-label' : InvoicePrintPreviewModel.isDisplayTaxInvoice }"><span ng-if="InvoicePrintPreviewModel.isDisplayTaxInvoice">Tax</span> Invoice</h2>
                                             
                                        </div>
                                        
                                        
                                        <div >
                                        <div class="col-md-12 col-xs-12 CustomerAndUnitInfo page_break">
                                            <!-- Start: Customer Info Section -->
                                            <div class="customerinfoBlock pull-left">
                                                <div class="customerinfoBlock pull-left" ng-if="!InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsShowProviderInfoOnPrintPage" >
                                                    <div class="CustomerInformationHeader  headerChange col-md-12 ">SOLD TO</div>
                                                    <h1 class="text-capitalize customerName"  ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.COType == 'Customer' ">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerName}}</h1><!-- Jim Smith -->
                                                    <h1 class="text-capitalize customerName"  ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.COType != 'Customer' ">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.COType}}</h1><!-- Jim Smith -->
                                                    <div class="CustomerAddress pull-left" ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.COType == 'Customer' ">
                                                        <p class="AddressLine">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerAddress}}</p><!-- Unit #405 -->
                                                        <p class="AddressLine">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerAddress2}}</p><!-- 7821 Rexdale Boulevard -->
                                                        <p class="AddressLine">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerCityProv}}&nbsp;&nbsp;{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerState}}</p>&nbsp;&nbsp;
                                                        <p class="AddressLine">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerPostal}}</p><!-- Toronto, Ontario -->
                                                        <p class="AddressLine1"><label class="LabelPhone">P: </label>{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerPhone}}</p>
                                                        <p><label class="labelEmail">E: </label>{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerEmail}}</p>
                                                    </div>
                                                </div>
                                                <div class="customerinfoBlock pull-left" ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsShowProviderInfoOnPrintPage" >
                                                    <div class="CustomerInformationHeader  headerChange col-md-12 ">PROVIDER</div>
                                                    <h1 class="text-capitalize customerName">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail.Name}}</h1>
                                                    <div class="CustomerAddress pull-left">
                                                        <p class="AddressLine">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail.AddressLine1}}</p>
                                                        <p class="AddressLine">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail.AddressLine2}}</p>
                                                        <p class="AddressLine">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail.AddressLine3}}</p>
                                                        <p class="AddressLine">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail.AddressLine4}}</p>
                                                    </div>
                                                </div>
                                            </div> 
                                            <!-- End: Customer Info Section -->
                                            <div class = "col-md-5 pull-right" style = " margin-top:30.48px ">
                                                <p class="CoNumber  col-md-12  P0" ><span class = "T3 col-md-4 P0">CO #:</span> <strong class = " col-md-7 co-number">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CO_Header_Id}}</strong></p>
                                                <p class="CoNumber  col-md-12  P0" ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType != 'Internal' && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType != 'Third-Party'"><span class = "T3 col-md-4 P0">PO #:</span> <span class = " col-md-7">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerPONumber}}</span></p>
                                                <p class="CoNumber  col-md-12  P0" ><span class = "T3 col-md-4 P0">Customer #:</span> <span class = " col-md-7">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerNumber}}</span></p>
                                                <p class="CoNumber  col-md-12  P0" ng-if="InvoicePrintPreviewModel.isFinalized"><span class = "T3 col-md-4 P0">Invoice #:</span> <span class = " col-md-7">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.InvoiceNumber}}</span></p>
                                                <p class="CoNumber  col-md-12  P0" ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Third-Party'"><span class = "T3 col-md-4 P0">Claim #:</span><span class="col-md-7">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail.ClaimNumber}}</span></p>
                                                <p class="CoNumber  col-md-12  P0" ng-if="InvoicePrintPreviewModel.isFinalized"><span class = "T3 col-md-4 P0">Date:</span> <span class = " col-md-7">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.InvoiceDate}}</span></p>
                                                <p class="CoNumber  col-md-12  P0" ng-if="!InvoicePrintPreviewModel.isFinalized"><span class = "T3 col-md-4 P0">Date:</span> <span class = " col-md-7">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CurrentDate}}</span></p>
                                                <p class="CoNumber  col-md-12  P0"><span class = "T3 col-md-4 P0  ">Sold By:</span> <span class = " col-md-7 ">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.SoldBy}}</span></p>
                                            </div>
                                        </div>
                                       <!--Start: Merchandise section --> 
                                        <div  id="Merchandies_Print_Preview_gid_container" ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COKHList.length>0 && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COKHList[0].COLIList[0].DealId == null">
                                              <table style ="width:100%">
                                              <thead> 
                                                <tr>
                                                    <th>
                                                        <div class="P0">
                                                            <p class=" col-md-12 pull-left PR0 headerChange SoHeaderName page_break" style="position:static;">Merchandise<span class ="pull-right">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.MerchandiseTotal | currency}}</span></p>
                                                        </div> 
                                                    </th>
                                                </tr>
                                               </thead>
                                               <tbody>
                                               <tr>
                                                    
                                                <table class="table pull-left" id="Merchandies_Print_Preview_ItemGrid"  >
                                                     <col width="10%" />
                                                    <col width="55%" />
                                                    <col width="10%" />
                                                     <col width="5%" />
                                                    <col width="10%" />
                                                    <col width="10%" />
                                                    
                                                    <thead>
                                                        <tr class="tableHeader T3 ">
                                                            <th class="T18">Type</th><!-- Type -->
                                                            <th class="T18">Item/Description</th>
                                                            <th class="T18 Text-center">qty</th>
                                                            <th></th>
                                                            <th class="T18 text-right ">price</th>
                                                            <th class="T18 text-right">total</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody ng-repeat = "merchandiseinfo in InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COKHList">
                                                    <!-- ng-class-even="'C2'" -->
                                                        <tr ng-show="merchandiseinfo.Id != null">
                                                            <td class="T17">Kit</td>
                                                            <td class="T17" >{{merchandiseinfo.ItemDescription}}</td>
                                                            <td class="T7"></td>
                                                            <td class="T17" ></td>
                                                            <td class="T7"></td>
                                                            <td class="T17 text-right">
                                                                <!-- <span ng-if="COlitem.SubTotal == null">{{(COlitem.Qty * COlitem.Price) | currency}}</span> -->
                                                                <span>{{merchandiseinfo.Price | currency }}</span>
                                                            </td>
                                                        </tr>
                                                        <tr ng-repeat="COlitem in merchandiseinfo.COLIList">
                                                        <!-- ng-class-even="'C2'" -->                                               
                                                            <td class="T17" ng-if = "COlitem.IsPart" 
                                                            ng-class="{'KitLineItemPL': merchandiseinfo.Id != null}">
                                                                Part
                                                            </td> 
                                                            <td class="T17" ng-if = "COlitem.IsFee" 
                                                            ng-class="{'KitLineItemPL': merchandiseinfo.Id != null}">
                                                                Fee 
                                                            </td>
                                                            <td class="T17" ng-if = "COlitem.IsLabour" 
                                                            ng-class="{'KitLineItemPL': merchandiseinfo.Id != null}">
                                                                Labor
                                                            </td>
                                                            <td class="T17" ng-if="COlitem.IsPart && InvoicePrintPreviewModel.isHidePartNumbersOnDocuments">{{COlitem.ItemDescription}}</td>
                                                       		<td class="T17" ng-if="!(COlitem.IsPart && InvoicePrintPreviewModel.isHidePartNumbersOnDocuments)">{{COlitem.Item}}</td>
                                                            <td class="T17" ng-bind="((merchandiseinfo.Id == null && COlitem.IsPart && !COlitem.NonInventoryPart && COlitem.Qty > 0 && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.OrderStatus != 'Quote') ? COlitem.QtyCommitted : COlitem.Qty)"></td>
                                                            <td class="T17" > @</td>
                                                            <td class = "T17 text-right">{{COlitem.Price | currency}}</td>
                                                            <!-- <td class="T7">{{COlitem.Total | currency}}</td> -->
                                                            <td class="T17 text-right" ng-show="merchandiseinfo.Id == null">
                                                                <span ng-if="COlitem.SubTotal == null" ng-bind="(((merchandiseinfo.Id == null && COlitem.IsPart && !COlitem.NonInventoryPart && COlitem.Qty > 0 && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.OrderStatus != 'Quote') ? (COlitem.QtyCommitted * COlitem.Price) : (COlitem.Qty * COlitem.Price)) | currency)"></span>
                                                                <span ng-if="COlitem.SubTotal != null" ng-bind="(((merchandiseinfo.Id == null && COlitem.IsPart && !COlitem.NonInventoryPart && COlitem.Qty > 0 && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.OrderStatus != 'Quote') ? (COlitem.QtyCommitted * COlitem.Price) : (COlitem.SubTotal)) | currency)"></span>
                                                            </td>
                                                      </tr>
                                                    </tbody>
                                            </table>
                                         </tr>
                                     </tbody>
                                  </table>
                                </div>
                                <!--End: Merchandise section --> 
                                <!-- Start : Deal Merchandise section --> 
                               <div  id="Merchandies_Print_Preview_gid_container" ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealCOKHList.length>0 && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealCOKHList[0].COLIList[0].DealId != null">
                                              <table style ="width:100%">
                                              <thead> 
                                                <tr>
                                                    <th>
                                                        <div class="P0">
                                                            <p class=" col-md-12 pull-left PR0 headerChange SoHeaderName page_break" style="position:static;">Deal Merchandise<span class ="pull-right">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.DealMerchandiseTotal | currency}}</span></p>
                                                        </div> 
                                                    </th>
                                                </tr>
                                               </thead>
                                               <tbody>
                                               <tr>
                                                    
                                                <table class="table pull-left" id="Merchandies_Print_Preview_ItemGrid"  >
                                                     <col width="10%" />
                                                    <col width="55%" />
                                                    <col width="10%" />
                                                     <col width="5%" />
                                                    <col width="10%" />
                                                    <col width="10%" />
                                                    
                                                    <thead>
                                                        <tr class="tableHeader T3 ">
                                                            <th class="T18">Type</th><!-- Type -->
                                                            <th class="T18">Item/Description</th>
                                                            <th class="T18 Text-center">qty</th>
                                                            <th></th>
                                                            <th class="T18 text-right ">price</th>
                                                            <th class="T18 text-right">total</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody ng-repeat = "merchandiseinfo in InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealCOKHList">
                                                    <!-- ng-class-even="'C2'" -->
                                                        <tr ng-show="merchandiseinfo.Id != null">
                                                            <td class="T17">Kit</td>
                                                            <td class="T17" >{{merchandiseinfo.ItemDescription}}</td>
                                                            <td class="T7"></td>
                                                            <td class="T17" ></td>
                                                            <td class="T7"></td>
                                                            <td class="T17 text-right">
                                                                <!-- <span ng-if="COlitem.SubTotal == null">{{(COlitem.Qty * COlitem.Price) | currency}}</span> -->
                                                                <span>{{merchandiseinfo.Price | currency }}</span>
                                                            </td>
                                                        </tr>
                                                        <tr ng-repeat="COlitem in merchandiseinfo.COLIList">
                                                        <!-- ng-class-even="'C2'" -->                                               
                                                            <td class="T17" ng-if = "COlitem.IsPart" 
                                                            ng-class="{'KitLineItemPL': merchandiseinfo.Id != null}">
                                                                Part
                                                            </td> 
                                                            <td class="T17" ng-if = "COlitem.IsFee" 
                                                            ng-class="{'KitLineItemPL': merchandiseinfo.Id != null}">
                                                                Fee 
                                                            </td>
                                                            <td class="T17" ng-if = "COlitem.IsLabour" 
                                                            ng-class="{'KitLineItemPL': merchandiseinfo.Id != null}">
                                                                Labor
                                                            </td>
                                                            <td class="T17" ng-if="COlitem.IsPart && !InvoicePrintPreviewModel.isFinalized && InvoicePrintPreviewModel.isHidePartNumbersOnDocuments">{{COlitem.ItemDescription}}</td>
                                                       		<td class="T17" ng-if="!(COlitem.IsPart && !InvoicePrintPreviewModel.isFinalized && InvoicePrintPreviewModel.isHidePartNumbersOnDocuments)">{{COlitem.Item}}</td>
                                                            <td class="T17" ng-bind="((merchandiseinfo.Id == null && COlitem.IsPart && !COlitem.NonInventoryPart && COlitem.Qty > 0) ? COlitem.QtyCommitted : COlitem.Qty)"></td>
                                                            <td class="T17" > @</td>
                                                            <td class = "T17 text-right">{{COlitem.Price | currency}}</td>
                                                            <!-- <td class="T7">{{COlitem.Total | currency}}</td> -->
                                                            <td class="T17 text-right" ng-show="merchandiseinfo.Id == null">
                                                                <span ng-if="COlitem.SubTotal == null" ng-bind="(((merchandiseinfo.Id == null && COlitem.IsPart && !COlitem.NonInventoryPart && COlitem.Qty > 0) ? (COlitem.QtyCommitted * COlitem.Price) : (COlitem.Qty * COlitem.Price)) | currency)"></span>
                                                                <span ng-if="COlitem.SubTotal != null" ng-bind="(((merchandiseinfo.Id == null && COlitem.IsPart && !COlitem.NonInventoryPart && COlitem.Qty > 0) ? (COlitem.QtyCommitted * COlitem.Price) : (COlitem.SubTotal)) | currency)"></span>
                                                            </td>
                                                      </tr>
                                                    </tbody>
                                            </table>
                                        </tr>
                                    </tbody>
                                 </table>
                               </div>
                               
                               <!-- End : Deal Merchandise section --> 
                               <!-- Service-1 section -->
                                <div class=" col-md-12 P0" style="position:static;"  id="Service_Print_Preview_gid_container" ng-repeat= "serviceInfo in InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services" ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services.length>0">
                                    <table style="width: 100%;" class = "service_Job_table_Header">
                                      <thead>
                                        <tr>
                                            <th>
                                    <div class=" col-md-12 P0" style="position:static;">
                                        <p class="T3 col-md-12 pull-left PR0 headerChange SoHeaderName page_break" style="position:static;">{{serviceInfo.Name}}<span class=" pull-right " ng-if="!serviceInfo.isDeductibleInvItem">{{serviceInfo.Total | currency}}</span></p>
                                        
                                        
                                    </div> 
                                    </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                    <div class="col-md-12 serviceOrderGrid">
                                       
                                        <table class="table pull-left" id="Print_Preview_ItemGrid">
                                            <col width="10%" />
                                            <col width="55%" />
                                            <col width="10%" />
                                             <col width="5%" />
                                            <col width="10%" />
                                            <col width="10%" />
                                            
                                            <thead>
                                                <tr class="tableHeader T3 ">
                                                    <th class="T18">Type</th>
                                                    <th class="T18">item/Description</th>
                                                    <th class="T18 Text-center">qty</th>
                                                    <th></th>
                                                    <th class="T18 text-right">price</th>
                                                    <th class="T18 text-right">total</th>
                                                </tr>
                                            </thead>
                                            <div class=" col-md-12" style="padding: 0px 6px;">
                                            <div class="col-md-12 SOHeaderInfoBlockW P0 FL T18" ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Third-Party'">
                                                <label class =" pull-left SOHeaderInfoBlockLabel">Customer: </label>
                                                <div class = "pull-left SOHeaderInfoBlockContent T17">
                                                    <p ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.COType == 'Customer'" class="T17pull-left">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CustomerName}}</p>
                                                    <p ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.COType != 'Customer'" class="T17pull-left">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.COType}}</p>
                                                </div>
                                            </div>
                                            <div class="col-md-12 SOHeaderInfoBlockW P0 FL T18"  >
                                                    <label class =" pull-left SOHeaderInfoBlockLabel">Unit: </label>
                                                    <div class = "pull-left SOHeaderInfoBlockContent T17">
                                                        <p  class = " T17pull-left">{{serviceInfo.Unit}} </p>
                                                    </div>
                                            </div>
                                            <div class="col-md-12 SOHeaderInfoBlockW P0 FL T18"  >
                                                    <label class ="pull-left SOHeaderInfoBlockLabel">{!$Label.Label_Concern}:  </label>
                                                    <div class = "pull-left SOHeaderInfoBlockContent T17">
                                                        <!-- <p class = " T17pull-left">{{serviceInfo.Concern}} </p> --> <!-- Commented by richa 06/02/2017 -->
                                                        <p ng-if="serviceInfo.ConcernList.length == 1" class = "T17 pull-left">{{serviceInfo.ConcernList[0]}} </p>
                                                        <ul ng-if="serviceInfo.ConcernList.length > 1"><li ng-repeat="concern in serviceInfo.ConcernList">{{concern}}</li></ul> <!-- Added by richa 06/02/2017 -->
                                                    </div>
                                            </div>
                                            <div class="col-md-12 SOHeaderInfoBlockW P0 FL T18" >
                                                    <label class ="pull-left SOHeaderInfoBlockLabel">{!$Label.Label_Cause}:  </label>
                                                    <div class = "pull-left SOHeaderInfoBlockContent T17">
                                                        <!-- <p class = " T17 pull-left">{{serviceInfo.Cause}} </p> --> <!-- Commented by richa 06/02/2017 -->
                                                        <p ng-if="serviceInfo.CauseList.length == 1" class = " T17pull-left">{{serviceInfo.CauseList[0]}} </p>
                                                        <ul ng-if="serviceInfo.CauseList.length > 1"><li ng-repeat="cause in serviceInfo.CauseList">{{cause}}</li></ul> <!-- Added by richa 06/02/2017 -->
                                                    </div>
                                            </div>
                                            <div class="col-md-12 SOHeaderInfoBlockW P0 FL T18"  >
                                                    <label class ="pull-left SOHeaderInfoBlockLabel">{!$Label.Label_Correction}:  </label>
                                                    <div class = "pull-left SOHeaderInfoBlockContent T17">
                                                        <!-- <p  class = " T17 pull-left">{{serviceInfo.Correction}} </p> --> <!-- Commented by richa 06/02/2017 -->
                                                        <p ng-if="serviceInfo.CorrectionList.length == 1" class = " T17pull-left">{{serviceInfo.CorrectionList[0]}} </p>
                                                        <ul ng-if="serviceInfo.CorrectionList.length > 1"><li ng-repeat="correction in serviceInfo.CorrectionList">{{correction}}</li></ul> <!-- Added by richa 06/02/2017 -->
                                                    </div>
                                            </div>
                                            <div class="col-md-12 SOHeaderInfoBlockW P0 FL T18"  >
                                                <div class="col-md-4 P0 MileageInHeader " >   
                                                    <label class ="pull-left SOHeaderInfoBlockLabel" style="padding-right: 10px;">Mileage In:  </label>

                                                    <div class = "pull-left SOHeaderInfoBlockContent SOHeaderInfoBlockContentMileageWidth">
                                                        <p class = " T17 pull-left">{{serviceInfo.MileageIn}} {{serviceInfo.MileageType}} </p>
                                                    </div>
                                                </div>
                                                <div class = "col-md-8 pull-left MileageOutHeader T18 ">
                                                    <label class =" SOHeaderInfoBlockLabel pull-left" style="padding-right: 10px;">Mileage Out:  </label>

                                                    <div class = " SOHeaderInfoBlockContent SOHeaderInfoBlockContentMileageWidth pull-left">
                                                        <p  class = "T17">{{serviceInfo.MileageOut}} {{serviceInfo.MileageType}} </p>
                                                    </div>
                                                </div>
                                            </div>
                                           
                                    </div>
                                    
                                            <tbody ng-repeat = "soGrid in serviceInfo.SOGridItems" ng-if="!serviceInfo.isDeductibleInvItem"> <!-- serviceData in serviceInfo.ServiceItems Changed by richa 14 april -->
                                                <tr ng-show="soGrid.SOKH.Id != null">
                                                    <td class=" T17">Kit</td> 
                                                    <td class=" T17">{{soGrid.SOKH.ItemDescription}}</td> 
                                                    <td class=" T17"></td>
                                                    <td class=" T17"></td> 
                                                    <td class=" T17 text-right"></td> 
                                                    <td class=" T17 text-right">{{soGrid.SOKH.FixedPrice | currency}}</td> 
                                                </tr>
                                                <tr ng-repeat="SoLi in soGrid.SOKH.SOLIList">
                                                    <td class=" T17" ng-if = "SoLi.IsPart" 
                                                    ng-class="{'KitLineItemPL': soGrid.SOKH.Id != null}">
                                                        Part
                                                    </td> 
                                                    <td class=" T17" ng-if = "SoLi.IsFee" 
                                                    ng-class="{'KitLineItemPL': soGrid.SOKH.Id != null}">
                                                        Fee 
                                                    </td>
                                                    <td class=" T17" ng-if = "SoLi.IsLabour" 
                                                    ng-class="{'KitLineItemPL': soGrid.SOKH.Id != null}">
                                                        Labor
                                                    </td>
                                                    <td class=" T17" ng-if = "SoLi.IsSublet" 
                                                    ng-class="{'KitLineItemPL': soGrid.SOKH.Id != null}">
                                                        Sublet
                                                    </td>
                                                   	<td class="T17" ng-if="SoLi.IsPart && (!InvoicePrintPreviewModel.isFinalized || InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Customer') && InvoicePrintPreviewModel.isHidePartNumbersOnDocuments">{{SoLi.ItemDescription}}</td>
                                                 	<td class="T17" ng-if="!(SoLi.IsPart && (!InvoicePrintPreviewModel.isFinalized || InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Customer') && InvoicePrintPreviewModel.isHidePartNumbersOnDocuments)">{{SoLi.ItemDesc}}</td>
                                                    <td class=" T17" ng-if = "!((!InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType || InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Customer') && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsHideHoursRateOnServiceDocuments && SoLi.IsLabour)">{{SoLi.QtyNeeded}}</td>
                                                    <td class=" T17" ng-if = "((!InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType || InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Customer') && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsHideHoursRateOnServiceDocuments && SoLi.IsLabour)"></td>
                                                    
                                                    <td class=" T17" ng-if = "!((!InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType || InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Customer') && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsHideHoursRateOnServiceDocuments && SoLi.IsLabour)">@</td>
                                                    <td class=" T17" ng-if = "((!InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType || InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Customer') && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsHideHoursRateOnServiceDocuments && SoLi.IsLabour)"></td>
                                                    
                                                    <td class=" T17 text-right" ng-if = "!((!InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType || InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Customer') && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsHideHoursRateOnServiceDocuments && SoLi.IsLabour)">{{SoLi.KitPrice | currency}}</td>
                                                    <td class=" T17 text-right" ng-if = "((!InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType || InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Customer') && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsHideHoursRateOnServiceDocuments && SoLi.IsLabour)"></td>
                                                    
                                                    <td class=" T17 text-right" ng-show="soGrid.SOKH.Id == null">
                                                        <span>{{(SoLi.QtyNeeded * SoLi.KitPrice) | currency}}</span>
                                                    </td>
                                                </tr>
                                                <!-- <tr>
                                                    <td   class=" T17" ng-if="serviceData.Type == 'Part'" >Part</td> 
                                                    <td   class=" T17" ng-if="serviceData.Type == 'Fee'" >Fee</td>
                                                    <td class=" T17"  ng-if="serviceData.Type == 'Labour'" >Labor</td>
                                                    <td  class=" T17"  ng-if="serviceData.Type == 'Part'" >{{serviceData.ItemDesc}}</td>
                                                    <td  class=" T17"  ng-if="serviceData.Type != 'Part'" >{{serviceData.ItemDescription}}</td>
                                                    <td  class=" T17">{{serviceData.Qty}}</td>
                                                    <td class=" T17" >@</td>
                                                    <td class=" T17 text-right">{{serviceData.Price | currency}}</td>
                                                    <td class="  T17 text-right ">{{serviceData.Total | currency}}</td>
                                                </tr> -->
                                                
                                            </tbody>
                                            
                                            <tbody ng-if="serviceInfo.isDeductibleInvItem"> <!-- serviceData in serviceInfo.ServiceItems Changed by richa 14 april -->
                                                <tr>
                                                    <td class=" T17"></td> 
                                                    <td class=" T17">Claim Deductible</td> 
                                                    <td class=" T17"></td>
                                                    <td class=" T17"></td> 
                                                    <td class=" T17 text-right"></td> 
                                                    <td class=" T17 text-right">{{serviceInfo.Total | currency}}</td> 
                                                </tr>
                                            </tbody>
                                            <tbody ng-if="(serviceInfo.ShopSupplyTotal > 0) && (!serviceInfo.isDeductibleInvItem)">
                                                <tr>
                                                    <td class=" T17"></td>
                                                    <td class=" T17">Shop Supplies <span ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsItemizedByLaborCode">Detail</span></td> 
                                                    <td class=" T17">1</td>
                                                    <td class=" T17" >@</td> 
                                                    <td class=" T17 text-right">{{serviceInfo.ShopSupplyTotal | currency}}</td> 
                                                    <td class=" T17 text-right">
                                                        <span>{{serviceInfo.ShopSupplyTotal | currency}}</span>
                                                    </td>
                                                </tr>
                                                <tr class="shopSuppliesDetailList" ng-if="serviceInfo.ShopSupplyDetailSet.length > 0 && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsItemizedByLaborCode">
                                                    <td class=" T17"></td>
                                                    <td class=" T17" colspan="5">
                                                        <ul class="ListTypeHypen">
                                                          <li ng-repeat="supplyValue in serviceInfo.ShopSupplyDetailSet">{{supplyValue}}</li>
                                                        </ul>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div class = " SoHeaderNotesSection" ng-if = "serviceInfo.Notes!= null" >
                                        <div class="col-md-12 col-xs-12 NotesHeader" >Notes</div>
                                        <div class="col-md-12 col-xs-12 NotesContent T17" style = "text-align: justify;">
                                        	<ul ng-if="serviceInfo.Notes.length > 0" ><li ng-repeat="notes in serviceInfo.Notes">{{notes}}</li></ul>
                                        </div>
                                        </div>
                                        
                                    </div>
                                    </tr></tbody>
                                 </table>
                                 </div>
                                  <!-- START: Added by kajal 12/08/2016 Deal Invoice -->
                                <div class=" col-md-12 P0" style="position:static;" id="Service_Print_Preview_gid_container"
                                    ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.UnitList.length>0">
                                    <table style="width: 100%;" class = "service_Job_table_Header">
                                        <thead>
                                            <tr>
                                                <th>
                                                    <div class=" col-md-12 P0" style="position:static;">
                                                        <p class="T3 col-md-12 pull-left PR0 SoHeaderName headerChange page_break" style="position:static;">
                                                            Deal
                                                            <span class=" pull-right ">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealTotal | currency}}</span>
                                                        </p>
                                                    </div> 
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        	<tr ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.CoBuyerName != null">
	                                        	<td>
	                                        	<span>Co-buyer: </span>{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.CoBuyerName}}
	                                        	</td>
                                        	</tr> 
                                            <tr>
                                                <div class="col-md-12 dealSectionGrid" ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.UnitList.length>0">
                                                    <table class="table pull-left" id="Print_Preview_ItemGrid">
                                                        <col width="20%" />
                                                        <col width="45%" />
                                                        <col width="10%" />
                                                        <col width="5%" />
                                                        <col width="10%" />
                                                        <col width="10%" />
                                                        <thead>
                                                            <tr class="tableHeader T3 ">
                                                                <th class="T18">Type</th>
                                                                <th class="T18">Item/Desc</th>
                                                                <th class="T18 Text-center">qty</th>
                                                                <th></th>
                                                                <th class="T18 text-right">price</th>
                                                                <th class="T18 text-right">total</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody ng-repeat="dealInfo in InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.UnitList" ng-init="dealItemIndex = $index">
                                                            <tr>
                                                                <td class="T17">Unit</td>
                                                                <td class="T17">{{dealInfo.ItemDesc}}</td>
                                                                <td class="T17"></td>
                                                                <td class="T17"></td>
                                                                <td class="T17 text-right" >{{dealInfo.BaseUnitPriceTotal | currency}}</td>
                                                                <td class="T17 text-right" ng-if="(dealInfo.FactoryOptionList == undefined || dealInfo.FactoryOptionList.length==0) && 
                                                                (dealInfo.DealerOptionList == undefined || dealInfo.DealerOptionList.length==0)">
                                                                {{dealInfo.DealUnitPriceAndCostTotal | currency}}</td>
                                                            </tr>
                                                            <tr ng-repeat = "factoryOptionData in dealInfo.FactoryOptionList" ng-init="factoryOptionIndex = $index">
                                                                <td class="T17"></td>
                                                                <td class="T17">{{factoryOptionData.ItemDescription}}</td>
                                                                <td class="T17"></td>
                                                                <td class="T17"></td>
                                                                <td class="T17 text-right">{{factoryOptionData.Price | currency}}</td>
                                                                <td class="T17 text-right" ng-if="dealInfo.FactoryOptionList.length>0 && (dealInfo.DealerOptionList == undefined 
                                                                || dealInfo.DealerOptionList.length==0) && (factoryOptionIndex == (dealInfo.FactoryOptionList.length-1))">
                                                                {{dealInfo.DealUnitPriceAndCostTotal | currency}}</td>
                                                            </tr>
                                                            <tr ng-repeat = "dealerInstalledOptionData in dealInfo.DealerOptionList" ng-init="dealerInstalledOptionIndex = $index">
                                                                <td class="T17"></td>
                                                                <td class="T17">{{dealerInstalledOptionData.ItemDescription}}</td>
                                                                <td class="T17"></td>
                                                                <td class="T17"></td>
                                                                <td class="T17 text-right">{{dealerInstalledOptionData.TotalPrice | currency}}</td>
                                                                <td class="T17 text-right" ng-if="dealInfo.DealerOptionList.length>0
                                                                && (dealerInstalledOptionIndex == (dealInfo.DealerOptionList.length-1))">
                                                                {{dealInfo.DealUnitPriceAndCostTotal | currency}}</td>
                                                            </tr>
                                                            <!-- Start: Added by richa 14 april -->
                                                            <tr ng-repeat-start= "optionFeeDataKH in dealInfo.DealKitHeaderList"
                                                             ng-show="optionFeeDataKH.hasChildren">
                                                                <td class="T17"></td>
                                                                <td class="T17">{{optionFeeDataKH.ItemDescription}}</td>
                                                                <td class="T17"></td>
                                                                <td class="T17"></td>
                                                                <td class="T17 text-right"></td>
                                                                <td class="T17 text-right">{{optionFeeDataKH.Price | currency}}</td>
                                                            </tr>
                                                            <tr ng-repeat = "optionFeeData in optionFeeDataKH.OptionAndFeeList">
                                                                <td class="T17"></td>
                                                                <td class="T17" ng-if="optionFeeData.PartId != null && InvoicePrintPreviewModel.isHidePartNumbersOnDocuments">{{optionFeeData.ItemDescription}}</td>
                                                 				<td class="T17" ng-if="!(optionFeeData.PartId != null && InvoicePrintPreviewModel.isHidePartNumbersOnDocuments)">{{optionFeeData.Item}}</td>
                                                                <td class="T17">{{optionFeeData.Qty}}</td>
                                                                <td class="T17">@</td>
                                                                <td class="T17 text-right">{{optionFeeData.Price | currency}}</td>
                                                                <td class="T17 text-right" ng-show="!optionFeeDataKH.hasChildren">{{optionFeeData.Total | currency}}</td>
                                                            </tr>
                                                            <tr ng-repeat-end="ng-repeat-end"></tr>
                                                            <!-- End: Added by richa 14 april -->
                                                            <!-- Start: Commented by richa 14 april -->
                                                            <!-- <tr ng-repeat = "optionFeeData in dealInfo.OptionAndFeeList">
                                                                <td class="T17"></td>
                                                                <td class="T17">{{optionFeeData.Item}}</td>
                                                                <td class="T17">{{optionFeeData.Qty}}</td>
                                                                <td class="T17">@</td>
                                                                <td class="T17 text-right">{{optionFeeData.Price | currency}}</td>
                                                                <td class="T17 text-right">{{optionFeeData.Total | currency}}</td>
                                                            </tr> -->
                                                            <!-- End: Commented by richa 14 april -->
                                                        </tbody>
                                                        <tbody ng-repeat="dealInfo in InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.TradeInList" 
                                                            ng-init="dealItemIndex = $index">
                                                            <tr>
                                                                <td class="T17">Trade</td>
                                                                <td class="T17">{{dealInfo.ItemDesc}}</td>
                                                                <td class="T17"></td>
                                                                <td class="T17"></td>
                                                                <td class="T17"></td>
                                                                <td class="T17 text-right">
                                                                    {{dealInfo.AgreedValue | currency}}
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                          <tbody ng-repeat="dealFIPInfoRec in InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealFinanceObj.FIProductList" 
                                                                ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealType == 'Financed'
                                                                         && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealFinanceObj.FIProductList.length>0" ng-init="dealFIPInfoIndex = $index">
                                                            <tr>
                                                                <td class="T17">Financing Product  </td>
                                                                <td class="T17">{{dealFIPInfoRec.ItemDescription}}</td>
                                                                <td class="T17"></td>
                                                                <td class="T17"></td>
                                                                <td class="T17 text-right">{{dealFIPInfoRec.Price | currency}}</td>
                                                                <td class="T17 text-right">
                                                                    {{dealFIPInfoRec.Price | currency}}
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- END: Added by kajal 12/08/2016 Deal Invoice -->
                                           <div class="col-md-12 P0">
                                            <div class="col-md-7 P0 leftWrappper" ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Transactions.length>0">
                                                 <div class="pull-left InvoicePaymentHeaderWrpper" style="padding-bottom: 50px;">
                                                     <div class=" col-md-12 InvoicePaymentHeader text-uppercase">
                                                        <p class="  pull-left  PR0">Invoice Payments</p>
                                                    </div>
                                                    <table class="col-md-12 "> <!-- col-md-8 -> col-md-12 Changed by richa issue of #1879 21 april -->
                                                        <col width="40%" />
                                                        <col width="30%" />
                                                        <col width="30%" /> <!-- 25% -> 30% Changed by richa issue of #1879 21 april -->
                                                        <tbody ng-repeat = "paymentInfo in InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Transactions"
                                                            ng-if="paymentInfo.Method != 'Cash Rounding'"> <!-- ng-if Added by richa #1992 -->
                                                            <tr style = " font-family: Arial; font-size: 16px; ">
                                                                <td  class=" T17" >{{paymentInfo.Method}}</td>
                                                                <td class=" T17 P0 text-left">{{paymentInfo.TransactionDate}}</td>
                                                                <td class=" T17 P0 text-right">{{paymentInfo.Amount | currency}}</td>
                                                            </tr>
                                                        </tbody>
                                                </table>
                                                </div>
                                                 <!-- <div class = "col-md-12 P0 pull-left discountAmountHeader" ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.IsDisplayDiscountAmount && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.DiscountAmount > 0">
                                                    <p class = "T17 pull-left col-md-12 P0">Discounts received on this invoice <span class = "DisplayDiscountAmount">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.DiscountAmount | currency}}</span></p>
                                                </div>  -->
                                                
                                            </div>
                                                <div class = "col-md-12 P0 pull-left discountAmountHeader" ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.IsDisplayDiscountAmount && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.DiscountAmount > 0 && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.COType != 'Internal Service'">
                                                    <p class = "T17 pull-left col-md-12 P0">Discounts received on this invoice <span class = "DisplayDiscountAmount">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.DiscountAmount | currency}}</span></p>
                                                </div>
                                            <!-- START: added by kajal 12th may, 2017 --> 
                                             
                                            <!-- END: added by kajal 12th may, 2017 -->     
                                        <div class="col-md-5 pull-right rightWrapper" ng-if= "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Merchandises.length > 0 || 
                                                                                InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Transactions.length > 0 || 
                                                                                InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services.length > 0 ||
                                                                                InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.UnitList.length > 0 ||
                                                                                InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.TradeInList.length > 0 ">
                                      <!--   <div class="col-md-12 TotalTable  pull-left">
                                             <div class=" text-uppercase  P0">
                                               <p class="  pull-left  PR0">Totals</p>
                                              </div>
                                        </div> -->
                                        <table class="col-md-12 ">
                                            <tbody style = " font-family: Arial; font-size: 16px; "  class="P0">
                                                <tr class="TotalTable-deposit">
                                                <th>Totals</th>
                                                <th></th>
                                                </tr>
                                                <tr class="extra-tr">
                                                    <td></td>
                                                </tr>
                                                <tr ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalUnits != 0">
                                                    <td class="col-md-6">Units</td>
                                                    <td class="col-md-6 text-right">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalUnits | currency}}</td>
                                                </tr>
                                                <tr ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalTradeIns != 0">
                                                    <td class="col-md-6">Trade-Ins</td>
                                                    <td class="col-md-6 text-right">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalTradeIns | currency}}</td>
                                                </tr>
                                                <tr ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalLienPayout != 0">
                                                    <td class="col-md-6">Lien Payout</td>
                                                    <td class="col-md-6 text-right">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalLienPayout | currency}}</td>
                                                </tr>
                                                <tr
                                                    ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalWarranty != 0">
                                                    <td class="col-md-6">Warranty</td>
                                                    <td class="col-md-6 text-right">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalWarranty | currency}}</td>
                                                </tr>
                                                <tr
                                                    ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalSublet != 0">
                                                    <td class="col-md-6">Sublet</td>
                                                    <td class="col-md-6 text-right">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalSublet | currency}}</td>
                                                </tr>
                                                <tr
                                                    ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalOtherProducts != 0">
                                                    <td class="col-md-6">Other Products</td>
                                                    <td class="col-md-6 text-right">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalOtherProducts | currency}}</td>
                                                </tr>
                                                
                                                <tr ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalParts != 0">
                                                    <td class=" col-md-6">Parts</td>
                                                    <td class="col-md-6 text-right">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalParts | currency}}</td>
                                                </tr>
                                                <tr
                                                    ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalLabour != 0">
                                                    <td class="col-md-6">Labor</td>
                                                    <td class="col-md-6 text-right">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalLabour | currency}}</td>
                                                </tr>
                                                <tr ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalFees != 0">
                                                    <td class="col-md-6">Fees</td>
                                                    <td class="col-md-6 text-right BB0">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalFees | currency}}</td>
                                                </tr>
                                                <tr ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalShopSupplies != 0">
                                                    <td class="col-md-6">Shop Supplies</td>
                                                    <td class="col-md-6 text-right BB0">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalShopSupplies | currency}}</td>
                                                </tr>
                                                <tr style= "border-bottom: 2px solid black !important;"
                                                    ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CompanyLocale == 'Australia'
                                                            && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.StampDuty != 0">
                                                    <td class="col-md-6">Stamp Duty</td>
                                                    <td class="col-md-6 text-right BB0">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.StampDuty | currency}}</td>
                                                </tr>                                               
                                                <tr ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalDeductible != 0 && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType != 'Third-Party'">
                                                    <td class="col-md-6">Deductible</td>
                                                    <td class="col-md-6 text-right BB0">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalDeductible | currency}}</td>
                                                </tr>
                                                <tr ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealType == 'Financed'&&  
                                                    InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalFinanceProducts != 0">
                                                    <td class="col-md-6">Financing Product</td>
                                                    <td class="col-md-6 text-right BB0">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.TotalFinanceProducts | currency}}</td>
                                                </tr>
                                                <tr style="font-weight: bold;"
                                                    ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.SubTotal != 0">
                                                    <td class="col-md-6 BR0">Sub-Total</td>
                                                    <td class="col-md-6 text-right TDB">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.SubTotal | currency}}</td>
                                                </tr>
                                                <tr ng-if="!InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsTaxIncludingPricing"
                                                    ng-repeat="tax in InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.SalesTaxList">
                                                    <td class="col-md-6">{{tax.TaxName}}</td>
                                                    <td class=" col-md-6 text-right BB0">{{tax.TaxAmount | currency}}</td>
                                                </tr>
                                                <tr style="font-weight: bold;">
                                                    <td class=" col-md-6">Total</td>
                                                    <td class=" col-md-6 text-right TDB  text-uppercase">
                                                    <span ng-if="!InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsTaxIncludingPricing">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.Total | currency}}</span>
                                                    <span ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsTaxIncludingPricing">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.SubTotal | currency}}</span>
                                                </td>
                                                </tr>
                                                <tr ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsTaxIncludingPricing"
                                                    ng-repeat="tax in InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.SalesTaxList">
                                                    <td class="col-md-6">{{tax.TaxName}} included</td>
                                                    <td class=" col-md-6 text-right BB0">{{tax.TaxAmount | currency}}</td>
                                                </tr>
                                                <tr ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealType == 'Financed'">
                                                    <td class=" col-md-8"> Agreed Downpayment</td>
                                                    <td class=" col-md-4 text-right BB0">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealFinanceObj.DownPayment * -1 | currency}} </td>
                                                </tr>
                                                 <tr style="font-weight: bold; text-transform: uppercase;" ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealType == 'Financed'">
                                                    <td class=" col-md-8"> Amount Financed</td>
                                                    <td class=" col-md-4 text-right BB0">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.Total - InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealFinanceObj.DownPayment | currency}} </td>
                                                </tr>
                                                <tr>
                                                    <td class=" col-md-8"> Amount Paid</td>
                                                    <td class=" col-md-4 text-right BB0">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.AmountPaid * -1| currency}} </td>
                                                </tr>
                                                <tr ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Third-Party' && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail.TotalThirdPartyDeductibleAmount">
                                                    <td class=" col-md-8"> Less: Deductible</td>
                                                    <td class=" col-md-4 text-right BB0">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.Services[0].ProviderDetail.TotalThirdPartyDeductibleAmount | currency}} </td>
                                                </tr>
                                                <tr ng-if="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType != 'Deal' && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealType != 'Financed'">
                                                    <td class=" col-md-8" >Balance Due</td>
                                                    <!-- Start: Ticket#1984: Commented and Added By Pooja 3 May 2017 -->
                                                    <!-- <td class="col-md-4 text-right BB0" ng-if="(InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType != 'Internal' && InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType != 'Third-Party') 
                                                        || ((InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Internal' || InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Third-Party')
                                                            && (InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.Status != 'Closed'))">
                                                        {{ InvoicePrintPreviewModel.InvoicePrintPreviewInfo.balanceDue | currency}}
                                                    </td> 
                                                    <td class=" col-md-4 text-right BB0" ng-if="((InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Internal' || InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.CheckoutType == 'Third-Party')
                                                        && (InvoicePrintPreviewModel.InvoicePrintPreviewInfo.COInvoice.Status == 'Closed'))">
                                                        {{0 | currency}}
                                                    </td> -->
                                                    <td class="col-md-4 text-right BB0" ng-if="{!isBindBalanceDue}">
                                                        {{ InvoicePrintPreviewModel.InvoicePrintPreviewInfo.balanceDue | currency}}
                                                    </td> 
                                                    <td class=" col-md-4 text-right BB0" ng-if="{!!isBindBalanceDue}">
                                                        {{0 | currency}}
                                                    </td>
                                                </tr>
                                                 <tr ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealType == 'Financed'">
                                                    <td class=" col-md-8"> Due from customer</td>
                                                    <td class=" col-md-4 text-right BB0">{{0 | currency}} </td>
                                                </tr>
                                                 <tr ng-if = "InvoicePrintPreviewModel.InvoicePrintPreviewInfo.DealInfo.DealType == 'Financed'">
                                                    <td class=" col-md-8"> Due from financing</td>
                                                    <td class=" col-md-4 text-right BB0">{{0 | currency}} </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                     </div>                          
                                    </div>
                                    <!-- Start: Disclaimers Section --> 
                                    <div class="disclaimersSection">
                                        <p class="MB0 WarrantyText">{{InvoicePrintPreviewModel.InvoicePrintPreviewInfo.CustomerInvoiceWarrantyText}}</p>
                                    </div>
                                    <div class="disclaimersSection non-break-sec" ng-show="InvoicePrintPreviewModel.InvoicePrintPreviewInfo.IsSignatureLineforCustomerInvoice">
                                        <div class="WarrantySignatureText">
                                            <div class="pull-left"><p>Signature :&nbsp;&nbsp; </p></div>
                                            <div class="WarrantySignature"></div>
                                        </div>
                                    </div>
                                    <!-- End: Disclaimers Section --> 
                                     <div class="col-lg-3 col-md-3 col-lg-offset-9 col-md-offset-9 serviceWorksheetPrintBTn">
                                        <button ng-click="InvoicePrintPreviewModel.printview()" class="btn C11 T4 addmoreinfoBtn active_btn pull-right MT25 MR0">Print</button>
                                    </div>
                                    </div>
                                   </div>     
                                 </div>
                               </div>
                             </div>
                           </div>
                        </div>
                     </div>
        </body>
    </html>
</apex:page>