<apex:page standardStylesheets="false" showChat="false" showHeader="false" sidebar="false" docType="html-5.0" controller="GlobalController">
    <div class="content bp-wrapper-container fusion-mapping-container tax-management-main-container">
        <div class="bp-subHeader bp-techScheduler-subHeader">
            <div class="row container bp-top-header bp-tech-navigation-bar PB0">
                <section class="bp-breadcrumb-container">
                    <nav class="bp-breadcrumb-nav">
                        <ul>
                            <li><a ui-sref="homePage">{{'Label_Home' | translate}}</a></li>
                            <li> <a ui-sref="UserSetting">System settings</a></li>
                            <li> <a class="bp-breadcrumb-active">{{'Tax_management' | translate}}</a></li>
                        </ul>
                    </nav>
                </section>
                <h1 class="col-xs-12  bp-hasEyebrow P0">{{'Tax_management' | translate}}</h1>
            </div>
        </div>
        <div class="main-container row container">
            <div class="close-accardian" ng-class="{'open-accardian':M_TaxManagement.isOpenAccardian == 'Sell'}">
                <label class="H500" ng-click="F_TaxManagement.expandSection('Sell')">
                    <i class="bp-icons bp-font-20 bp-dark-grey1-font bp-fw-100 bp-lh-20 stroke-5 tax-rate-svg">salesTax</i>
                    <i class="bp-icons bp-font-16 bp-blue-font arrow-svg" ng-if="M_TaxManagement.isOpenAccardian != 'Sell'">arrowDown</i>
                    <i class="bp-icons bp-font-16 bp-blue-font arrow-svg" ng-if="M_TaxManagement.isOpenAccardian == 'Sell'">arrowUp</i> Tax rates</label>
                <div class="table-responsive">
                    <h2>Tax rates for sales transactions</h2>
                    <div class="c-product-filter-section">
                        <div class="c-primary-input-container">
                            <input class="c-input-search c-primary-input" ng-model="M_TaxManagement.SortJson.SearchSalesTaxRates" ng-keyup="F_TaxManagement.getFilteredRecored('SalesTaxRates')" type="text" placeholder="Search for a product"/>
                        </div>
                        <div class="filter-product-count-section">
                            <label class="c-total-product-count">{{M_TaxManagement.taxCounts.SalesTaxRateCount ? M_TaxManagement.taxCounts.SalesTaxRateCount : 0}} Tax rate<span ng-if="M_TaxManagement.taxCounts.SalesTaxRateCount>1">s</span></label>
                        </div>
                    </div>
                    <div class="bp-scrollable-table" id="trstscrollContainer" when-scrolled="F_TaxManagement.loadMoreData('SalesTaxRates', 'trstscrollContainer')">
                    <table class="bp-editable-table part-count-table bp-grey-back-table">
                        <col width="10%" />
                        <col width="15%" />
                        <col width="15%" />
                        <col width="20%" />
                        <col width="30%" />
                        <col width="10" />
                        <thead>
                            <th class="H201 bp-first-letter-capitalize"> Tax name </th>
                            <th class="H201 bp-first-letter-capitalize"> {{'Type' | translate}} </th>
                            <th class="H201 bp-first-letter-capitalize"> {{'Rate' | translate}} </th>
                            <th class="H201 bp-first-letter-capitalize"> Category </th>
                            <th class="H201 bp-first-letter-capitalize"> Tax code usage </th>
                            <th></th>
                        </thead>
                        <tbody>
                            <tr class="bp-cursor-pointer" ng-repeat="salesTaxRec in M_TaxManagement.SalesTaxRates">
                                <td>
                                    <a class="bp-blue-font H300 bp-first-letter-capitalize">{{salesTaxRec.TaxName}}</a>
                                </td>
                                <td class="H300 bp-first-letter-capitalize">{{salesTaxRec.RateType}}</td>
                                <td class="bp-first-letter-capitalize">{{salesTaxRec.TaxRateStr}}</td>
                                <td class="bp-first-letter-capitalize">{{salesTaxRec.CategoryName}}</td>
                                <td class="bp-first-letter-capitalize">{{salesTaxRec.TaxCodeUsage}}</td>
                                <td>
                                    <div class="flex-container items-right">
                                        <a class="button icon edit" ng-click="F_TaxManagement.AddEditTaxRate('Sell',salesTaxRec)">
                                            <i class="bp-icons bp-font-14 bp-fw-100">edit</i>
                                        </a>
                                        <a class="button icon delete" ng-click="F_TaxManagement.showDeleteConfirmationWindow(salesTaxRec.Id,$index,'SalesTaxRates','taxRate')"><span class="button-text" aira-hidden="true">Delete</span></a>
                                    </div>
                                </td>
                            </tr>
                                <tr class="dummy-rec-opacity_{{$index}}" ng-repeat="rec in M_TaxManagement.dummyRecJSON" ng-if="M_TaxManagement.isloadDummyState.SalesTaxRates">
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                </tr>
                                <tr ng-if="M_TaxManagement.SalesTaxRates.length == 0" class="no-record-found">
                                    <td colspan="6">{{'Label_No_Records_Found' | translate}}</td>
                                </tr>
                        </tbody>
                    </table>
                </div>
                </div>
                <div class="otherTaskEntry bp-flex-grid-container no-border-top">
                    <div class="bp-grid-column createNewTask" ng-click="F_TaxManagement.AddEditTaxRate('Sell')">
                        <a class="H400"><i class="bp-icons bp-font-20 bp-cursor-pointer bp-fw-100 stroke-5">addCircle</i>{{ 'Add_new_rate' | translate }}</a>
                    </div>
                </div>
                <div class="table-responsive MT30">
                    <h2>Tax rates for purchase transactions</h2>
                    <div class="c-product-filter-section">
                        <div class="c-primary-input-container">
                            <input class="c-input-search c-primary-input" ng-model="M_TaxManagement.SortJson.SearchPurchaseTaxRates" ng-keyup="F_TaxManagement.getFilteredRecored('PurchaseTaxRates')" type="text" placeholder="Search for a product"/>
                        </div>
                        <div class="filter-product-count-section">
                            <label class="c-total-product-count">{{M_TaxManagement.taxCounts.PurchaseTaxRateCount ? M_TaxManagement.taxCounts.PurchaseTaxRateCount : 0}} Tax rate<span ng-if="M_TaxManagement.taxCounts.PurchaseTaxRateCount>1">s</span></label>
                        </div>
                    </div>
                    <div class="bp-scrollable-table" id="trptscrollContainer" when-scrolled="F_TaxManagement.loadMoreData('PurchaseTaxRates', 'trptscrollContainer')">
                    <table class="bp-editable-table part-count-table bp-grey-back-table">
                        <col width="10%" />
                        <col width="15%" />
                        <col width="15%" />
                        <col width="20%" />
                        <col width="30%" />
                        <col width="10" />
                        <thead>
                            <th class="H201 bp-first-letter-capitalize"> Tax name </th>
                            <th class="H201 bp-first-letter-capitalize"> {{'Type' | translate}} </th>
                            <th class="H201 bp-first-letter-capitalize"> {{'Rate' | translate}} </th>
                            <th class="H201 bp-first-letter-capitalize"> Category </th>
                            <th class="H201 bp-first-letter-capitalize"> Tax code usage </th>
                            <th></th>
                        </thead>
                        <tbody>
                            <tr class="bp-cursor-pointer" ng-repeat="purchaseTaxRec in M_TaxManagement.PurchaseTaxRates">
                                <td><a class="bp-blue-font H300 bp-first-letter-capitalize">{{purchaseTaxRec.TaxName}}</a></td>
                                <td class="H300 bp-first-letter-capitalize">{{purchaseTaxRec.RateType}}</td>
                                <td class="bp-first-letter-capitalize">{{purchaseTaxRec.TaxRateStr}}</td>
                                <td class="bp-first-letter-capitalize">{{purchaseTaxRec.CategoryName}}</td>
                                <td class="bp-first-letter-capitalize">{{purchaseTaxRec.TaxCodeUsage}}</td>
                                <td>
                                    <div class="flex-container items-right">
                                        <a class="button icon edit" ng-click="F_TaxManagement.AddEditTaxRate('Purchase',purchaseTaxRec)">
                                            <i class="bp-icons bp-font-14 bp-fw-100">edit</i>
                                        </a>
                                        <a class="button icon delete" ng-click="F_TaxManagement.showDeleteConfirmationWindow(purchaseTaxRec.Id,$index,'PurchaseTaxRates','taxRate')"><span class="button-text" aira-hidden="true">Delete</span></a>
                                    </div>
                                </td>
                            </tr>
                                <tr class="dummy-rec-opacity_{{$index}}" ng-repeat="rec in M_TaxManagement.dummyRecJSON" ng-if="M_TaxManagement.isloadDummyState.PurchaseTaxRates">
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                </tr>
                                <tr ng-if="M_TaxManagement.PurchaseTaxRates.length == 0" class="no-record-found">
                                    <td colspan="6">{{'Label_No_Records_Found' | translate}}</td>
                                </tr>
                        </tbody>
                    </table>
                </div>
                </div>
                <div class="otherTaskEntry bp-flex-grid-container no-border-top">
                    <div class="bp-grid-column createNewTask" ng-click="F_TaxManagement.AddEditTaxRate('Purchase')">
                        <a class="H400"><i class="bp-icons bp-font-20 bp-cursor-pointer bp-fw-100 stroke-5">addCircle</i>{{ 'Add_new_rate' | translate }}</a>
                    </div>
                </div>
            </div>
            <div class="close-accardian" ng-class="{'open-accardian':M_TaxManagement.isOpenAccardian == 'Purchase'}">
                <label class="H500" ng-click="F_TaxManagement.expandSection('Purchase')">
                    <i class="bp-icons bp-font-20 bp-dark-grey1-font bp-fw-100 bp-lh-20 stroke-5 tax-rate-svg">taxCode</i>
                    <i class="bp-icons bp-font-16 bp-blue-font arrow-svg" ng-if="M_TaxManagement.isOpenAccardian != 'Purchase'">arrowDown</i> 
                    <i class="bp-icons bp-font-16 bp-blue-font arrow-svg" ng-if="M_TaxManagement.isOpenAccardian == 'Purchase'">arrowUp</i>Tax codes</label>
                <div class="table-responsive">
                    <h2>Tax codes for sales transactions</h2>
                    <div class="c-product-filter-section">
                        <div class="c-primary-input-container">
                            <input class="c-input-search c-primary-input" ng-model="M_TaxManagement.SortJson.SearchSalesTaxCodes" ng-keyup="F_TaxManagement.getFilteredRecored('SalesTaxCodes')" type="text" placeholder="Search for a product"/>
                        </div>
                        <div class="filter-product-count-section">
                            <label class="c-total-product-count">{{M_TaxManagement.taxCounts.SalesTaxCodeCount ? M_TaxManagement.taxCounts.SalesTaxCodeCount : 0}} Tax code<span ng-if="M_TaxManagement.taxCounts.SalesTaxCodeCount>1">s</span></label>
                        </div>
                    </div>
                    <div class="bp-scrollable-table" id="tcstscrollContainer" when-scrolled="F_TaxManagement.loadMoreData('SalesTaxCodes', 'tcstscrollContainer')">
                    <table class="bp-editable-table part-count-table bp-grey-back-table ">
                       <col width="20%" />
                        <col width="30%" />
                        <col width="28%" />
                        <col width="7%" />
                        <col width="7%" />
                        <col width="3%" />
                        <col width="5%" />
                        <thead>
                            <th class="H201 bp-first-letter-capitalize"> Code name </th>
                            <th class="H201 bp-first-letter-capitalize"> Rates included </th>
                            <th class="H201 bp-first-letter-capitalize"> Total rate </th>
                            <th class="H201 bp-first-letter-capitalize"> Default </th>
                            <th class="H201 bp-first-letter-capitalize"> Active </th>
                            <th></th>
                            <th></th>
                        </thead>
                        <tbody class="FF-left-border" ng-repeat="salesTaxRec in M_TaxManagement.SalesTaxCodes" ng-class="{'bg-light-blue':M_TaxManagement.isOpeninnerAccardian == 'Sell_{{$index}}'}">
                            <tr class="bp-cursor-pointer no-border " ng-click = "F_TaxManagement.expandinnerSection('Sell',$index,$event)">
                                <td class="no-border bp-cursor-pointer PR18">
                                    <a class="bp-blue-font H300 d-inline-block bp-first-letter-capitalize" ng-show = "M_TaxManagement.isOpeninnerAccardian != 'Sell_{{$index}}'">{{salesTaxRec.Name}}</a>
                                    <input type = "text" class = "bp-new-input" ng-model = "salesTaxRec.Name" ng-show = "M_TaxManagement.isOpeninnerAccardian == 'Sell_{{$index}}'" />
                                </td>
                                <td class="H300  no-border bp-cursor-pointer "><span>{{salesTaxRec.RatesIncluded}}</span></td>
                                <td class="bp-first-letter-capitalize no-border bp-cursor-pointer">{{salesTaxRec.TotalRateStr}}</td>
                                <td class="bp-first-letter-capitalize no-border bp-cursor-pointer">
                                    <label class="bp-switch">
                                        <input type="checkbox" ng-model="salesTaxRec.IsDefault" ng-click = "F_TaxManagement.checkSectionOpen($index,'Sell','isDefault',salesTaxRec.IsDefault,$event)" />
                                        <div class="bp-slider round"></div>
                                    </label>
                                </td>
                                <td class="bp-first-letter-capitalize no-border bp-cursor-pointer">
                                    <label class="bp-switch">
                                        <input type="checkbox" ng-model="salesTaxRec.IsActive" ng-click = "F_TaxManagement.checkSectionOpen($index,'Sell','isActive',salesTaxRec.IsActive,$event)" />
                                        <div class="bp-slider round"></div>
                                    </label>
                                </td>
                                <td class="no-border bp-cursor-pointer">
                                    <div class="flex-container items-right">
                                        <a class="button icon delete" ng-click="F_TaxManagement.showDeleteConfirmationWindow(salesTaxRec.Id,$index,'SalesTaxCodes','taxCode')"><span class="button-text" aira-hidden="true">Delete</span></a>
                                    </div>
                                </td>
                                <td class="no-border bp-cursor-pointer">
                                  <i class="bp-icons bp-font-12 bp-blue-font stroke-5 arrow-svg" ng-show = "M_TaxManagement.isOpeninnerAccardian != 'Sell_{{$index}}'">arrowDown</i> 
                    			  <i class="bp-icons bp-font-12 bp-blue-font stroke-5 arrow-svg" ng-show = "M_TaxManagement.isOpeninnerAccardian == 'Sell_{{$index}}'">arrowUp</i>
                               </td>
                            </tr>
                            <tr class="inner-table-row">
                                <td colspan="7" ng-class="{'height-100':M_TaxManagement.isOpeninnerAccardian == 'Sell_{{$index}}'}">
                                    <div class="close-inner-accardian" ng-class="{'open-inner-accardian':M_TaxManagement.isOpeninnerAccardian == 'Sell_{{$index}}', 'PT8' : M_TaxManagement.isOpeninnerAccardian == 'Sell_{{$index}}'}">
                                        <table class="bp-editable-table">
                                            <col width="20%" />
                                            <col width="30%" />
                                            <col width="30%" />
                                            <col width="5%" />
                                            <col width="5%" />
                                            <col width="5%" />
                                            <col width="5%" />
                                            <tbody class="no-border">
                                                <tr class="no-border">
                                                    <td class="no-border PR18">
                                                        <label>Forms label</label>
                                                        <input type="text" ng-model="salesTaxRec.FormsLabel" class="bp-new-input" />
                                                    </td>
                                                    <td colspan="4" class="no-border">
                                                        <label class="bp-collapsible-grid list-rate-label">List rates on forms?</label>
                                                        <label class="bp-switch">
                                                            <input type="checkbox" ng-model="salesTaxRec.IsListRatesOnForms" />
                                                            <div class="bp-slider round"></div>
                                                        </label>
                                                    </td>
                                                    <td colspan="1" class="no-border">
                                                    	<button class="button secondary small save-tax-code-btn" ng-disabled = "!salesTaxRec.Name || !salesTaxRec.FormsLabel" ng-click = "F_TaxManagement.saveTaxCode(salesTaxRec)">Save</button>
                                                    </td>
                                                </tr>
                                                <tr ng-if="salesTaxRec.TaxRateList.length > 0" class="no-border">
                                                    <td colspan="7" class="PR18 PB31 no-border-bottom">
                                                        <table class="bp-editable-table bg-grey-table">
                                                            <col width="20%" />
                                                            <col width="30%" />
                                                            <col width="50%" />
                                                            <thead>
                                                                <tr class="no-border">
                                                                    <th class="H201 bp-first-letter-capitalize">Tax rate</th>
                                                                    <th class="H201 bp-first-letter-capitalize">Type</th>
                                                                    <th class="H201 bp-first-letter-capitalize">Rate</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr ng-repeat="taxRateRec in salesTaxRec.TaxRateList">
                                                                    <td class="H300 bp-first-letter-capitalize">{{taxRateRec.TaxName}}</td>
                                                                    <td>{{taxRateRec.RateType}}</td>
                                                                    <td>{{taxRateRec.TaxRateStr}}</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    <button class="button secondary assign-tax-rate-btn" ng-click = "F_TaxManagement.openAssignTaxRateModel(salesTaxRec,'Sell', $index)">Assign tax rate</button>
                                                    </td>
                                                </tr>
                                            	<tr class="no-border" ng-if = "salesTaxRec.TaxRateList.length == 0">
                                            		<td colspan="7" class="no-border" ng-class = "{'PB31' : salesTaxRec.TaxRateList.length == 0}">
                                            			<button class="button secondary assign-tax-rate-btn" ng-click = "F_TaxManagement.openAssignTaxRateModel(salesTaxRec,'Sell', $index)">Assign tax rate</button>
                                            		</td>
                                            	</tr>
                                            </tbody>
                                        </table>
                                        
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                                <tbody ng-if="M_TaxManagement.isloadDummyState.SalesTaxCodes">
                                    <tr class="dummy-rec-opacity_{{$index}}" ng-repeat="rec in M_TaxManagement.dummyRecJSON">
                                        <td class="dummy-rec dummy-animation"> <span></span></td>
                                        <td class="dummy-rec dummy-animation"> <span></span></td>
                                        <td class="dummy-rec dummy-animation"> <span></span></td>
                                        <td class="dummy-rec dummy-animation"> <span></span></td>
                                        <td class="dummy-rec dummy-animation"> <span></span></td>
                                        <td class="dummy-rec dummy-animation"> <span></span></td>
                                        <td class="dummy-rec dummy-animation"> <span></span></td>
                                    </tr>
                                </tbody>
                                <tbody ng-if="M_TaxManagement.SalesTaxCodes.length == 0">
                                    <tr class="no-record-found">
                                        <td colspan="7">{{'Label_No_Records_Found' | translate}}</td>
                                    </tr>
                                </tbody>
                    </table>
                </div>
                </div>
                
                
                
                <div class="otherTaskEntry bp-flex-grid-container">
                    <div class="bp-grid-column createNewTask" ng-click="F_TaxManagement.AddEditTaxCode('Sell')">
                        <a class="H400"><i class="bp-icons bp-font-20 bp-cursor-pointer bp-fw-100 stroke-5">addCircle</i>Add a new tax code</a>
                    </div>
                </div>
                
                 <div class="table-responsive overflow-visible MT30">
                    <h2>Tax codes for purchase  transactions</h2>
                    <div class="c-product-filter-section">
                        <div class="c-primary-input-container">
                            <input class="c-input-search c-primary-input" ng-model="M_TaxManagement.SortJson.SearchPurchaseTaxCodes" ng-keyup="F_TaxManagement.getFilteredRecored('PurchaseTaxCodes')" type="text" placeholder="Search for a product"/>
                        </div>
                        <div class="filter-product-count-section">
                            <label class="c-total-product-count">{{M_TaxManagement.taxCounts.PurchaseTaxCodeCount ? M_TaxManagement.taxCounts.PurchaseTaxCodeCount : 0}} Tax code<span ng-if="M_TaxManagement.taxCounts.PurchaseTaxCodeCount>1">s</span></label>
                        </div>
                    </div>
                    <div class="bp-scrollable-table" id="tcptscrollContainer" when-scrolled="F_TaxManagement.loadMoreData('PurchaseTaxCodes', 'tcptscrollContainer')">
                    <table class="bp-editable-table part-count-table bp-grey-back-table ">
                         <col width="20%" />
                        <col width="30%" />
                        <col width="28%" />
                        <col width="7%" />
                        <col width="7%" />
                        <col width="3%" />
                        <col width="5%" />
                        <thead>
                            <th class="H201 bp-first-letter-capitalize"> Code name </th>
                            <th class="H201 bp-first-letter-capitalize"> Rates included </th>
                            <th class="H201 bp-first-letter-capitalize"> Total rate </th>
                            <th class="H201 bp-first-letter-capitalize"> Default </th>
                            <th class="H201 bp-first-letter-capitalize"> Active </th>
                            <th></th>
                            <th></th>
                        </thead>
                        <tbody ng-repeat="purchaseTaxCodeRec in M_TaxManagement.PurchaseTaxCodes" ng-class="{'bg-light-blue':M_TaxManagement.isOpeninnerAccardian == 'Purchase_{{$index}}'}">
                            <tr class="bp-cursor-pointer no-border" ng-click = "F_TaxManagement.expandinnerSection('Purchase',$index,$event)">
                                <td class="no-border bp-cursor-pointer PR18">
                                	<a class="bp-blue-font d-inline-block H300 bp-first-letter-capitalize" ng-show = "M_TaxManagement.isOpeninnerAccardian != 'Purchase_{{$index}}'">{{purchaseTaxCodeRec.Name}}</a>
                                    <input type = "text" class = "bp-new-input" ng-model = "purchaseTaxCodeRec.Name" ng-show = "M_TaxManagement.isOpeninnerAccardian == 'Purchase_{{$index}}'" />
                                </td>
                                <td class="H300  no-border bp-cursor-pointer "><sapn>{{purchaseTaxCodeRec.RatesIncluded}}</sapn></td>
                                <td class="bp-first-letter-capitalize no-border bp-cursor-pointer">{{purchaseTaxCodeRec.TotalRateStr}}</td>
                                <td class="bp-first-letter-capitalize no-border bp-cursor-pointer">
                                    <label class="bp-switch">
                                        <input type="checkbox" ng-model="purchaseTaxCodeRec.IsDefault" ng-click = "F_TaxManagement.checkSectionOpen($index,'Purchase','isDefault',purchaseTaxCodeRec.IsDefault,$event)" />
                                        <div class="bp-slider round"></div>
                                    </label>
                                </td>
                                <td class="bp-first-letter-capitalize no-border bp-cursor-pointer">
                                    <label class="bp-switch">
                                        <input type="checkbox" ng-model="purchaseTaxCodeRec.IsActive" ng-click = "F_TaxManagement.checkSectionOpen($index,'Purchase','isActive',purchaseTaxCodeRec.IsDefault,$event)" />
                                        <div class="bp-slider round"></div>
                                    </label>
                                </td>
                                <td class="no-border bp-cursor-pointer">
                                    <div class="flex-container items-right">
                                        <a class="button icon delete" ng-click="F_TaxManagement.showDeleteConfirmationWindow(purchaseTaxCodeRec.Id,$index,'PurchaseTaxCodes','taxCode')"><span class="button-text" aira-hidden="true">Delete</span></a>
                                    </div>
                                </td>
                                <td class="no-border bp-cursor-pointer">
                                  <i class="bp-icons bp-font-12 bp-blue-font stroke-5 arrow-svg" ng-show = "M_TaxManagement.isOpeninnerAccardian != 'Purchase_{{$index}}'">arrowDown</i> 
                    			  <i class="bp-icons bp-font-12 bp-blue-font stroke-5 arrow-svg" ng-show = "M_TaxManagement.isOpeninnerAccardian == 'Purchase_{{$index}}'">arrowUp</i>
                               </td>
                            </tr>
                            <tr class="inner-table-row">
                                <td colspan="7" ng-class="{'height-100':M_TaxManagement.isOpeninnerAccardian == 'Purchase_{{$index}}'}">
                                    <div class="close-inner-accardian" ng-class="{'open-inner-accardian':M_TaxManagement.isOpeninnerAccardian == 'Purchase_{{$index}}', 'PT8' : M_TaxManagement.isOpeninnerAccardian == 'Purchase_{{$index}}'}">
                                        <table class="bp-editable-table">
                                            <col width="20%" />
                                            <col width="30%" />
                                            <col width="30%" />
                                            <col width="5%" />
                                            <col width="5%" />
                                            <col width="5%" />
                                            <col width="5%" />
                                            <tbody class="no-border">
                                                <tr class="no-border">
                                                    <td class="no-border PR18">
                                                        <label>Forms label</label>
                                                        <input type="text" ng-model="purchaseTaxCodeRec.FormsLabel" class="bp-new-input" />
                                                    </td>
                                                    <td colspan="4" class="no-border">
                                                        <label class="bp-collapsible-grid list-rate-label">List rates on forms?</label>
                                                        <label class="bp-switch">
                                                            <input type="checkbox" ng-model="purchaseTaxCodeRec.IsListRatesOnForms" />
                                                            <div class="bp-slider round"></div>
                                                        </label>
                                                    </td>
                                                     <td colspan="1" class="no-border">
                                                    	<button class="button secondary small save-tax-code-btn" ng-disabled = "!purchaseTaxCodeRec.Name || !purchaseTaxCodeRec.FormsLabel" ng-click = "F_TaxManagement.saveTaxCode(purchaseTaxCodeRec)">Save</button>
                                                    </td>
                                                </tr>
                                                <tr ng-if="purchaseTaxCodeRec.TaxRateList.length > 0" class="no-border">
                                                    <td colspan="7" class="PR18 PB31 no-border-bottom">
                                                        <table class="bp-editable-table bg-grey-table">
                                                            <col width="20%" />
                                                            <col width="30%" />
                                                            <col width="50%" />
                                                            <thead>
                                                                <tr class="no-border">
                                                                    <th class="H201 bp-first-letter-capitalize">Tax rate</th>
                                                                    <th class="H201 bp-first-letter-capitalize">Type</th>
                                                                    <th class="H201 bp-first-letter-capitalize">Rate</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr ng-repeat="taxRateRec in purchaseTaxCodeRec.TaxRateList">
                                                                    <td class="H300 bp-first-letter-capitalize">{{taxRateRec.TaxName}}</td>
                                                                    <td>{{taxRateRec.RateType}}</td>
                                                                    <td>{{taxRateRec.TaxRateStr}}</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <button class="button secondary assign-tax-rate-btn" ng-click = "F_TaxManagement.openAssignTaxRateModel(purchaseTaxCodeRec,'Purchase', $index)">Assign tax rate</button>
                                                    </td>
                                                </tr>
                                                <tr class="no-border" ng-if = "purchaseTaxCodeRec.TaxRateList.length == 0">
                                            		<td colspan="7" class="no-border" ng-class = "{'PB31' : purchaseTaxCodeRec.TaxRateList.length == 0}">
                                            			<button class="button secondary assign-tax-rate-btn" ng-click = "F_TaxManagement.openAssignTaxRateModel(purchaseTaxCodeRec,'Purchase', $index)">Assign tax rate</button>
                                            		</td>
                                            	</tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                            <tbody ng-if="M_TaxManagement.isloadDummyState.PurchaseTaxCodes">
                                <tr class="dummy-rec-opacity_{{$index}}" ng-repeat="rec in M_TaxManagement.dummyRecJSON">
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                    <td class="dummy-rec dummy-animation"> <span></span></td>
                                </tr>
                            </tbody>
                            <tbody ng-if="M_TaxManagement.PurchaseTaxCodes.length == 0">
                                <tr class="no-record-found">
                                    <td colspan="7">{{'Label_No_Records_Found' | translate}}</td>
                                </tr>
                            </tbody>
                    </table>
                </div>
                </div>
                <div class="otherTaskEntry bp-flex-grid-container">
                    <div class="bp-grid-column createNewTask" ng-click="F_TaxManagement.AddEditTaxCode('Purchase')">
                        <a class="H400"><i class="bp-icons bp-font-20 bp-cursor-pointer bp-fw-100 stroke-5">addCircle</i>Add a new tax code</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade CreateGroupModal  bp-cp-modal-dialog tax-rate-model-window" id="AddEditTaxRateModelWindow" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="userGroupInfoArea">
                        <h1 class="heading-info H600" ng-if="!M_TaxManagement.AddEditJson.Id && M_TaxManagement.AddEditJson.TaxType == 'Sell'">New selling tax rate</h1>
                        <h1 class="heading-info H600" ng-if="!M_TaxManagement.AddEditJson.Id && M_TaxManagement.AddEditJson.TaxType == 'Purchase'">New purchase  tax rate</h1>
                        <h1 class="heading-info H600" ng-if="M_TaxManagement.AddEditJson.Id && M_TaxManagement.AddEditJson.TaxType == 'Sell'">Edit selling tax rate</h1>
                        <h1 class="heading-info H600" ng-if="M_TaxManagement.AddEditJson.Id && M_TaxManagement.AddEditJson.TaxType == 'Purchase'">Edit purchase tax rate</h1>
                        <div class="form">
                            <div class="left">
                                <div>
                                    <p>Tax name</p>
                                    <input type="text" class="bp-new-input" ng-model="M_TaxManagement.AddEditJson.TaxName" />
                                </div>
                                <div>
                                    <p>Category</p>
                                    <div class="bp-cell bp-customerdropdown price-level-drop-down-value bp-unitSearch-area customerDropDown searchInputArea selectableDropdown" ng-class="{'showingOverlay' : M_TaxManagement.isCategoriesFocusedState}">
                                        <input type="text" id="CategorieId" class="searchInput bp-new-input" placeholder="{{ 'Please_select' | translate }}" name="Price Level" ng-focus="F_TaxManagement.showDropDownValue('Category')" ng-blur="M_TaxManagement.isCategoriesFocusedState = false;M_TaxManagement.selectedCategoriesIndex - 1" ng-model="M_TaxManagement.AddEditJson.CategoryName" readonly="readonly" ng-disabled="" />
                                        <i class="bp-icons bp-font-12 bp-blue-font bp-cursor-pointer stroke-5 downArrow" ng-click="F_TaxManagement.openDropDwon('Categories','CategorieId')">arrowDown</i>
                                        <div class="searchResultOverlay" id="autocompleteScrollDiv">
                                            <ul>
                                                <li ng-class="{'selected-row' : M_TaxManagement.selectedCategoriesIndex == $index}" ng-repeat="categorieRec in M_TaxManagement.categoriesList" ng-mousedown="F_TaxManagement.ChangeCategories(categorieRec)">
                                                    <div class="fullName">{{categorieRec.Name}}</div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <p>Type</p>
                                    <div class="bp-cell bp-customerdropdown price-level-drop-down-value bp-first-letter-capitalize bp-unitSearch-area customerDropDown searchInputArea selectableDropdown" ng-class="{'showingOverlay' : M_TaxManagement.isRateTypeFocusedState}">
                                        <input type="text" id="RateTypeInput" class="d-flex searchInput bp-new-input" placeholder="{{ 'Please_select' | translate }}" name="Price Level" ng-focus="F_TaxManagement.showDropDownValue('Type')" ng-blur="M_TaxManagement.isRateTypeFocusedState = false; M_TaxManagement.selectedTaxTypeIndex - 1" ng-model="M_TaxManagement.AddEditJson.RateType" readonly="readonly" ng-disabled="M_TaxManagement.AddEditJson.Id || M_TaxManagement.isTaxIncludingPricing || !M_TaxManagement.IsEnhancedTaxCalculation" />
                                        <i class="bp-icons bp-font-12 bp-blue-font bp-cursor-pointer bp-text-transform stroke-5 downArrow" ng-click="F_TaxManagement.openDropDwon('Rate','RateTypeInput')">arrowDown</i>
                                        <div class="searchResultOverlay" id="autocompleteScrollDiv">
                                            <ul>
                                                <li ng-class="{'selected-row' : M_TaxManagement.selectedTaxTypeIndex == $index }" ng-repeat="rateTypeRec in M_TaxManagement.rateTypeList" ng-mousedown="F_TaxManagement.ChangeRateType(rateTypeRec)">
                                                    <div class="fullName bp-first-letter-capitalize">{{rateTypeRec.RateType}}</div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div ng-if="M_TaxManagement.AddEditJson.RateType == 'Fixed rate'">
                                    <p>Rate</p>
                                    <div class="doller-sign-container">
                                        <numbers-only class-value="bp-new-input small-input persent-input" precision-length="4" input-model-value="M_TaxManagement.AddEditJson.TaxRate" />
                                        <span class="doller-sign">%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="right">
                                <div>
                                    <p>Forms label</p>
                                    <input type="text" class="bp-new-input" ng-model="M_TaxManagement.AddEditJson.FormsLabel" />
                                </div>
                                <div>
                                    <p>Minimum tax</p>
                                    <div class="doller-sign-container">
                                        <span class="doller-sign">$</span>
                                        <numbers-only class-value="bp-new-input" precision-length="2" ng-class-name="{'bp-redborder' : M_TaxManagement.isValidateMinimum}" input-model-value="M_TaxManagement.AddEditJson.MinimumTaxAmount" blur-value="F_TaxManagement.validationMinimum(M_TaxManagement.AddEditJson.MinimumTaxAmount,M_TaxManagement.AddEditJson.MaximumTaxAmount); " disabled-value="M_TaxManagement.AddEditJson.RateType == 'Fixed rate' || M_TaxManagement.isTaxIncludingPricing || !M_TaxManagement.IsEnhancedTaxCalculation" />
                                    </div>
                                </div>
                                <div>
                                    <p>Maximum tax</p>
                                    <input type="text" class="bp-new-input" ng-if="M_TaxManagement.AddEditJson.RateType == 'Fixed rate' || M_TaxManagement.isTaxIncludingPricing || !M_TaxManagement.IsEnhancedTaxCalculation" value="-unlimited-" ng-disabled="M_TaxManagement.AddEditJson.RateType == 'Fixed rate' || M_TaxManagement.isTaxIncludingPricing || !M_TaxManagement.IsEnhancedTaxCalculation" />
                                    <div ng-class="{'doller-sign-container' : M_TaxManagement.AddEditJson.MaximumTaxAmount != '-unlimited-'}" ng-if="M_TaxManagement.AddEditJson.RateType != 'Fixed rate' && !M_TaxManagement.isTaxIncludingPricing && M_TaxManagement.IsEnhancedTaxCalculation">
                                        <span class="doller-sign" ng-if="M_TaxManagement.AddEditJson.MaximumTaxAmount != '-unlimited-'">$</span>
                                        <numbers-only class-value="bp-new-input" precision-length="2" ng-class-name="{'bp-redborder' : M_TaxManagement.isValidateMaxmum }" blur-value="F_TaxManagement.validationMaximum(M_TaxManagement.AddEditJson.MinimumTaxAmount,M_TaxManagement.AddEditJson.MaximumTaxAmount);" input-model-value="M_TaxManagement.AddEditJson.MaximumTaxAmount" is-un-limited="M_TaxManagement.isUnLimited" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bp-bg-grey arrow_box" ng-if="M_TaxManagement.AddEditJson.RateType != 'Fixed rate'">
                            <div class="table-responsive">
                                <table class="bp-editable-table header-table part-count-table">
                                    <col width="15%" />
                                    <col width="15%" />
                                    <col width="15%" />
                                    <col width="55%" />
                                    <tbody>
                                        <tr>
                                            <td></td>
                                            <td class="H300 bp-first-letter-capitalize col-span-td" colspan="2">Taxable amounts</td>
                                            <td>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <table class="bp-editable-table part-count-table">
                                    <col width="15%" />
                                    <col width="15%" />
                                    <col width="15%" />
                                    <col width="55%" />
                                    <thead>
                                        <th class="H201"> Rate </th>
                                        <th class="H201"> {{'From' | translate}} </th>
                                        <th class="H201"> To</th>
                                        <th></th>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="rateTaxTableRec in M_TaxManagement.AddEditJson.RateTable" ng-if="$index == 0 || ($index != 0 && M_TaxManagement.AddEditJson.RateTable[$index-1].MaximumTaxableAmount != '-unlimited-')">
                                            <td>
                                                <div class="doller-sign-container MR13">
                                                    <numbers-only class-value="bp-new-input persent-input" precision-length="4" input-model-value="rateTaxTableRec.TaxRate" />
                                                    <span class="doller-sign">%</span>
                                                </div>
                                            </td>
                                            <td class="H300 bp-first-letter-capitalize">{{rateTaxTableRec.MinimumTaxableAmount | currency}}</td>
                                            <td class="bp-first-letter-capitalize">
                                                <div ng-class="{'doller-sign-container' : rateTaxTableRec.MaximumTaxableAmount != '-unlimited-'}">
                                                    <span class="doller-sign" ng-if="rateTaxTableRec.MaximumTaxableAmount != '-unlimited-'">$</span>
                                                    <numbers-only class-value="bp-new-input" precision-length="2" input-model-value="rateTaxTableRec.MaximumTaxableAmount" disabled-value="$index == 2" ng-class-name="{'bp-redborder' : rateTaxTableRec.isError}" input-keyup-value="F_TaxManagement.ChangeFromValue(rateTaxTableRec.MaximumTaxableAmount,$index)" is-un-limited="M_TaxManagement.isUnLimited" blur-value="F_TaxManagement.RateTaxTableValueChange($index)" />
                                                </div>
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="flex-box-footer">
                            <a class="button subtle" ng-click="F_TaxManagement.hideAddEditTaxRateModelWindow()">Cancel</a>
                            <a class="button primary" ng-disabled="!M_TaxManagement.AddEditJson.TaxName || !M_TaxManagement.AddEditJson.FormsLabel || M_TaxManagement.isValidateMinimum || M_TaxManagement.isValidateMaxmum" ng-click="F_TaxManagement.saveTaxRate()">Save</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade CreateGroupModal  bp-cp-modal-dialog tax-rate-model-window" id="AddEditTaxCodeModelWindow" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="userGroupInfoArea">
                    <h1 class="heading-info H600" ng-if="!M_TaxManagement.AddEditJsonTaxCode.Id && M_TaxManagement.AddEditJsonTaxCode.TaxType == 'Sell'">New selling tax code</h1>
                        <h1 class="heading-info H600" ng-if="!M_TaxManagement.AddEditJsonTaxCode.Id && M_TaxManagement.AddEditJsonTaxCode.TaxType == 'Purchase'">New purchase  tax code</h1>
                        <div class="form">
                            <div class="left">
                                <div>
                                    <p>Tax code name</p>
                                    <input type="text" class="bp-new-input" ng-model="M_TaxManagement.AddEditJsonTaxCode.Name" />
                                </div>
                                <div class = "MT18">
                                    <label class="width40">Default</label>
                                    <label class="bp-switch">
                                        <input type="checkbox" ng-model="M_TaxManagement.AddEditJsonTaxCode.IsDefault" />
                                        <div class="bp-slider round"></div>
                                    </label>
                                </div>
                                <div>
                                    <label class="width40">Active</label>
                                    <label class="bp-switch">
                                        <input type="checkbox" ng-model="M_TaxManagement.AddEditJsonTaxCode.IsActive" />
                                        <div class="bp-slider round"></div>
                                    </label>
                                </div>
                            </div>
                            <div class="right">
                                <div>
                                    <p>Forms label</p>
                                    <input type="text" class="bp-new-input" ng-model="M_TaxManagement.AddEditJsonTaxCode.FormsLabel" />
                                </div>
                            </div>
                        </div>
                        <div class="flex-box-footer">
                            <a class="button subtle" ng-click="F_TaxManagement.hideAddEditTaxCodeModelWindow()">Cancel</a>
                            <a class="button primary" ng-disabled="!M_TaxManagement.AddEditJsonTaxCode.Name || !M_TaxManagement.AddEditJsonTaxCode.FormsLabel" ng-click="F_TaxManagement.saveTaxCode()">Save</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="deleteRateModelWindow" class="modal fade-scale bp-model-dialog delete-tax-rate-model-window" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content col-xs-12 P0">
                <div class="modal-body">
                    <div class="message-info">
                        <span class="bp-dark-grey2-font">
							<p>Are you sure that you want to delete record for {{M_TaxManagement.deleteElementName}} ?
							</p>
						</span>
                    </div>
                    <div class="action-section">
                        <button class="bp-btn bp-btn-secondaryCTA bp-btn-medium text-uppercase" ng-click="F_TaxManagement.hideDeleteModelWindow()">CANCEL</button>
                        <button class="action-button bp-btn bp-btn-normal bp-btn-medium text-uppercase" ng-if = "M_TaxManagement.sectionName == 'taxRate'" ng-click="F_TaxManagement.deleteTaxRate()">Yes</button>
                        <button class="action-button bp-btn bp-btn-normal bp-btn-medium text-uppercase" ng-if = "M_TaxManagement.sectionName == 'taxCode'" ng-click="F_TaxManagement.deleteTaxCode()">Yes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="AssignTaxRateModelWindow" class="modal fade-scale bp-model-dialog assign-tax-code" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content col-xs-12 P0">
                <div class="modal-body">
                 <div class="userGroupInfoArea">
                <h1 class="heading-info H600">Assign tax rates</h1>
                <div class="bp-scrollable-table" id="assignTaxRateScrollContainer" when-scrolled="F_TaxManagement.loadMoreData('AssignTaxRate', 'assignTaxRateScrollContainer', 'AssignTaxRateModal')">
                    <ul>
                		<li ng-repeat = "assignRateRec in M_TaxManagement.AssignTaxRate">
                			 <input class="dummy-checkbox-input" type="checkbox"  id="checkbox-{{$index}}" ng-model="assignRateRec.isSelected"/>
                              <label class="label-as-checkbox" for="checkbox-{{$index}}"></label>
                              <label for="checkbox-{{$index}}" class="checkbox-label H201">{{assignRateRec.TaxName}} - {{assignRateRec.TaxRateStr}}</label>
                		
                		</li>
                        <li ng-repeat="rec in M_TaxManagement.dummyRecJSON" ng-if="M_TaxManagement.isloadDummyState.AssignTaxRate" class="dummy-assign-tax-rate">
                            <div class="dummy-rec dummy-animation"> <span></span></div>
                       </li>
                	</ul>
                </div>
                    <div class="flex-box-footer">
                        <button class="button subtle bp-first-letter-capitalize assign-tax-rate-cancel-btn" ng-click = "F_TaxManagement.hideAssignTaxRateModelWindow()">CANCEL</button>
                        <button class="button primary " ng-click = "F_TaxManagement.assignTaxRates()">Update</button>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="LoadingDiv" ng-show="M_TaxManagement.isLoading">
        <div class="loadingIconContainer">
            <c:BPLoading />
        </div>
    </div>
</apex:page>