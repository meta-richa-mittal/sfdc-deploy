<apex:component controller="GlobalController">
<!-- Start: unit deal -->
                    <div class="bp-accordion-entry expanded"  ng-class = "{'bp-collapse' : M_CO.expandedSectionName != 'Deal','disable-accordion' : !GroupOnlyPermissions['Deal']['view']}" >
                        <div class="bp-accordion-header bp-purple d-flex new-header-container">
                            <div class="icon-container" ng-click = "F_CO.expandOrCollapseSection('Deal_SectionId', 'Deal','', GroupOnlyPermissions['Deal']['view'],$event)" >
                                <i class="bp-icons stroke-5 bp-lh-20">{{M_CO.UnitIconName}}</i>
                            </div>
				           <div class = "main-section-header" ng-click = "F_CO.expandOrCollapseSection('Deal_SectionId', 'Deal','', GroupOnlyPermissions['Deal']['view'],$event)">  
				           <section-header
                        	section-name = "M_CO.sectionName['Unit Deal']"
                        	first-status = "M_CO.Deal.DealInfo.DealStatus == 'Fulfilled' ? 'Approved' : M_CO.Deal.DealInfo.DealStatus"
                        	transaction-type = "M_CO.Deal.DealInfo.DealType"
                        	transaction-type-label = "M_CO.Deal.DealInfo.DealType"
                        	total = "(F_CO.getDealTotal() ? F_CO.getDealTotal() : 0.00) | currency"
                        	third-status = "F_CO.getDealOptionStatus(M_CO.Deal, $event)"
                        	first-status-action = "F_CO.openChangeDealStatusConfig($event)"
                        	is-top-left-container-show = "true"
                        	is-badge-container-show = 'true'
                        	is-total-container-show = 'true'
                        	total-label = "Total:"
                        	third-status-action = "F_CO.openConfirmationDialog('DealOptionStatus', true, null, null, $event)"
                        	custom-class = "!F_CO.getSOPermissionType()['view'] ? 'bp-cursor-default' : ''" 
                            total-fetching-state = "M_CO.isAsyncActionInProgressForOptionFeeSection"
                        	>
                        	</section-header> 
                        	</div>
				             <div class = "right-container bp-accordion-toggle bp-purple-dark " ng-if = "M_CO.expandedSectionName != 'Deal'"
                                ng-click = "F_CO.expandOrCollapseSection('Deal_SectionId', 'Deal' ,'', GroupOnlyPermissions['Deal']['view'])">
                                <i class="bp-icons bp-font-16 stroke-1 size-unset">arrowDown</i>
                        	</div>
                        	 <div class=" right-container bp-accordion-toggle bp-purple-dark " ng-if = "M_CO.expandedSectionName == 'Deal'" 
                                ng-click = "F_CO.expandOrCollapseSection('Deal_SectionId', 'Deal' ,'', GroupOnlyPermissions['Deal']['view'])">
                                <i class="bp-icons bp-font-16 stroke-1 size-unset">arrowUp</i>
                            </div>    
                        </div>
                        <div class="bp-accordion-detail bp-collapse-div-transition" id="Deal_SectionId" ng-class="{'bp-expand-div-transition': M_CO.expandedSectionName == 'Deal'}">
                            <div> 
                                <!-- Start: inner Accordian level 1 -->
                                <!-- Start: Deal Summary accordian start here -->
                                <div class="bp-inner-accordian open bp-inner-accordian-deal" ng-class="{'bp-inner-accordian-opened': M_CO.expandedInnerSectionName == 'Deal_Details', 'bp-inner-accordian-opened-deal': M_CO.expandedInnerSectionName == 'Deal_Details'}">
                                    <div class="inner-accordian-header col-md-12"  ng-click = "F_CO.expandOrCollapseInnerSection('Deal_DetailsSectionId', 'Deal_Details')">
                                        <div class="inner-accordian-header-left alternative">
                                            <h2 class="accordian-left-details">{{'Summary' | translate}}
                                            </h2>
                                           <a class="inner-accordian-subheader" ng-click="F_CO.goToDP360(M_CO.Deal.DealInfo.DP360LeadURL)" ng-if="M_CO.coHeaderRec.IsDP360SyncEnabled && M_CO.Deal.DealInfo.DealStatus != 'Invoiced' && M_CO.expandedInnerSectionName == 'Deal_Details'&& M_CO.Deal.DealInfo.DP360LeadId">DP360 Lead #{{M_CO.Deal.DealInfo.DP360LeadId}}</a>                                       
                                        </div>
                                       <div class="accordian-right-details">
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_Details'">
                                                <i class="bp-icons bp-font-16 stroke-1 size-unset">arrowDown</i>
                                            </a>
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName == 'Deal_Details'">
                                                <i class="bp-icons bp-font-16 stroke-1 size-unset">arrowUp</i>
                                            </a>
                                            <div class="accordian-right-details-text">
                                                <p class="right-text required" ng-if="(M_CO.expandedInnerSectionName != 'Deal_Details' && M_CO.Deal.DealInfo.DealStatus == 'Quotation')">
                                                    <span></span> 
                                                    <span class="req-icon">!</span>
                                                </p>
                                           </div>
                                        </div>
                                    </div>
                                    <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition"  id="Deal_DetailsSectionId"
                                        ng-class="{'bp-expand-div-transition': M_CO.expandedInnerSectionName == 'Deal_Details'}">
                                        <div class="expandableContainer">
                                           <div class = "col-xs-12 col-sm-6 form-container">
                                                <div class = "col-xs-12">
                                                    <label class = "col-xs-12 MB0 MT15">{{'Deal_status' | translate}}</label>
                                                    <div class="col-xs-12 P0">
                                                         <div class = "dealStaus deal-status">
                                                             <label class="badge-style col-xs-3 {{M_CO.changeDealStatusCssConfig[M_CO.Deal.DealInfo.DealStatus == 'Fulfilled' ? 'Approved' : M_CO.Deal.DealInfo.DealStatus]}}">{{M_CO.Deal.DealInfo.DealStatus == 'Fulfilled' ? 'Approved' : M_CO.Deal.DealInfo.DealStatus}}</label>
                                                             <span>
                                                                  <a ng-if="F_CO.getSOPermissionType()['create/modify']" ng-click="F_CO.openChangeDealStatusConfig()" ng-class="{'bp-disabled': F_CO.isArchivedQuote()}">{{'Change_deal_status' | translate}} </a> 
                                                             </span>
                                                         </div>
                                                          <div class="col-md-12 P0 bp-orange-dark-font dealStatusValue  required">
                                                           <span ng-if = "M_CO.Deal.DealInfo.DealStatus == 'Quotation'" class="req-icon">!</span>
                                                            <span class = "dealquation" ng-class = "{'bp-dark-grey2-font':M_CO.Deal.DealInfo.DealStatus != 'Quotation'}">{{M_CO.DealUnitStatusMap[M_CO.Deal.DealInfo.UnitStatus]}}</span> 
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class = "col-xs-12">
                                                    <label class = "col-xs-12 dealType">{{'Deal_type' | translate}}</label>
                                                    <div class="col-xs-12 P0">
                                                        <span class = "text-uppercase dealTypeValue bp-grey-font">{{M_CO.Deal.DealInfo.DealType}}</span>
                                                    </div>
                                                </div>
                                                <div class="right col-xs-12 col-sm-12" ng-if = "(M_CO.CustomerCOBuyerCardInfo) || (!M_CO.CustomerCOBuyerCardInfo && M_CO.coHeaderRec.OrderStatus !== 'Closed' && M_CO.Deal.DealInfo.DealStatus !== 'Approved' && M_CO.Deal.DealInfo.DealStatus !== 'Invoiced')" ng-class="{'no-border':M_CO.Deal.showSearchCoBuyerDiv || M_CO.coHeaderRec.OrderStatus == 'Closed' || (M_CO.Deal.DealInfo.DealStatus == 'Approved'  || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'), 'add-customer-co-buyer' : M_CO.Deal.showSearchCoBuyerDiv}">
                                                    <label class = "col-xs-12 dealType">{{'Co-buyer' | translate}}</label>
                                                    <div class="col-xs-12 P0" ng-if = "!M_CO.Deal.showSearchCoBuyerDiv && !M_CO.CustomerCOBuyerCardInfo && M_CO.coHeaderRec.OrderStatus !== 'Closed' && M_CO.Deal.DealInfo.DealStatus != 'Approved'  && M_CO.Deal.DealInfo.DealStatus != 'Invoiced'">
                                                        <ul class="job-actions-buttons PL0" ng-class="{'bp-disabled': F_CO.isArchivedQuote()}">
                                                            <li ng-click="F_CO.showSearchCoBuyer()">
                                                                <div>
                                                                    <i ng-include="'{!Application_Images}/Icons/Add.svg'" class="violet_dark purple_dark bp-pointer-cursor"></i> 
                                                                    Add co-buyer
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <div ng-if = "M_CO.Deal.showSearchCoBuyerDiv && !M_CO.CustomerCOBuyerCardInfo  && M_CO.coHeaderRec.OrderStatus !== 'Closed' && M_CO.Deal.DealInfo.DealStatus != 'Approved'  && M_CO.Deal.DealInfo.DealStatus != 'Invoiced' && !F_CO.isArchivedQuote()" class="text-left col-xs-12 P0">
                                                        <label>{{'Search_for_a_co-buyer_customer' | translate}}</label>
                                                        <autocompletev2 ng-if="!M_CO.IsWebComponentSTAEnabled" id="autocompletev3Id"
                                                            template-name="Customer"
                                                            section-name="CustomerCoBuyer"
                                                            section-id="CustomerCoBuyer"
                                                            create-action-available-on-dropdown = "true"
                                                            default-value=""
                                                            selected-customer-id = "{{M_CO.coHeaderRec.CustomerId}}" />
                                                        <div class="searchToAdd" ng-if="M_CO.IsWebComponentSTAEnabled">
                                                            <bpda-search-to-add id="autocompleteCustomerCoBuyer" 
                                                                template-name="Customer"
                                                                section-name="CustomerCoBuyer"
                                                                section-id="CustomerCoBuyer"
                                                                selected-customer-id = "{{M_CO.coHeaderRec.CustomerId}}"
                                                                hide-filter-button="true"
                                                                placeholder="Search to add"
                                                            >
                                                            <bp-button id="createNewCustomer" slot="actions" raised="button">Create new customer</bp-button>
                                                            </bpda-search-to-add>
                                                        </div>
                                                        <div class="cancel-customer-co-buyer">
                                                            <a class="bp-blue-font H300" ng-click="F_CO.resetCustomerCoBuyer()">{{ 'Cancel' | translate }}</a> <!-- Remove customer -->
                                                        </div>
                                                        <div class="cancel-customer-co-buyer">
                                                            <a class="bp-blue-font H300" ng-click="F_CO.resetCustomerCoBuyer()">{{ 'Cancel' | translate }}</a> <!-- Remove customer -->
                                                        </div>
                                                    </div>
                                                    <div class="PT50 Customer-po-main-container- padding-bottom30" ng-if = "M_CO.CustomerCOBuyerCardInfo">
                                                        <div class="text-left col-xs-12 P0 no-background">
                                                            <entity-card add-new-entity-action = "" entity-card-payload = "M_CO.entityCustomerCOBuyerCardPayload" first-img-action = "F_CO.removeCustomerCoBuyer()" second-button-action = "F_CO.changeCustomerCoBuyer()" third-img-action = "F_CO.editNotes(M_CO.CustomerCOBuyerCardInfo.Id,M_CO.CustomerCOBuyerCardInfo.Notes,M_CO.CustomerCOBuyerCardInfo.Name,'customerCOBuyer')"></entity-card>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class = "col-xs-12 dealQuotation"  ng-if = "M_CO.Deal.DealInfo.DealStatus != 'Fulfilled'">
                                                    <label class = "col-xs-12">{{'Delivery_date' | translate}}</label>
                                                    <div class="col-xs-12 P0">
                                                        <div class="bp-cell  searchInputArea makeSeachingWrapper">
                                                            <div class="datePickerWrappercontainer" >
                                                                <input type="text" class="date-picker date-picker-adjust datepicker" id="DeliveryDate" placeholder="{{M_CO.dateFormat}}" 
                                                                	ng-model="M_CO.Deal.DealInfo.DeliveryDate" date-format="M_CO.dateFormat" 
                                                                	ng-disabled = "!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Approved'"
                                                                	ng-change="F_CO.Deal.saveDealInfo()" start-date = "M_CO.deliveryDate.minDate"  datepicker = "datepicker" autocomplete="off" readonly = "readonly" />
                                                           </div>
                                                        </div>  
                                                    </div>
                                                </div>
                                                <div class="col-xs-12">
                                                    <label class="col-xs-12">{{ 'Insurance_provider' | translate }}</label>
                                                    <div class="col-xs-12 P0">
                                                        <div class="bp-cell  searchInputArea " >
                                                            <input type="text" class="bp-input-text" placeholder="{{ 'Insurance_provider' | translate }}"
                                                                maxlength="255"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-model="M_CO.Deal.DealInfo.InsuranceProvider" 
                                                                ng-blur="F_CO.Deal.saveDealInfo()"
                                                                />
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-xs-12">
                                                    <label class="col-xs-12">{{ 'Insurance_policy#' | translate }}</label>
                                                    <div class="col-xs-12 P0">
                                                        <div class="bp-cell  searchInputArea " >
                                                            <input type="text" class="bp-input-text" placeholder="{{ 'Insurance_policy#' | translate }}"
                                                                maxlength="255"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-model="M_CO.Deal.DealInfo.InsurancePolicy" 
                                                                ng-blur="F_CO.Deal.saveDealInfo()"
                                                                />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class = "col-xs-12 dealQuotation"  ng-if = "M_CO.Deal.DealInfo.DealStatus != 'Fulfilled'">
                                                    <label class = "col-xs-12">Salesperson</label>
                                                    <div class="table-responsive technician-time-table" ng-if="M_CO.DealSalesPersonList.length > 0">
                                                        <table class = "bp-editable-table SOJobItemsGrid SOHoursLogGrid deal-salesperson-list">
                                                            <col width="5%" />
                                                            <col width="50%" />
                                                            <thead>
                                                                <tr>
                                                                    <th class = "bp-text-uppercase text-center">{{'Label_Name' | translate}}</th>
                                                                    <th></th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class = "bp-expanded-deletable-div-transition" ng-repeat="assignedSalesperson in M_CO.DealSalesPersonList" ng-init="AssignedSalespersonIndex = $index">
                                                                    <td class="PT0 PB0">
                                                                      <div class="first-name-wrappeer" data-toggle="tooltip" title="{{assignedSalesperson.NameInitials}}">
                                                                           <div class = "circle"
                                                                              >{{assignedSalesperson.NameInitials}}
                                                                           </div>  
                                                                        </div>
                                                                    </td>
                                                                    <td class="boldText LogTechId PL0">
                                                                        <div class="InnerFlexContainer">
                                                                            <span class =" hursLogged">{{::assignedSalesperson.TechnicianName}}</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                   </div>
                                                    <div ng-class="{'MT30' : M_CO.DealSalesPersonList.length == 0}">
                                                        <button class="bp-btn bp-btn-normal bp-first-letter-capitalize" id = "Assign_Salesperson" ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                            ng-click="F_CO.showTechnicianListOverlay('Assign_Salesperson', M_CO.Deal.DealInfo.Id, true)">{{'Label_Assign_Salesperson' | translate }}</button>            
                                                   </div>
                                                </div>
                                                  <div class = "col-xs-12 dealQuotation"  ng-if = "GroupOnlyPermissions['Costs']['modify'] && GroupOnlyPermissions['Deal commissions']['enabled']">
                                                        <label class = "col-xs-12">{{'Commission_Earned' | translate}}</label>
                                                        <div class="col-xs-12 P0">
                                                            <numbers-only id-value = "working-days"
                                                              class-value = "bp-input-text"
                                                              input-model-value = "M_CO.Deal.DealInfo.DealCommission" 
                                                              include-negative = "false"
                                                              include-zero = "true"
                                                              precision-length = "2"
                                                              place-holder-value="{{'Please_enter_amount' | translate}}"
                                                              max-length = '16'
                                                              include-blank = 'true'
                                                              disabled-value=" M_CO.Deal.DealInfo.DealStatus == 'Invoiced' || F_CO.isArchivedQuote()"
                                                              blur-value = "F_CO.Deal.saveDealCommissionInfo()"
                                                              />
                                                          </div>
                                                  </div>  
                                            </div>
                                            <!-- disabled-value = "GroupOnlyPermissions['Deal']['create/modify']" -->
                                           
                                            
                                            <div class = "col-xs-12 col-sm-6 form-container">
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6 bp-font-16">{{'Deal_total' | translate}}</label>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6 MT20">{{'SalesTaxGridItem_Units' | translate}}
                                                    <p ng-if="F_CO.isDealActionEnable() && !F_CO.isCommitAndInstallActionDone() && GroupOnlyPermissions['Deal']['create/modify']" ng-click="F_CO.addUnitToDeal()">{{'Label_Add' | translate}}</p>
                                                    </label>
                                                    
                                                    <span class = "col-xs-6 bp-dark-grey1-font MT20">{{M_CO.Deal.DealInfo.UnitsTotal | currency}}</span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6">{{'Trade_ins' | translate}}
                                                     <p ng-if="F_CO.isDealActionEnable()  && GroupOnlyPermissions['Deal']['create/modify']" ng-click="F_CO.addTradeInToDeal()">{{'Label_Add' | translate}}</p>
                                                    </label>
                                                   
                                                    <span class = "col-xs-6 bp-dark-grey1-font "  ng-if = "M_CO.Deal.DealInfo.TradeInsTotal >= 0">
                                                        {{M_CO.Deal.DealInfo.TradeInsTotal != null ? M_CO.Deal.DealInfo.TradeInsTotal : 0  | currency}}
                                                    </span>
                                                    <span class = "col-xs-6 bp-dark-grey1-font"  ng-if = "M_CO.Deal.DealInfo.TradeInsTotal < 0">
                                                        ({{(M_CO.Deal.DealInfo.TradeInsTotal != null ? (M_CO.Deal.DealInfo.TradeInsTotal)*-1 : 0) | currency}})
                                                    </span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6">{{'Lien_payout' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font">{{M_CO.Deal.DealInfo.LienPayoutTotal != null ? M_CO.Deal.DealInfo.LienPayoutTotal : 0  | currency}}</span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6">{{'Parts_labor' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font">{{M_CO.Deal.DealInfo.PartsAndLabourTotals != null ? M_CO.Deal.DealInfo.PartsAndLabourTotals : 0  | currency}}</span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6">{{'Other_products' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font ">{{M_CO.Deal.DealInfo.OtherProductsTotal != null ? M_CO.Deal.DealInfo.OtherProductsTotal : 0  | currency}}</span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6">{{'Fees' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font ">{{M_CO.Deal.DealInfo.FeesTotal != null ? M_CO.Deal.DealInfo.FeesTotal : 0 | currency}}</span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary" ng-if="CompanyLocale == 'Australia'">
                                                    <label class = "col-xs-6">{{'Stamp_duty' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font ">{{(M_CO.Deal.DealInfo.StampDutyTotal != null ? M_CO.Deal.DealInfo.StampDutyTotal : 0)| currency}}</span>
                                                </div>
                                                <div ng-if = "M_CO.Deal.DealInfo.DealType == 'Financed' && !M_CO.Deal.DealSummaryObj.IsTaxIncludingPricing">
                                                    <div class = "col-xs-12 dealTotalSummary">
                                                        <label class = "col-xs-6 bp-font-14">{{'Financing_products' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 ">{{ (M_CO.Deal.DealInfo.FIProductTotal ? M_CO.Deal.DealInfo.FIProductTotal : 0) | currency}}</span>
                                                    </div>
                                                </div>
                                               <div class = "col-xs-12 dealTotalSummary" ng-If="!M_CO.Deal.DealSummaryObj.IsTaxIncludingPricing">
                                                        <label class = "col-xs-6 bp-font-14">{{'Sales_taxes' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14" >{{ (M_CO.Deal.DealInfo.SalesTaxesTotal ? M_CO.Deal.DealInfo.SalesTaxesTotal : 0) | currency}}</span>
                                                    </div>
                                                <div class = "col-xs-12 dealTotalSummary" ng-If="M_CO.Deal.DealSummaryObj.IsTaxIncludingPricing">
                                                    <label class = "col-xs-6 bp-font-14 text-uppercase" ng-class="{'PL10': M_CO.Deal.DealInfo.DealType == 'Financed'}">{{'Deal_total' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 bp-bold-font " >{{ (M_CO.Deal.DealInfo.Total ? M_CO.Deal.DealInfo.Total : 0) | currency}}</span>
                                                </div>
                                                <div ng-if = "M_CO.Deal.DealInfo.DealType == 'Financed'">
                                                    <div ng-If="M_CO.Deal.DealSummaryObj.IsTaxIncludingPricing" class = "col-xs-12 dealTotalSummary">
                                                        <label class = "col-xs-6 bp-font-14">{{'Financing_products' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 ">{{ (F_CO.DealFinance.getFIProductTotal() ? F_CO.DealFinance.getFIProductTotal() : 0) | currency}}</span>
                                                    </div>
                                                    <div class = "col-xs-12 dealTotalSummary">
                                                        <label class = "col-xs-6 bp-font-14 PL10 text-uppercase">{{'Label_Total' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 bp-bold-font " > {{ F_CO.getDealTotal() | currency}}</span>
                                                    </div>
                                                    <div class = "col-xs-12 dealTotalSummary">
                                                        <label class = "col-xs-6 bp-font-14">{{'Less' | translate}}:{{'Down_payment' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 " >({{ (M_CO.Deal.DealFinanceObj.DownPayment ? M_CO.Deal.DealFinanceObj.DownPayment : 0) | currency}})</span>
                                                    </div>
                                                    <div class = "col-xs-12 dealTotalSummary">
                                                        <label class = "col-xs-6 bp-font-14 PL10 text-uppercase">{{'AMOUNT_FINANCED' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 bp-bold-font" >{{ (F_CO.DealFinance.getAmountFinanced() ? F_CO.DealFinance.getAmountFinanced() : 0 ) | currency}}</span>
                                                    </div>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary tax-based-on-customer-address">
                                                    <div class="row M0" ng-if="M_CO.IsAutomaticTaxRates && M_CO.coHeaderRec.CustomerId != undefined && M_CO.coHeaderRec.COType != 'Cash Sale'">
                                                        <div class="col-xs-3 P0">
                                                            <div class="col-lg-12 col-xs-12 values bp-dark-grey1-font">
                                                                <label class="bp-switch"> 
                                                                    <input ng-model="M_CO.Deal.DealInfo.IsTaxBasedOnCustomerAddress" type="checkbox" ng-disabled="((!GroupOnlyPermissions['Sales Taxes']['assign']) || !F_CO.isDealActionEnable())"
                                                                    ng-change="F_CO.toggleTaxBasedOnCustomerAddress('dealSummarySection')"/>
                                                                    <div class="bp-slider round"></div>
                                                                </label>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-9 P0 MT15">
                                                            <p class="bp-lh-19 bp-font-16 modified-p-margin-bottom">Tax based on the customer address</p>
                                                        </div>
                                                    </div>
                                                    <div class="row M0">
                                                        <div class="bp-alert-info MB15">
                                                            <bp-alert id="dealSummarySection" duration="5000" color="info" closable="true">
                                                                <bp-icon slot="icon" color="inherit">info</bp-icon>
                                                                The selected customer tax control will apply to the entire deal.
                                                            </bp-alert>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- End: Deal Summary accordian end here -->
                                <!-- End: inner Accordian level 1 -->
                                
                                <!-- Start: Deal Unresolved fulfillment section -->
                                <div class="bp-inner-accordian open bp-inner-accordian-deal" ng-if="M_CO.Deal.DealUnresolvedFulfillmentList.length > 0" ng-class="{'bp-inner-accordian-opened': M_CO.expandedInnerSectionName == 'Deal_UnrslvdFlflmnt', 'bp-inner-accordian-opened-deal': M_CO.expandedInnerSectionName == 'Deal_UnrslvdFlflmnt'}">
                                    <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInnerSection('Deal_UnrslvdFlflmntSectionId', 'Deal_UnrslvdFlflmnt')">
                                        <div class="inner-accordian-header-left">
                                           <h2 class="accordian-left-details">{{'Unresolved_fulfillments' | translate}}
                                            <span class="badge bp-yellow-dark" ng-if="M_CO.Deal.DealUnresolvedFulfillmentList.length > 0 && M_CO.expandedInnerSectionName != 'Deal_UnrslvdFlflmnt'">{{M_CO.Deal.DealUnresolvedFulfillmentList.length}}</span>
                                            </h2>
                                        </div>
                                        <div class="accordian-right-details">
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_UnrslvdFlflmnt'">
                                                <i class="bp-icons bp-blue-font bp-font-14 stroke-1 size-unset">arrowDown</i>
                                            </a>
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName == 'Deal_UnrslvdFlflmnt'">
                                                <i class="bp-icons bp-blue-font bp-font-14 stroke-1 size-unset">arrowUp</i>
                                            </a>
                                            <div class="accordian-right-details-text">
                                           </div>
                                        </div>
                                    </div>

                                    <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition P0"  
                                        id="Deal_UnrslvdFlflmntSectionId"
                                        ng-class="{'bp-expand-div-transition': M_CO.expandedInnerSectionName == 'Deal_Details'}">
                                        <div class="expandableContainer Deal_UnrslvdFlflmntSectionWrapper">
                                            <div class="table-responsive" ng-if = "M_CO.Deal.DealUnresolvedFulfillmentList.length > 0">
                                            <table class = "bp-editable-table SOJobItemsGrid Deal_UnrslvdFlflmntSection">
                                                <col width="5%"  />
                                                <col width="10%"  />
                                                <col width="23%"  />
                                                <col width="29%"  />
                                                <col width="10%"  />
                                                <col width="18%"  />
                                                <col width="5%"  />
                                                <thead>
                                                    <tr>
                                                        <th></th>
                                                        <th class = "bp-text-uppercase">{{'Item_description' | translate}}</th>
                                                        <th class = "bp-text-uppercase text-center">{{'For_unit' | translate}}</th>
                                                        <th class = "bp-text-uppercase text-center">{{'What_changed' | translate}}</th>
                                                        <th class = "bp-text-uppercase text-center">{{'User_Object_Display_Label' | translate}}</th>
                                                        <th class = "bp-text-uppercase text-left">{{'Label_Action_Required' | translate}}</th>
                                                        <th class = "bp-text-uppercase"></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class = "bp-expanded-deletable-div-transition" id = "Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}" 
                                                        ng-repeat="dealUnrslFlflmntObj in M_CO.Deal.DealUnresolvedFulfillmentList" ng-init="DealUnrslvFlflmntIndex = $index" ng-click = "F_CO.resolveDealUnresolvedFulFillment(dealUnrslFlflmntObj)">
                                                        <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}','inactive-link':!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()}">
                                                             <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="dealUnrslFlflmntObj.PartId">part</i>
                                                            <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="dealUnrslFlflmntObj.LabourId">labor</i>    
                                                            <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="dealUnrslFlflmntObj.FeeId">fee</i>
                                                            <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="dealUnrslFlflmntObj.SubletId">sublet</i>
                                                            <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="dealUnrslFlflmntObj.COKitHeaderId || dealUnrslFlflmntObj.SOKitHeaderId || dealUnrslFlflmntObj.DealKitHeaderId">kit</i>
                                                        </td>
                                                        <td class="boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()}">
                                                           
                                                            <div class="liItemDesc_setTextEllipsis"
                                                                ng-if="(M_CO.editLineItem != 'Deal_UnrslvFlflmnt' + DealUnrslvFlflmntIndex)">
                                                                <span>{{dealUnrslFlflmntObj.ItemCode}} - {{dealUnrslFlflmntObj.ItemDescription}}</span>
                                                            </div>
                                                        </td>
                                                        <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()}">
                                                            <span>{{dealUnrslFlflmntObj.RequiredForUnit}}</span>
                                                        </td>
                                                        <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()}">
                                                            <div class="InnerFlexContainer">
                                                                {{M_CO.DealUnresolvedFulfillmentMap[dealUnrslFlflmntObj.Type]}} <span ng-if = "dealUnrslFlflmntObj.Type != 'Updated'">:</span>
                                                                <span  ng-if = "dealUnrslFlflmntObj.Type == 'Added'" class =" text-right PL5">{{'Label_Quantity' | translate}} = {{dealUnrslFlflmntObj.UpdatedQty}}</span>
                                                                <span ng-if = "dealUnrslFlflmntObj.Type == 'Updated'" class =" text-right PL5">{{'Label_From' | translate}} {{dealUnrslFlflmntObj.ActualQty}} to {{dealUnrslFlflmntObj.UpdatedQty}}</span>
                                                                <span ng-if = "dealUnrslFlflmntObj.Type == 'Removed'" class =" text-right PL5">{{'Label_Quantity' | translate}} = {{dealUnrslFlflmntObj.UpdatedQty}}</span>
                                                            </div> 
                                                        </td>
                                                        <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()}">
                                                            <span>{{dealUnrslFlflmntObj.User}}</span>
                                                        </td>
                                                      <td class="text-left boldText bp-red-font bp-text-lowerCase" ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()}">
                                                            <span >{{dealUnrslFlflmntObj.ActionRequired}}</span>
                                                        </td>
                                                        <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()}">
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                                <!-- End: Deal Unresolved fulfillment section -->
                                
                                <!-- Start: inner Accordian level 1 -->
                                <!-- Start: Deal Unit accordian start here -->
                                <div class="bp-inner-accordian open bp-inner-accordian-deal" ng-repeat="unit in M_CO.Deal.UnitList" ng-init="UnitIndex = $index" ng-class="{'bp-inner-accordian-opened': M_CO.expandedInnerSectionName == 'Deal_DU{{$index}}', 'bp-inner-accordian-opened-deal': M_CO.expandedInnerSectionName == 'Deal_DU{{$index}}'}">
                                    <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInnerSection('Deal_DU'+$index+'_SectionId', 'Deal_DU'+$index, $index)">
                                        <div class="inner-accordian-header-left">
                                            <h2 class="accordian-left-details" ng-if="unit.DealItemObj.UnitId != null && unit.DealItemObj.UnitType != 'ORDU'"> 
                                                <span ng-if = "unit.DealItemObj.UnitType != 'COU'">{{unit.DealItemObj.StockNumber}}</span>
                                                <span ng-if = "unit.DealItemObj.UnitType == 'COU'">{{unit.DealItemObj.UnitNumber}}</span>
                                                <span class="bp-req-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_DU'+$index && M_CO.dealOptionsAndFeesStatusMap[M_CO.Deal.OptionStatus].length && M_CO.Deal.DealInfo.DealStatus != 'Invoiced'">!</span>
                                            </h2>
                                            <h2 class="accordian-left-details" ng-if="unit.DealItemObj.UnitId != null && unit.DealItemObj.UnitType == 'ORDU' ">{{unit.DealItemObj.UnitNumber}}
                                                <span class="bp-req-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_DU'+$index && M_CO.dealOptionsAndFeesStatusMap[M_CO.Deal.OptionStatus].length">!</span>
                                            </h2>
                                            <h2 class="accordian-left-details" ng-if="unit.DealItemObj.UnitId == null && unit.DealItemObj.Make != null">{{'Temporary_unit' | translate}} {{UnitIndex + 1}}</h2>
                                            <h2 class="accordian-left-details" ng-if="unit.DealItemObj.UnitId == null && unit.DealItemObj.Make == null">{{'Unit_Make_Object_Display_Label' | translate}} {{UnitIndex + 1}}</h2>
                                            <div class="show-onclse" ng-if="M_CO.expandedInnerSectionName != 'Deal_DU'+$index">
                                                {{unit.DealItemObj.FormattedName}}
                                            </div>
                                        </div>
                                        <div class="accordian-right-details">
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_DU'+$index">
                                                <i class="bp-icons bp-blue-font bp-font-14 stroke-1 size-unset">arrowDown</i>
                                            </a>
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName == 'Deal_DU'+$index">
                                                <i class="bp-icons bp-blue-font bp-font-14 stroke-1 size-unset">arrowUp</i>
                                            </a>
                                            
                                             <div class="accordian-right-details-text" ng-if = "M_CO.expandedInnerSectionName == 'Deal_DU'+$index  && F_CO.isDealActionEnable() && F_CO.isUnitAvailableForRemove(unit.OptionAndFeeList)">
                                                <p class="right-text required" ng-if = "M_CO.expandedInnerSectionName == 'Deal_DU'+$index && GroupOnlyPermissions['Deal']['create/modify'] && !F_CO.isArchivedQuote() && (!(F_CO.isSingleSKUPresent() && F_CO.TradeIn.isAnyCOUStocked() && unit.DealItemObj.UnitId != null))">
                                                    <span class="bp-font-14 bp-blue-font bp-cursor-pointer" ng-click="F_CO.openRemoveUnitModalFromDeal(UnitIndex, $event)">{{'Remove_unit' | translate}}</span> 
                                                    <span class="icon-container" ng-click="F_CO.openRemoveUnitModalFromDeal(UnitIndex, $event)">
                                                        <i class="bp-icons bp-blue-font bp-font-19">delete</i>
                                                    </span>
                                                </p>
                                            </div>
                                            <div class="accordian-right-details-text" ng-if="M_CO.expandedInnerSectionName != 'Deal_DU'+$index">
                                                <p class="bp-dark-grey1-font right-text required" ng-if="M_CO.expandedInnerSectionName != 'Deal_DU'+$index">
                                                    <span class="bp-dark-grey1-font bp-font-16">{{'Label_Total' | translate}}: {{unit.Total | currency}}</span> 
                                                </p>
                                            </div>
                                         </div>
                                    </div>
                                    <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition deal-wrapper P0" id="Deal_DU{{$index}}_SectionId"
                                        ng-class="{'bp-expand-div-transition': M_CO.expandedInnerSectionName == 'Deal_DU{{$index}}', 'bp-overflow-visible': M_CO.showMultiSelectDropDown}">
                                        <div class="expandableContainer unitSectionBody">
                                            
                                            <!-- Start: inner Accordian level 2 -->
                                            <!-- Start: Deal Unit Info accordian start here -->
                                            <div class="bp-inner-accordian second-level open"
                                                ng-class="{'bp-inner-accordian-opened': M_CO.expandedInner2SectionName == 'Deal_DU{{$index}}_Info', 'bp-border-bottom-none': unit.DealItemObj.UnitId == null && unit.DealItemObj.Make == null}">
                                                <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInner2Section('Deal_DU'+$index+'_InfoSectionId', 'Deal_DU'+$index+'_Info')">
                                                    <div class="inner-accordian-header-left">
                                                        <h2 class="accordian-left-details">{{'Unit_details' | translate}}</h2>
                                                        <div class="show-onclse" ng-if="M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_Info'">
                                                            {{unit.DealItemObj.FormattedName}}
                                                        </div>
                                                    </div>
                                                    <div class="accordian-right-details">
                                                        <a class="down-arrow-icon" ng-if = "M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_Info'">
                                                            <i class="bp-icons bp-blue-font bp-font-14 stroke-1 size-unset">arrowDown</i>
                                                        </a> 
                                                        <a class="down-arrow-icon" ng-if = "M_CO.expandedInner2SectionName == 'Deal_DU'+$index+'_Info'">
                                                            <i class="bp-icons bp-blue-font bp-font-14 stroke-1 size-unset">arrowUp</i>
                                                        </a>
                                                         <div class="accordian-right-details-text">
                                                            <p class="bp-dark-grey1-font right-text required" ng-if="M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_Info'">
                                                                <span class="bp-dark-grey1-font bp-font-16">{{'Label_Total' | translate}}: {{unit.Total | currency}}</span> 
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition P0" id="Deal_DU{{$index}}_InfoSectionId"
                                                    ng-class="{'bp-expand-div-transition': M_CO.expandedInner2SectionName == 'Deal_DU{{$index}}_Info', 'bp-overflow-visible': M_CO.showMultiSelectDropDown}">
                                                    <div>
                                                        <div class="expandableContainer" ng-if="unit.DealItemObj.UnitId != null || (unit.DealItemObj.UnitId == null && unit.DealItemObj.Make != null)">
                                                            <div class="second-level-accordian__content">
                                                                 <div class="left">
                                                                    <entity-card add-new-entity-action = "" entity-card-payload = "M_CO.unitIdToUnitImagesJsonMap[unit.DealItemObj.UnitId].unitCardInfoPayload" 
                                                                    first-img-action = "" first-button-action = "F_CO.moveToState('ViewUnit', {Id : unit.DealItemObj.UnitId}, true)" second-button-action = "F_CO.replaceUnitFromUnitCard(UnitIndex,unit.DealItemObj.UnitId)" 
                                                                    active-order-action = "" third-img-action = "F_CO.editNotes(unit.DealItemObj.UnitId,unit.DealItemObj.Notes,unit.DealItemObj.VIN,'unit',UnitIndex)" third-button-action ="F_CO.editNotes(unit.DealItemObj.UnitId,unit.DealItemObj.Notes,unit.DealItemObj.VIN,'unit',UnitIndex)" 
                                                                    open-unit-status-modal-window = "F_CO.openUnitStatusModalWindow(unit.DealItemObj.UnitId)" show-unit-status-modal-window = "M_CO.showUnitStatusModalWindow" close-dialog="F_CO.closeUnitStatusModalWindow()" set-unit-status="F_CO.setUnitStatus(unit.DealItemObj.UnitId)" 
                                                                    temporary-check="M_CO.temporaryCheck" required-check="M_CO.requiredCheck" change-temporary-status-flag = "F_CO.changeTemporaryStatusFlag()" change-required-status-flag = "F_CO.changeRequiredStatusFlag()"></entity-card>
                                                                    <div class = "col-xs-6 deal-item-mileage">
                                                                        <label class = "col-xs-12">{{ 'Label_Mileage' | translate }}</label>
                                                                        <numbers-only 
                                                                            class-value="bp-input-text"
                                                                            place-holder-value="{{ 'Placeholder_mileage' | translate }}"
                                                                            max-length="6"
                                                                            precision-length = "1"
                                                                            force-precision-length = "false"
                                                                            blur-value="F_CO.Deal.saveDealItemInfo($index, 'Unit')"
                                                                            input-model-value="unit.DealItemObj.Mileage" 
                                                                            disabled-value="!GroupOnlyPermissions['Deal']['create/modify'] || !F_CO.isDealActionEnable()" />
                                                                    </div>
                                                                    <div class="col-xs-6 deal-item-mileage-type">
                                                                        <label class = "col-xs-12">{{ 'Label_Type' | translate }}</label>
                                                                        <span class = "bp-autocomplete-image-icon">
                                                                            <i class="bp-icons bp-blue-font bp-font-14 stroke-5 size-unset" ng-click = "F_CO.setFocusOnInput('MileageTypeDealUnit' + $index)">arrowDown</i>
                                                                        </span>
                                                                        <div class="bp-cell searchInputArea">
                                                                            <input  type="text" id="MileageTypeDealUnit{{$index}}" class="bp-input-text" placeholder="{{ 'Mileage_type' | translate }}"
                                                                                autocomplete="off" ng-focus="F_CO.Deal.getMileageTypes($index, 'Unit')" ng-blur="F_CO.Deal.hideMileageTypes($index, 'Unit')"
                                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || !F_CO.isDealActionEnable()"
                                                                                ng-model="unit.DealItemObj.MileageType" />
                                                                            <div class="bp-autocomplete-dropdown-wrapper" id="MileageTypeDealUnitScrollDiv{{$index}}" 
                                                                                ng-if="unit.DealItemObj.showMileageTypes">
                                                                                <ul>
                                                                                    <li ng-repeat="type in M_CO.MileageTypeList" ng-mousedown="F_CO.Deal.selectMileageType(type, UnitIndex, 'Unit')">
                                                                                        <div class="fullName">{{type}}</div>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <div class="deal-tax-details">
                                                                        <div class="row M0" ng-if="M_CO.IsAutomaticTaxRates && M_CO.coHeaderRec.CustomerId != undefined && M_CO.coHeaderRec.COType != 'Cash Sale'">
                                                                            <div class="col-xs-3 P0">
                                                                                <div class="col-lg-12 col-xs-12 values bp-dark-grey1-font MT15">
                                                                                    <label class="bp-switch"> 
                                                                                        <input ng-model="M_CO.Deal.DealInfo.IsTaxBasedOnCustomerAddress" type="checkbox" ng-disabled="((!GroupOnlyPermissions['Sales Taxes']['assign']) || !F_CO.isDealActionEnable())"
                                                                                        ng-change="F_CO.toggleTaxBasedOnCustomerAddress('dealUnitSection', UnitIndex)"/>
                                                                                        <div class="bp-slider round"></div>
                                                                                    </label>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-xs-9 P0 MT15">
                                                                                <p class="bp-lh-19 bp-font-16 modified-p-margin-bottom">Tax based on the customer address</p>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row M0">
                                                                            <div class="bp-alert-info MB15">
                                                                                <bp-alert id="dealUnitSection{{UnitIndex}}" duration="5000" color="info" closable="true">
                                                                                    <bp-icon slot="icon" color="inherit">info</bp-icon>
                                                                                    The selected customer tax control will apply to the entire deal.
                                                                                </bp-alert>
                                                                            </div>
                                                                        </div>

                                                                        <div class="row M0">
                                                                            <div class="col-xs-3 P0">
                                                                                <div class="col-lg-12 col-xs-12 lables bp-bold-font bp-dark-grey1-font P0 bp-font-16">{{'ViewLabour_Taxable' | translate}}</div>
                                                                                <div class="col-lg-12 col-xs-12 values bp-dark-grey1-font MT18">
                                                                                    <label class="bp-switch"> 
                                                                                        <input ng-model="unit.DealItemObj.Taxable" type="checkbox" ng-disabled="((!GroupOnlyPermissions['Sales Taxes']['assign']) || !F_CO.isDealActionEnable())"
                                                                                        ng-change="F_CO.saveDealItemTaxInfo(unit.DealItemObj.Taxable, unit.DealItemObj.ApplicableTaxId, unit.DealItemObj.Id, UnitIndex, 'unit', unit.DealItemObj.UnitTaxApplicableOn)"/>
                                                                                        <div class="bp-slider round"></div>
                                                                                    </label>
                                                                                </div>
                                                                            </div>

                                                                            <div class="col-xs-9 P0" ng-if="unit.DealItemObj.Taxable">
                                                                                <p class="bp-lh-19 bp-font-16 modified-p-margin-bottom ng-binding">{{'Applicable_tax_Label' | translate}}</p>
                                                                                <div class="col-lg-12 P0">
                                                                                    <div class="account-type-container">
                                                                                        <div class="bp-autocomplete-Wrapper autocomplete_v2">
                                                                                            <span class="bp-autocomplete-image-icon">
                                                                                                <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="bp-blue bp-cursor-pointer svg_width_2px" ng-click = "M_CO.Deal.PrevApplicableTaxName=unit.DealItemObj.ApplicableTaxName; F_CO.setFocusOnInput('dealUnitSalesTaxRecInput_'+$index)"></i>
                                                                                            </span>
                                                                                            <input  type="text" id="dealUnitSalesTaxRecInput_{{$index}}" class="bp-autocomplete-input bp-cursor-pointer bp-input-text  manage-long-salesperson-person" placeholder="{{'Please_select' | translate }}"
                                                                                            autocomplete="off" ng-keyup="F_CO.keyPressNavigationOnDropdownElements($event, 'dealUnitSalesTaxRecDropdownDiv', 'dealUnitSalesTaxRec', M_CO.applicableSalesTaxList, unit.DealItemObj.ApplicableTaxName, ('dealUnitSalesTaxRecInput_' + $index))"
                                                                                            ng-model="unit.DealItemObj.ApplicableTaxName" 
                                                                                            ng-focus = "M_CO.showSalesTaxListDropdown = true; F_CO.setDealApplicableTaxDefaultDataOnFocus(unit.DealItemObj.Id, UnitIndex, 'unit', unit.DealItemObj.Taxable, unit.DealItemObj.OverrideTaxForAllLineItems);"
                                                                                            ng-blur="F_CO.setApplicableTaxPrevValue(); M_CO.showSalesTaxListDropdown = false; F_CO.hideDropdown();"  
                                                                                            ng-disabled="((!GroupOnlyPermissions['Sales Taxes']['assign']) || !F_CO.isDealActionEnable())"/>                       
                                                                                            <div class = "bp-autocomplete-dropdown-wrapper" ng-if="M_CO.showSalesTaxListDropdown" id="dealUnitSalesTaxRecDropdownDiv">
                                                                                                <ul>
                                                                                                    <li ng-repeat="salesTax in M_CO.filteredApplicableSalesTaxList track by $index" id="dealUnitSalesTaxRec_{{$index}}"
                                                                                                       ng-class="{'selected-row': $index == M_CO.currentDropDownIndex}"
                                                                                                       ng-mousedown="F_CO.selcectDealItemSalesTax(salesTax)">
                                                                                                        <div class="form-group-info col-xs-12 P0">
                                                                                                            <span >{{salesTax.Name}}</span>
                                                                                                        </div>
                                                                                                    </li> 
                                                                                                </ul>
                                                                                                 <ul ng-If="M_CO.filteredApplicableSalesTaxList.length == 0">
                                                                                                    <li id="unitSalesTaxNoResults" class="BP_angucomplete-row-NoResults-Msg">
                                                                                                        <div class="">{{'No_Results_Found' | translate}}</div>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        
                                                                        <div class="d-flex tax-detail-toggle override-tax-for-all-line-items">
                                                                            <div class="tax-detail-label lables bp-bold-font bp-dark-grey1-font P0 bp-font-16">{{'Tax_these_options_the_same_way' | translate}}</div>
                                                                            <div class="values bp-dark-grey1-font">
                                                                                <div class="multi-select-dropdown-wrapper">
                                                                                    <multi-select ng-if="M_CO.unitTaxApplicableObj.unitIndex == $index" result-list = "M_CO.unitTaxApplicableObj.unitTaxApplicableOn" type = "option type" select-all-rec = "M_CO.unitTaxApplicableObj.isUnitTaxApplicableOnAllOptionType" disable-control=" !F_CO.isDealActionEnable()" section-name="dealUnit" />
                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                        <div class="row all-options-taxed-locally-label">
                                                                            All other options will be taxed locally
                                                                        </div>
                                                                    </div>
                                                                    
                                                                        
                                                                    <div class="bp-orange-dark-font dealStatusValue required deal-warning-msg-container" ng-if="M_CO.dealOptionsAndFeesStatusMap[M_CO.Deal.OptionStatus].length && M_CO.Deal.DealInfo.DealStatus != 'Invoiced'">
                                                                        <span class="req-icon">!</span>
                                                                        <span class="warning-msg">
                                                                            <p class = "dealquation M0">{{M_CO.dealOptionsAndFeesStatusMap[M_CO.Deal.OptionStatus][0]}}</p>
                                                                            <span class = "dealquation bp-bold-font">{{'Label_Action_Required' | translate}}:</span><span class = "dealquation action-text"> {{M_CO.dealOptionsAndFeesStatusMap[M_CO.Deal.OptionStatus][1]}}</span>
                                                                        </span>
                                                                       
                                                                    </div>
                                                                 </div>
                                                                 <div class="right">
                                                                    <div class="row M0 PT0" ng-if="CompanyLocale == 'Australia'">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Enforce_rideway_pricing' | translate }}</div>
                                                                        <!-- <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">
                                                                         <div class="action">
                                                                            <label class="switch ">
                                                                                <input type="checkbox" />
                                                                                <div class="slider round"></div>
                                                                            </label>
                                                                         </div>
                                                                        </div> -->
                                                                    <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">{{unit.IsRideawayPricingEnabled ? 'YES' : 'NO'}}</div>
                                                                    </div>
                                                                    <div class="row M0" ng-if="CompanyLocale == 'Australia' && unit.IsRideawayPricingEnabled">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font"></div>
                                                                        <div class="col-lg-4 col-md-4 values bp-purple-font bp-bold-font">{{unit.TotalEnforceRideawayPrice | currency}} <!-- $12,500.00 --></div>
                                                                    </div>
                                                                    <div class="row M0">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Base_unit_price' | translate }}</div>
                                                                        <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">
                                                                            <span ng-class="{'locked': unit.IsRideawayPricingEnabled}">{{unit.TotalBasePrice | currency}} <!-- $12,500.00 --></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row M0">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Factory_options' | translate }}</div>
                                                                        <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">{{unit.TotalFactoryOption | currency}} <!-- $0.00 --></div>
                                                                    </div>
                                                                    <div class="row M0">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Dealer_installed_options' | translate }}</div>
                                                                        <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">{{unit.TotalDealerInstalledOption | currency}} <!-- $0.00 --></div>
                                                                    </div>
                                                                    <div class="row M0">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Options_and_fees' | translate }}</div>
                                                                        <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">{{unit.TotalOptionAndFeeWithKit | currency}} <!-- $150.00 --></div>
                                                                    </div>
                                                                    <div class="row M0" ng-if="CompanyLocale == 'Australia'">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Stamp_duty' | translate }}</div>
                                                                        <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">
                                                                            <span ng-class="{'locked': unit.IsRideawayPricingEnabled}">{{unit.TotalStampDuty | currency}} <!-- $0.00 --></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row M0">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font">
                                                                            <a class="bp-blue-font" ng-if="(M_CO.Deal.DealInfo.DealStatus != 'Invoiced' && M_CO.Deal.DealInfo.DealStatus != 'Approved') && GroupOnlyPermissions['Deal']['create/modify'] && !F_CO.isArchivedQuote()" ng-click="unit.DealItemObj.Status =='Temporary' ? F_CO.openEditTempUnit(unit.DealItemObj.Id, UnitIndex,'Deal Unit', 'Temp Unit') : unit.DealItemObj.Status =='Required' ? F_CO.openEditTempUnit(unit.DealItemObj.Id, UnitIndex,'Deal Unit', 'Temp Unit') : F_CO.openEditPricingPopup(UnitIndex)">{{ 'Edit_pricing' | translate }}</a>
                                                                       </div>                                                              
                                                                    </div>
                                                                </div>
                                                            </div> 
                                                        </div>
                                                        <div class="select-customer-section unit" ng-if="(unit.DealItemObj.UnitId == null && unit.DealItemObj.Make == null) || M_CO.isReplaceUnit">
                                                        <div class="left dealsectionUnitSearch">
                                                            <label>{{ 'Search_for_a_stock_unit' | translate }}</label>
                                                            <autocompletev2 ng-if="!M_CO.IsWebComponentSTAEnabled" id="autocompletev2SKUId"
                                                                template-name="Entity"
                                                                section-name="Stock Unit"
                                                                unit-index="{{UnitIndex}}"
                                                                section-id="DealUnit{{UnitIndex}}"
                                                                is-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()"
                                                                selected-customer-id = "{{M_CO.coHeaderRec.CustomerId}}"
                                                                />
                                                            <div class="searchToAdd" ng-if="M_CO.IsWebComponentSTAEnabled">
                                                                <bpda-search-to-add id="autocompleteDealUnit{{UnitIndex}}" 
                                                                    template-name="Entity"
                                                                    section-name="Stock Unit"
                                                                    unit-index="{{UnitIndex}}"
                                                                    section-id="DealUnit{{UnitIndex}}"
                                                                    selected-customer-id = "{{M_CO.coHeaderRec.CustomerId}}"
                                                                    hide-filter-button="true"
                                                                    placeholder="Search to add"
                                                                    ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()"
                                                                >
                                                                </bpda-search-to-add>
                                                            </div>
                                                        </div>
                                                        <div class="right MT7">
                                                            <button  ng-disabled = "!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()" ng-if="unit.DealItemObj.UnitId == null && unit.DealItemObj.Make == null && M_CO.Deal.DealInfo.DealStatus == 'Quotation'" class="bp-btn bp-btn-normal temporary-unit-btn" ng-click="F_CO.openAddEditTempUnitPopup(unit.DealItemObj.Id, UnitIndex,'Deal Unit', 'Temp Unit')">{{ 'Or_Set_a_temporary_unit' | translate }}</button>
                                                            <button  ng-disabled = "!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()" ng-if="!(unit.DealItemObj.UnitId == null && unit.DealItemObj.Make == null) && M_CO.isReplaceUnit" class="bp-btn bp-btn-normal" ng-click="M_CO.isReplaceUnit = false">{{ 'Cancel_Label' | translate }}</button>
                                                        </div>
                                                    </div>
                                                </div>
                                                </div>
                                            </div>
                                            <!-- End: inner Accordian level 2 -->
                                            <!-- End: Deal Unit Info accordian start here -->
                                
                                            <!-- Start: inner Accordian level 2 -->
                                            <!-- Start: Deal Unit Items accordian start here -->
                                            <div class="bp-inner-accordian second-level open dealOptionFeeGridWrapper" ng-class="{'bp-inner-accordian-opened': M_CO.expandedInner2SectionName == 'Deal_DU{{$index}}_UI'}"
                                                ng-if="unit.DealItemObj.UnitId != null || (unit.DealItemObj.UnitId == null && unit.DealItemObj.Make != null)">
                                                <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInner2Section('Deal_DU'+$index+'_UISectionId', 'Deal_DU'+$index+'_UI')">
                                                    <div class="inner-accordian-header-left">
                                                        <h2 class="accordian-left-details">{{ 'Options_fees' | translate }}
                                                        <span class="badge" ng-if="M_CO.Deal.UnitList[UnitIndex].DealKitHeaderList.length > 0 && M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_UI'">{{M_CO.Deal.UnitList[UnitIndex].DealKitHeaderList.length}}</span></h2>
                                                    </div>
                                                    <div class="show-onclse" ng-if="M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_UI' && M_CO.Deal.UnitList[UnitIndex].DealKitHeaderList.length == 0" >
                                                            {{ 'You_can_add_here_additional_parts_or_options' | translate }}
                                                        </div>
                                                    <div class="accordian-right-details">
                                                        <a class="down-arrow-icon" ng-if = "M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_UI'">
                                                            <i class="bp-icons bp-blue-font bp-font-14 stroke-1 size-unset">arrowDown</i>
                                                        </a>  
                                                        
                                                        <a class="down-arrow-icon" ng-if = "M_CO.expandedInner2SectionName == 'Deal_DU'+$index+'_UI'">
                                                            <i class="bp-icons bp-blue-font bp-font-14 stroke-1 size-unset">arrowUp</i>
                                                        </a>
                                                        
                                                        <div class="accordian-right-details-text" ng-if="M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_UI'">
                                                            <p class="bp-dark-grey1-font right-text required">
                                                                <span class="bp-dark-grey1-font bp-font-16">{{ 'Label_Total' | translate }}: {{unit.TotalOptionAndFeeWithKit | currency}}</span> 
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition P0"  id="Deal_DU{{$index}}_UISectionId"  
                                                     ng-class="{'bp-expand-div-transition': M_CO.expandedInner2SectionName == 'Deal_DU{{$index}}_UI', 'bp-overflow-visible': M_CO.showMultiSelectDropDown}">
                                                    <div class="expandableContainer PB8">
                                                        <div class="second-level-accordian__content">
                                                            <div class="c-sub-heading banner-container orange-banner" ng-if="!M_CO.showDealUnresolvedFulfillmentBanner && M_CO.Deal.DealUnresolvedFulfillmentList && M_CO.Deal.DealUnresolvedFulfillmentList.length > 0 " >
                                                                <i class="bp-icons bp-font-16 bp-orange-font">warningFilled</i>
                                                                <div>
                                                                    <p>Cant add options</p>
                                                                    <span>You cannot commit options while there are outstanding unresolved fulfillments. Please resolve them before proceeding with a commitment of additional options.</span>
                                                                </div>
                                                                <i class="bp-icons dark-grey1" ng-click = "M_CO.showDealUnresolvedFulfillmentBanner = true">close</i>
                                                            </div>
                                                            <div class="table-responsive MT30 " ng-if="M_CO.Deal.UnitList[UnitIndex].DealKitHeaderList.length > 0"  ng-class = " {'PB67' : M_CO.coHeaderRec.OrderStatus === 'Closed'}">
                                                                <table class="bp-editable-table SOJobItemsGrid dealOptionFeeGrid">
                                                                    <col width="5%" />
                                                                    <col width="9%" />
                                                                    <col width="5%" />
                                                                    <col width="15%" />
                                                                    <col width="30%" />
                                                                    <col width="12%" />
                                                                    <col width="12%" />
                                                                    <col width="12%" />
                                                                    <thead>
                                                                        <tr>
                                                                            <th></th>
                                                                            <th class="bp-text-uppercase ">{{ 'Item_description' | translate }}</th>
                                                                            <th class="bp-text-uppercase text-center">{{ 'Install' | translate }}</th>
                                                                            <th class="bp-text-uppercase text-center">{{ 'Qty_needed' | translate }}</th>
                                                                            <th class="bp-text-uppercase text-center">{{ 'Label_Status' | translate }}</th>
                                                                            <th class="bp-text-uppercase text-center">{{ 'Label_Price' | translate }}</th>
                                                                            <th class="bp-text-uppercase text-center">{{ 'Label_Subtotal' | translate }}</th>
                                                                            <th></th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody ng-repeat="dealKitHeader in M_CO.Deal.UnitList[UnitIndex].DealKitHeaderList" ng-init="kitHeaderIndex = $index">
                                                                        <!-- Start: Kit Header Row -->
                                                                        <tr ng-if="dealKitHeader.Id" class="bp-expanded-deletable-div-transition kitHeaderTr bp-tr-hover bp-disabled-tr" 
                                                                            id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}"
                                                                            ng-click="F_CO.editDealKHItem('deal', UnitIndex, kitHeaderIndex);"
                                                                            ng-class="{'dummy-animation':dealKitHeader.isAsyncActionInProgress}">
                                                                            <td ng-class="{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                                <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem">kit</i>
                                                                            </td>
                                                                            <td class="boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                                <div class="liItemDesc_setTextEllipsis">
                                                                                    <span class="bp-blue-font">{{::dealKitHeader.ItemDescription}}</span>
                                                                                </div>
                                                                            </td>
                                                                            <td ng-if="dealKitHeader.IsDummyKit" class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}'}"><div class="dummy-tag-name"></div></td>
                                                                            <td ng-if="!dealKitHeader.IsDummyKit" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-bg-disabled-div': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}"> <!-- ,'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                                                                                                                        &&(!F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex) -->
                                                                               <label class="bp-switch optionFeeSwitch" id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_IsInstallFlag">
                                                                                   <input type="checkbox" ng-disabled="dealKitHeader.IsServiceKit || !GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()" 
                                                                                         ng-model="dealKitHeader.IsInstall" ng-click="F_CO.installOptionFeeAction(UnitIndex, kitHeaderIndex, null)"/>
                                                                                   <div class="bp-slider round" ng-class = "{'disableCheckBox' : (!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || dealKitHeader.IsServiceKit)}"></div>
                                                                                </label>
                                                                            </td>
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                            </td>
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                            </td>
                                                                            <td ng-if="dealKitHeader.isAsyncActionInProgress" class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}'}"><div class="dummy-tag-name"></div></td>
                                                                            <td ng-if="dealKitHeader.isAsyncActionInProgress" class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}'}"><div class="dummy-tag-name"></div></td>
                                                                            <td ng-if="!dealKitHeader.isAsyncActionInProgress" class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                                <span ng-if = "(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex || dealKitHeader.IsFixedPrice)"
                                                                                    ng-class="{'fixedPriceWithLock': (dealKitHeader.IsFixedPrice || dealKitHeader.IsFixedPriceForCO), 'pull-left': (dealKitHeader.IsFixedPrice || dealKitHeader.IsFixedPriceForCO)}">{{::dealKitHeader.Price | currency}}</span>
                                                                                
                                                                                <span ng-if = "(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex && !dealKitHeader.IsFixedPrice)">
                                                                                    <numbers-only id-value = "deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_Price"
                                                                                        class-value = "bp-input-text inTimeEdit timeField text-center"
                                                                                        input-model-value = "dealKitHeader.Price" 
                                                                                        include-negative = "false"
                                                                                        include-zero = "true"
                                                                                        precision-length = "2"
                                                                                        blur-value = "F_CO.updateOFKHItem('deal', UnitIndex, kitHeaderIndex, $event)"
                                                                                        input-keydown-value="F_CO.setFlagOnTabForBlurHandling($event)"/>
                                                                                </span>
                                                                                <i class="bp-icons bp-font-12 bp-grey-font pull-left lockSvg" ng-if="(dealKitHeader.IsFixedPrice) && (M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex)">lock</i>
                                                                                <i class="bp-icons bp-font-12 bp-grey-font pull-left lockSvg" ng-if="(dealKitHeader.IsFixedPriceForCO) && (M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex)">lock</i>
                                                                            </td>
                                                                            <td ng-if="!dealKitHeader.isAsyncActionInProgress" class="text-center boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                                <span>{{::dealKitHeader.Price | currency}}</span>
                                                                            </td>
                                                                            <td ng-if="dealKitHeader.IsDummyKit" class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}'}"><div class="dummy-tag-name"></div></td>
                                                                            <td ng-if="!dealKitHeader.IsDummyKit" class="partInvIconAdjustment" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-bg-disabled-div': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)
                                                                                    && (GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable() && (M_CO.Deal.OptionStatus === 'Required' || M_CO.Deal.OptionStatus === 'None')),
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)
                                                                                    && (!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || !F_CO.isDealActionEnable() || (M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None'))}"> <!-- 'bp-disabled': (!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || !F_CO.isDealActionEnable() || (M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None')) -->
                                                                                <div class = ""  >
                                                                                <span data-toggle="tooltip" title="Delete" tooltip-loader = "tooltip-loader" ng-if = "GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable() && (M_CO.Deal.OptionStatus === 'Required' || M_CO.Deal.OptionStatus === 'None') && !F_CO.isOptionFeeCommitAndInstalled(dealKitHeader.OptionAndFeeList[0].OptionStatus)" 
                                                                                id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_deleteBtn">
                                                                                    <i class="bp-icons bp-blue-font bp-font-18 LIDeleteBtn" ng-click="F_CO.openDeleteConfirmationPopupForOptionFeeLineItem(UnitIndex, kitHeaderIndex, optionFeeIndex, M_CO.Deal.UnitList[UnitIndex].DealItemObj.Id, dealKitHeader.Id, OptionFee.Id, 'deal');">delete</i>
                                                                                </span>
                                                                                <span  ng-if = "!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || !F_CO.isDealActionEnable() || (M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None') || F_CO.isOptionFeeCommitAndInstalled(dealKitHeader.OptionAndFeeList[0].OptionStatus)">
                                                                                    <i class="bp-icons bp-font-12 bp-grey-font pull-left lockSvg">lock</i>
                                                                                </span>
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                        <!-- End: Kit Header Row -->
                                                                        
                                                                        <!-- Start: Line Items Row with Kit Header -->
                                                                        <tr class="bp-expanded-deletable-div-transition kitLITr bp-tr-hover" id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{$index}}"
                                                                            ng-repeat-start="optionFee in dealKitHeader.OptionAndFeeList" ng-init="optionFeeIndex = $index" ng-if="dealKitHeader.Id"
                                                                            ng-click="F_CO.editOptionFee('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, (optionFee.PartId && !optionFee.IsNonInventoryPart))"
                                                                            ng-class="{'no-border':dealKitHeader.Id && M_CO.supersededParts[optionFee.PartId] != null,'dummy-animation':dealKitHeader.isAsyncActionInProgress}">
                                                                            
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                            </td>
                                                                            <td class="boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <div class="liItemDesc_setTextEllipsis" 
                                                                                    ng-if="(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex) || (optionFee.PartId && !optionFee.IsNonInventoryPart) 
                                                                                        || (F_CO.isOptionFeeCommitAndInstalled(optionFee.OptionStatus))">
                                                                                    <i class="bp-icons pull-left bp-font-23 bp-grey-font stroke-3 itemSvg kitItemSvg" ng-if="optionFee.PartId">part</i>
                                                                                    <i class="bp-icons pull-left bp-font-23 bp-grey-font stroke-3 itemSvg kitItemSvg" ng-if="optionFee.LabourId">labor</i>
                                                                                    <i class="bp-icons pull-left bp-font-23 bp-grey-font stroke-3 itemSvg kitItemSvg" ng-if="optionFee.FeeId">fee</i>
                                                                                    <i class="bp-icons pull-left bp-font-23 bp-grey-font stroke-3 itemSvg kitItemSvg" ng-if="optionFee.ProductId">sublet</i>
                                                                                    <span class="bp-blue-font" ng-class="{'bp-blue-hover' : optionFee.PartId}" 
                                                                                        ng-click="F_CO.moveToState('ViewPart',{Id:optionFee.PartId},(optionFee.PartId && !optionFee.IsNonInventoryPart))"
                                                                                        id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_itemDesc">
                                                                                        {{::optionFee.ItemCode}} - {{::optionFee.ItemDescription}}
                                                                                   </span>
                                                                                </div>
                                                                                
                                                                                <div class="liItemDesc" ng-if="(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex) && (!optionFee.PartId || (optionFee.PartId && optionFee.IsNonInventoryPart)) 
                                                                                    && (!F_CO.isOptionFeeCommitAndInstalled(optionFee.OptionStatus))">
                                                                                    <i class="bp-icons pull-left bp-font-23 bp-grey-font stroke-3 itemSvg kitItemSvg" ng-if="optionFee.PartId">part</i>
                                                                                    <i class="bp-icons pull-left bp-font-23 bp-grey-font stroke-3 itemSvg kitItemSvg" ng-if="optionFee.LabourId">labor</i>
                                                                                    <i class="bp-icons pull-left bp-font-23 bp-grey-font stroke-3 itemSvg kitItemSvg" ng-if="optionFee.FeeId">fee</i>
                                                                                    <i class="bp-icons pull-left bp-font-23 bp-grey-font stroke-3 itemSvg kitItemSvg" ng-if="optionFee.ProductId">sublet</i>
                                                                                    <span class="editableDescInput editableKitDescInput">
                                                                                        <span class="itemCode">{{::optionFee.ItemCode}} - </span>
                                                                                        <input id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_itemDesc"
                                                                                            class="bp-input-text text-center"
                                                                                            type="text" ng-model="optionFee.ItemDescription" 
                                                                                            ng-blur="F_CO.updateOFLineItem('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, $event)"
                                                                                            ng-keydown="F_CO.setFlagOnTabForBlurHandling($event)"
                                                                                            maxlength = "255"/>
                                                                                    </span>
                                                                                </div>
                                                                            </td>
                                                                            
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                            </td>
                                                                            <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span>{{::optionFee.Qty}}</span>
                                                                            </td>
                                                                            <td class="text-center bp-bold-font" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                               <span ng-if="optionFee.PartId">
                                                                                <bp-ng-badge value="{{optionFee.Status}}"  class-value="{{optionFee.Status  | lowercase}}-badge" />   
                                                                                <!-- {{::optionFee.Status}}  ng-class = "{'bp-green-font': optionFee.Status == 'In Stock','bp-red-font': optionFee.Status == 'Required' || optionFee.Status == 'Oversold','bp-green-dark-font': optionFee.Status == 'Invoiced','bp-orange-font': optionFee.Status == 'Ordered'}" --></span>
                                                                                <span ng-if = "optionFee.OptionStatus == 'Committed'">
                                                                                    <bp-ng-badge value="{{optionFee.OptionStatus}}"  class-value="{{optionFee.OptionStatus | lowercase}}-badge" />  
                                                                                   </span>
                                                                            </td>
                                                                            <td ng-if="dealKitHeader.isAsyncActionInProgress" class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}'}"><div class="dummy-tag-name"></div></td>
                                                                            <td ng-if="dealKitHeader.isAsyncActionInProgress" class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}'}"><div class="dummy-tag-name"></div></td>
                                                                            <td ng-if="!dealKitHeader.isAsyncActionInProgress" class="text-center price-edit" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span ng-if = "(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex
                                                                                    || !GroupOnlyPermissions['Override price'].enabled || optionFee.IsFixedPrice)"
                                                                                ng-class="{'fixedPriceWithLock': (optionFee.IsFixedPrice || optionFee.IsFixedPriceForCO), 'pull-left': (optionFee.IsFixedPrice || optionFee.IsFixedPriceForCO)}">{{::optionFee.Price | currency}}</span>
                                                                                <span ng-if = "(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex
                                                                                    && GroupOnlyPermissions['Override price'].enabled && !optionFee.IsFixedPrice)">
                                                                                    <numbers-only id-value = "deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_Price"
                                                                                        class-value = "bp-input-text inTimeEdit timeField text-center"
                                                                                        input-model-value = "optionFee.Price" 
                                                                                        include-negative = "false"
                                                                                        include-zero = "true"
                                                                                        precision-length = "2"
                                                                                        blur-value = "F_CO.updateOFLineItem('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, $event)"
                                                                                        input-keydown-value="F_CO.setFlagOnTabForBlurHandling($event)"/>
                                                                                </span>
                                                                                <i class="bp-icons bp-font-12 bp-grey-font pull-left lockSvg" ng-if="(optionFee.IsFixedPrice) && (M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex)">lock</i>
                                                                                <i class="bp-icons bp-font-12 bp-grey-font pull-left lockSvg" ng-if="(optionFee.IsFixedPriceForCO) && (M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex)">lock</i>

                                                                                <span class="price-variance-warning" ng-if="(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex || !GroupOnlyPermissions['Override price'].enabled || optionFee.IsFixedPrice) && optionFee.Status == 'Required' && M_CO.IsForeignExchangeCostingEnabled && optionFee.IsForeignVendor">
                                                                                    <span data-toggle="tooltip" data-original-title="{{'Special_ordering_a_foreign_part_click_to_learn_more' | translate}}" data-html="true">
                                                                                        <i ng-click="F_CO.openPriceVarianceWarningModal($event)" class="bp-icons bp-tart-orange-font bp-font-14">warningFilled</i>
                                                                                    </span>
                                                                                </span>
                                                                                <span ng-if="(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex && GroupOnlyPermissions['Override price'].enabled && !optionFee.IsFixedPrice && optionFee.Status == 'Required' && M_CO.IsForeignExchangeCostingEnabled && optionFee.IsForeignVendor)">
                                                                                    <span class="warning-icon" data-toggle="tooltip" data-original-title="{{'Special_ordering_a_foreign_part_click_to_learn_more' | translate}}" data-html="true">
                                                                                        <i ng-click="F_CO.openPriceVarianceWarningModal($event)" class="bp-icons bp-tart-orange-font bp-font-14">warningFilled</i>
                                                                                    </span>
                                                                                </span>
                                                                            </td>
                                                                            <td ng-if="!dealKitHeader.isAsyncActionInProgress" class="text-center boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span>{{(optionFee.Total) | currency}}</span>
                                                                            </td>
                                                                            <td ng-if="optionFee.IsDummyLineItem" class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}'}"><div class="dummy-tag-name"></div></td>
                                                                            <td ng-if="!optionFee.IsDummyLineItem" class="partInvIconAdjustment" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                 <div class = "" ng-if = "GroupOnlyPermissions['Deal']['create/modify'] && !F_CO.isArchivedQuote() && GroupOnlyPermissions['Override price'].enabled
                                                                                                && M_CO.Deal.DealInfo.DealStatus != 'Invoiced' && (!optionFee.PartId || optionFee.Status != 'Fulfilled')">
                                                                                 </div> 
                                                                           </td>
                                                                        </tr>
                                                                        <tr ng-repeat-end="ng-repeat-end" ng-if="dealKitHeader.Id && M_CO.supersededParts[optionFee.PartId] != null && M_CO.Deal.DealInfo.DealStatus != 'Invoiced'">
                                                                            <td></td>
                                                                            <td colspan="8">
                                                                                <div class="show_Availableline text-uppercase bgYellow"><span class="logo-icon">i</span>{{ 'part_has_been_superseded_to' | translate }} : {{M_CO.supersededParts[optionFee.PartId].partNumber}}</div>
                                                                             </td>
                                                                             <td></td>
                                                                        </tr>
                                                                        <!-- End: Line Items Row with Kit Header -->
                                                                        
                                                                        <!-- Start: Line Items Row without Kit Header -->
                                                                        <tr class="bp-expanded-deletable-div-transition bp-tr-hover bp-disabled-tr" id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{$index}}"
                                                                            ng-repeat-start="OptionFee in dealKitHeader.OptionAndFeeList" ng-init="optionFeeIndex = $index" ng-if="!dealKitHeader.Id"
                                                                            ng-click="F_CO.editOptionFee('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, (OptionFee.PartId && !OptionFee.IsNonInventoryPart))"
                                                                            ng-class="{'no-border':!dealKitHeader.Id && M_CO.supersededParts[OptionFee.PartId] != null,'dummy-animation':dealKitHeader.isAsyncActionInProgress}">
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="OptionFee.PartId">part</i>
                                                                                <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="OptionFee.LabourId">labor</i>
                                                                                <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="OptionFee.FeeId">fee</i>
                                                                                <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="OptionFee.ProductId && OptionFee.ProductType == 'Sublet'">sublet</i>  
                                                                                <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="OptionFee.ProductId && OptionFee.ProductType == 'Warranty Plan'">warrantyProduct</i>
                                                                                <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="OptionFee.ProductId && OptionFee.ProductType == 'Financing Product'">financeProduct</i>
                                                                                <i class="bp-icons bp-font-25 bp-grey-font stroke-3 tableItem" ng-if="OptionFee.ProductId && OptionFee.ProductType == 'Deal Product'">dealFinancing</i>     
                                                                            </td>
                                                                            <td class="boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <div class="liItemDesc_setTextEllipsis"
                                                                                    ng-if="(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex) 
                                                                                        || (OptionFee.PartId && !OptionFee.IsNonInventoryPart) || (OptionFee.ProductType == 'Warranty Plan') 
                                                                                        || (OptionFee.ProductType == 'Financing Product') || (OptionFee.ProductType == 'Deal Product') 
                                                                                        || (F_CO.isOptionFeeCommitAndInstalled(OptionFee.OptionStatus) && ((OptionFee.PartId && !OptionFee.IsNonInventoryPart) || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')))">
                                                                                    <span class="bp-blue-font" ng-class="{'bp-blue-hover' : OptionFee.PartId}" 
                                                                                        id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_itemDesc"
                                                                                        ng-click="F_CO.moveToState('ViewPart',{Id:OptionFee.PartId},(OptionFee.PartId && !OptionFee.IsNonInventoryPart))">
                                                                                        {{::OptionFee.ItemCode}} - {{::OptionFee.ItemDescription}}
                                                                                    </span>
                                                                                </div>
                                                                                
                                                                                <div class="liItemDesc" ng-if="(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex) && (!OptionFee.PartId || (OptionFee.PartId && OptionFee.IsNonInventoryPart)) 
                                                                                    && (OptionFee.ProductType != 'Warranty Plan') && (OptionFee.ProductType != 'Financing Product') && (OptionFee.ProductType != 'Deal Product') 
                                                                                    && !(F_CO.isOptionFeeCommitAndInstalled(OptionFee.OptionStatus) && (!(OptionFee.PartId && OptionFee.IsNonInventoryPart) || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')))">
                                                                                    <span class="editableDescInput"  ng-class="{'focusInput': setBotrderOnSpan}">
                                                                                        <span class="itemCode">{{::OptionFee.ItemCode}} - </span>
                                                                                        <input id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_itemDesc"
                                                                                            class="bp-input-text text-center"
                                                                                            ng-focus="setBotrderOnSpan = true;"
                                                                                            type="text" ng-model="OptionFee.ItemDescription"
                                                                                            ng-blur="setBotrderOnSpan = false; F_CO.updateOFLineItem('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, $event)"
                                                                                            ng-keydown="F_CO.setFlagOnTabForBlurHandling($event)"
                                                                                            maxlength = "255"/>
                                                                                    </span>
                                                                                </div>
                                                                            </td>
                                                                          
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-bg-disabled-div': (M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' &&
                                                                                    !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex))}"><!-- 'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                                                                                                                                                                                && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex) -->
                                                                                <span ng-if="!OptionFee.IsDummyLineItem && ((OptionFee.LabourId != null && OptionFee.LabourId != '')  || (OptionFee.PartId != null && OptionFee.PartId != '') || (OptionFee.ProductId != null && OptionFee.ProductId != '' && OptionFee.ProductType == 'Sublet'))">
                                                                                   <label class="bp-switch optionFeeSwitch" id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_IsInstallFlag">
                                                                                      <input type="checkbox" ng-disabled="(OptionFee.LabourId != null && OptionFee.LabourId != '') || 
                                                                                            (OptionFee.ProductId != null && OptionFee.ProductId != '' && OptionFee.ProductType == 'Sublet') || !GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote()
                                                                                            || (OptionFee.PartId != null && OptionFee.PartId != '' && OptionFee.Status == 'Fulfilled')" 
                                                                                            ng-model="OptionFee.IsInstall" ng-click="F_CO.installOptionFeeAction(UnitIndex, kitHeaderIndex, optionFeeIndex)"/>
                                                                                      <div class="bp-slider round" ng-class = "{'disableCheckBox' :((M_CO.Deal.DealInfo.DealStatus == 'Invoiced' || 
                                                                                                                (OptionFee.LabourId != null && OptionFee.LabourId != '') || (OptionFee.ProductId != null && OptionFee.ProductId != '' 
                                                                                                                && OptionFee.ProductType == 'Sublet')) || !GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || 
                                                                                                                (OptionFee.PartId != null && OptionFee.PartId != '' && OptionFee.Status == 'Fulfilled'))}"></div>
                                                                                        </label>
                                                                               </span>
                                                                               <div ng-if="OptionFee.IsDummyLineItem && ((OptionFee.LabourId != null && OptionFee.LabourId != '')  || (OptionFee.PartId != null && OptionFee.PartId != '') || (OptionFee.ProductId != null && OptionFee.ProductId != '' && OptionFee.ProductType == 'Sublet'))" class="install-flag dummy-tag-name"></div>
                                                                            </td>
                                                                            <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span ng-if="(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex)
                                                                                    || (F_CO.isOptionFeeCommitAndInstalled(OptionFee.OptionStatus) && (OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')))">
                                                                                    {{::OptionFee.Qty}}
                                                                                </span>
                                                                                <span ng-if="(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex) 
                                                                                    && !(F_CO.isOptionFeeCommitAndInstalled(OptionFee.OptionStatus) && (OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')))">
                                                                                    <numbers-only id-value = "deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_Qty"
                                                                                        class-value = "bp-input-text inTimeEdit timeField text-center"
                                                                                        min-value = "{{F_CO.getMinAttributeValueBasedOnReturnFlag('Deal', null, null, (OptionFee.IsEnvFee || OptionFee.FeeId), OptionFee.PartId)}}"
                                                                                        default-value = "1"
                                                                                        input-model-value = "OptionFee.Qty" 
                                                                                        include-negative = "F_CO.allowReturn('Deal', null, null, (OptionFee.IsEnvFee || OptionFee.FeeId), OptionFee.PartId)"
                                                                                        include-zero = "false"
                                                                                        precision-length = "2"
                                                                                        force-precision-length = "false"
                                                                                        blur-value="F_CO.updateOFLineItem('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, $event)"
                                                                                        input-keydown-value="F_CO.setFlagOnTabForBlurHandling($event)"/>
                                                                                </span>
                                                                            </td>
                                                                            <td class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}'}" ng-if="dealKitHeader.isAsyncActionInProgress"><div class="dummy-tag-name"></div></td>
                                                                            <td class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}'}" ng-if="dealKitHeader.isAsyncActionInProgress"><div class="dummy-tag-name"></div></td>
                                                                            <td class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}'}" ng-if="dealKitHeader.isAsyncActionInProgress"><div class="dummy-tag-name"></div></td>
                                                                            <td ng-if="!dealKitHeader.isAsyncActionInProgress" class="text-center bp-bold-font" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <!-- <span ng-if="OptionFee.PartId" ng-class = "{'bp-green-font': OptionFee.Status == 'In Stock','bp-red-font': OptionFee.Status == 'Required' || OptionFee.Status == 'Oversold','bp-green-dark-font': OptionFee.Status == 'Invoiced','bp-orange-font': OptionFee.Status == 'Ordered'}">{{::OptionFee.Status}}</span> -->
                                                                                <span ng-if="OptionFee.PartId">
                                                                                    <bp-ng-badge value="{{OptionFee.Status}}"  class-value="{{OptionFee.Status  | lowercase}}-badge {{((OptionFee.Status  | lowercase) == 'return') ? 'bp-first-letter-capitalize' : ''}}" />   
                                                                                    <!-- {{::optionFee.Status}}  ng-class = "{'bp-green-font': optionFee.Status == 'In Stock','bp-red-font': optionFee.Status == 'Required' || optionFee.Status == 'Oversold','bp-green-dark-font': optionFee.Status == 'Invoiced','bp-orange-font': optionFee.Status == 'Ordered'}" --></span>
                                                                                   <span ng-if = "OptionFee.OptionStatus == 'Committed'">
                                                                                    <bp-ng-badge value="{{OptionFee.OptionStatus}}"  class-value="{{OptionFee.OptionStatus  | lowercase}}-badge" />  
                                                                                   </span>
                                                                            </td>
                                                                            <td ng-if="!dealKitHeader.isAsyncActionInProgress" class="text-center price-edit" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span ng-if = "(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex
                                                                                                    || !GroupOnlyPermissions['Override price'].enabled)">{{::OptionFee.Price | currency}}</span>
                                                                                <span ng-if = "(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex
                                                                                                && GroupOnlyPermissions['Override price'].enabled)">
                                                                                    <numbers-only id-value = "deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_Price"
                                                                                        class-value = "bp-input-text inTimeEdit timeField text-center"
                                                                                        input-model-value = "OptionFee.Price" 
                                                                                        include-negative = "false"
                                                                                        include-zero = "true"
                                                                                        precision-length = "2"
                                                                                        blur-value = "F_CO.updateOFLineItem('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, $event)"
                                                                                        input-keydown-value="F_CO.setFlagOnTabForBlurHandling($event)"/>
                                                                                </span>

                                                                                <span class="price-variance-warning" ng-if="(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex || !GroupOnlyPermissions['Override price'].enabled) && OptionFee.Status == 'Required' && M_CO.IsForeignExchangeCostingEnabled && OptionFee.IsForeignVendor">
                                                                                    <span data-toggle="tooltip" data-original-title="{{'Special_ordering_a_foreign_part_click_to_learn_more' | translate}}" data-html="true">
                                                                                        <i ng-click="F_CO.openPriceVarianceWarningModal($event)" class="bp-icons bp-tart-orange-font bp-font-14">warningFilled</i>
                                                                                    </span>
                                                                                </span>
                                                                                <span ng-if="(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex && GroupOnlyPermissions['Override price'].enabled && OptionFee.Status == 'Required' && M_CO.IsForeignExchangeCostingEnabled && OptionFee.IsForeignVendor)">
                                                                                    <span class="warning-icon" data-toggle="tooltip" data-original-title="{{'Special_ordering_a_foreign_part_click_to_learn_more' | translate}}" data-html="true">
                                                                                        <i ng-click="F_CO.openPriceVarianceWarningModal($event)" class="bp-icons bp-tart-orange-font bp-font-14">warningFilled</i>
                                                                                    </span>
                                                                                </span>
                                                                            </td>
                                                                            <td ng-if="!dealKitHeader.isAsyncActionInProgress" class="text-center boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex), 'bp-red-font': OptionFee.Total < 0}">
                                                                                <span>{{(OptionFee.Total) | currency}}</span>
                                                                            </td>
                                                                            <td ng-if="OptionFee.IsDummyLineItem" class="text-center" ng-class="{'setBgColor' :  M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}'}"><div class="dummy-tag-name"></div></td>
                                                                            <td ng-if="!OptionFee.IsDummyLineItem" class="partInvIconAdjustment" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)
                                                                                    && (!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || !F_CO.isDealActionEnable() 
                                                                                            || ((dealKitHeader.Id || OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')) 
                                                                                            && (M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None'))),
                                                                                'bp-bg-disabled-div': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)
                                                                                    && ((GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable() 
                                                                                            && ((!dealKitHeader.Id && !OptionFee.PartId && !OptionFee.LabourId && (!OptionFee.ProductId || OptionFee.ProductType !== 'Sublet')) 
                                                                                            || (M_CO.Deal.OptionStatus === 'Required' || M_CO.Deal.OptionStatus === 'None'))))}">
                                                                                   <div ng-if="M_CO.Deal.DealInfo.DealStatus != 'Invoiced'">
                                                                                       <span data-toggle="tooltip" title="Delete" tooltip-loader = "tooltip-loader" ng-if = "(GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable() && 
                                                                                       ((!dealKitHeader.Id && !OptionFee.PartId && !OptionFee.LabourId && (!OptionFee.ProductId || OptionFee.ProductType !== 'Sublet')) || 
                                                                                       ((M_CO.Deal.OptionStatus === 'Required' || M_CO.Deal.OptionStatus === 'None') && !F_CO.isOptionFeeCommitAndInstalled(OptionFee.OptionStatus))))" id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_deleteBtn">
                                                                                            <i class="bp-icons bp-blue-font bp-font-18 LIDeleteBtn" ng-click="F_CO.openDeleteConfirmationPopupForOptionFeeLineItem(UnitIndex, kitHeaderIndex, optionFeeIndex, M_CO.Deal.UnitList[UnitIndex].DealItemObj.Id, dealKitHeader.Id, OptionFee.Id, 'deal');">delete</i>
                                                                                        </span>
                                                                                         <span ng-if = "!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || !F_CO.isDealActionEnable() || 
                                                                                         ((dealKitHeader.Id || OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')) && 
                                                                                         ((M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None') || F_CO.isOptionFeeCommitAndInstalled(OptionFee.OptionStatus)))">
                                                                                             <i class="bp-icons bp-font-12 bp-grey-font pull-left lockSvg">lock</i>
                                                                                        </span>
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                        <tr ng-repeat-end="ng-repeat-end" ng-if="!dealKitHeader.Id && M_CO.supersededParts[OptionFee.PartId] != null && M_CO.Deal.DealInfo.DealStatus != 'Invoiced'">
                                                                            <td></td>
                                                                            <td colspan="8">
                                                                                <div class="show_Availableline text-uppercase bgYellow"><span class="logo-icon">i</span>{{ 'part_has_been_superseded_to' | translate }} : {{M_CO.supersededParts[OptionFee.PartId].partNumber}}</div>
                                                                             </td>
                                                                             <td></td>
                                                                        </tr>
                                                                        <!-- End: Line Items Row without Kit Header -->
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            
                                                            <div class="search-entity-wrapper" ng-if="F_CO.showAutoComplete()"
                                                                ng-class="{'pull-left autocomplete-wrapper-left': !F_CO.isCommitAndInstallActionDone()}">
                                                                <p class="search-entity-text">{{ 'Scan_and_search_to_add_items' | translate }}</p>
                                                                <autocompletev2 ng-if="!M_CO.IsWebComponentSTAEnabled" id="autocompletev2DealId"
                                                                    is-scaning-enabled="true"
                                                                    template-name="Entity"
                                                                    section-name="{{M_CO.Deal.DealUnresolvedFulfillmentList && M_CO.Deal.DealUnresolvedFulfillmentList.length > 0 ? 'Committed Deal' : 'Deal'}}"
                                                                    unit-index="{{UnitIndex}}"
                                                                    section-id="DealUnit{{UnitIndex}}"
                                                                    is-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || !F_CO.isDealActionEnable()" />
                                                                <div class="searchToAdd" ng-if="M_CO.IsWebComponentSTAEnabled">
                                                                    <bpda-search-to-add id="autocompleteDealUnit{{UnitIndex}}"
                                                                        is-scanning-enabled="true"
                                                                        template-name="Entity"
                                                                        section-name="{{M_CO.Deal.DealUnresolvedFulfillmentList && M_CO.Deal.DealUnresolvedFulfillmentList.length > 0 ? 'Committed Deal' : 'Deal'}}"
                                                                        unit-index="{{UnitIndex}}"
                                                                        section-id="DealUnit{{UnitIndex}}"
                                                                        ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || !F_CO.isDealActionEnable()"
                                                                        ng-attr-available-filters= "{{F_CO.populateSTAFilters('staDealUnit')}}"
                                                                        ng-attr-selected-filters="{{F_CO.populateSelectedSTAFilters('autocompleteDealUnit', UnitIndex)}}"
                                                                    ></bpda-search-to-add>
                                                                </div>
                                                                <div class="bp-alert-info">
                                                                    <bp-alert id="option-fee-bp-alert{{UnitIndex}}" duration="3000" color="info" closable="true">
                                                                        <bp-icon slot="icon" color="inherit">info</bp-icon>
                                                                        You don't have to wait while we add your line item. You can immediately add a new one now!
                                                                    </bp-alert>
                                                                </div>
                                                            </div>
                                                            <div class="autocomplete-wrapper-right pull-left"
                                                                ng-if="F_CO.showAutoComplete() && !F_CO.isCommitAndInstallActionDone() &&  GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable()">
                                                                <i class="bp-icons bp-blue-font bp-font-14 bp-cursor-pointer pull-left MT-3" ng-click="F_CO.ShowPartsImportModel('Deal',M_CO.Deal.UnitList[UnitIndex].DealItemObj.Id)">partSmart</i>
                                                                <a class="bp-blue-font bp-bold-font bp-font-14 pull-left line-height-small" ng-click="F_CO.ShowPartsImportModel('Deal',M_CO.Deal.UnitList[UnitIndex].DealItemObj.Id)">
                                                                    {{ 'Add_items_from_a_pick_list' | translate }}
                                                                         </a> 
                                                                   </div> 
                                                        </div> 
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Start: inner Accordian level 2 -->
                                            <!-- Start: Deal Unit Items accordian start here -->
                                        </div>
                                    </div>
                                </div>
                                <!-- End: Deal Unit accordian end here -->
                                <!-- End: inner Accordian level 1 --> 
                                
                                <!-- Added for trade in -->
                                <!-- Start: Deal Trade In section -->
                                <div class="bp-inner-accordian open bp-inner-accordian-deal tradeIn"  ng-class="{'bp-inner-accordian-opened': M_CO.expandedInnerSectionName == 'Deal_TradeIn{{$index}}', 'bp-inner-accordian-opened-deal': M_CO.expandedInnerSectionName == 'Deal_TradeIn{{$index}}'}"
                                    ng-repeat = "tradeItem in  M_CO.Deal.TradeInsList track by $index" ng-init="tradeIn_Index=$index">
                                     <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInnerSection('Deal_TradeInSectionId'+$index, 'Deal_TradeIn'+$index)">
                                        <div class="inner-accordian-header-left">
                                            <h2 class="accordian-left-details">{{ 'Trade_in' | translate }} {{$index + 1}}  
                                            </h2>
                                        </div>
                                        <div class="accordian-right-details">
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_TradeIn'+$index">
                                                <i class="bp-icons bp-blue-font bp-font-14 bp-text-transform stroke-1 size-unset">arrowDown</i>
                                            </a>
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName == 'Deal_TradeIn'+$index">
                                                <i class="bp-icons bp-blue-font bp-font-14 bp-text-transform stroke-1 size-unset">arrowUp</i>
                                            </a>
                                             <div class="accordian-right-details-text"
                                                ng-if="GroupOnlyPermissions['Deal']['create/modify'] &&
                                                    M_CO.expandedInnerSectionName == 'Deal_TradeIn'+$index &&
                                                    F_CO.isDealActionEnable() && !tradeItem.IsSctockedIn">
                                                <p class="right-text required">
                                                    <!-- <a class="bp-blue-font bp-font-14" ng-click="F_CO.TradeIn.removeTradeItem(tradeIn_Index)">Remove trade-in</a> -->
                                                    <a data-toggle="modal" data-target="#TradeInConfirmationPopup" class="bp-font-14 bp-blue-font bp-cursor-pointer" ng-click="F_CO.openTradeInConfirmationPopup(tradeIn_Index)"
                                                        >{{ 'Text_Remove_TradeIn_From_Deal' | translate }}</a> 
                                                    <span class="icon-container" data-toggle="modal" data-target="#TradeInConfirmationPopup" ng-click="F_CO.openTradeInConfirmationPopup(tradeIn_Index)">
                                                        <i class="bp-icons bp-blue-font bp-font-19">delete</i>
                                                    </span>
                                                </p>
                                           </div> 
                                           <div class="accordian-right-details-text" ng-if="M_CO.expandedInnerSectionName != 'Deal_TradeIn'+$index">
                                                <p class="bp-dark-grey1-font right-text required">
                                                    <span class="bp-dark-grey1-font bp-font-16">{{ 'Label_Total' | translate }}: ({{tradeItem.AgreedValue | currency}})</span> 
                                                </p>
                                           </div> 
                                        </div>
                                    </div>
                                    
                                    <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition"  
                                        id="Deal_TradeInSectionId{{$index}}"
                                        ng-if="M_CO.Deal.TradeInsList.length > 0 "
                                        ng-class="{'bp-expand-div-transition': M_CO.expandedInnerSectionName == 'Deal_TradeIn{{tradeIn_Index}}'}">
                                       <div class="expandableContainer P0">
                                            <div class="lr-pad-52" ng-If ="M_CO.Deal.TradeInsList[tradeIn_Index].UnitId != null">
                                                <div class="col-sm-6 left-container">
                                                <p class="cou-card-font bp-font-16 bp-bold-font modified-p-margin-bottom bp-font-16">{{ 'Customer_owned_unit_to_trade' | translate }}</p>
                                                    <div class="showing-customer" >
                                                        <entity-card add-new-entity-action = "" entity-card-payload = "M_CO.unitIdToUnitImagesJsonMap[tradeItem.UnitId].unitCardInfoPayload" first-img-action = "" first-button-action = "F_CO.moveToState('ViewUnit', {Id : tradeItem.UnitId}, true)" second-button-action = "F_CO.TradeIn.replaceTradeInUnit(tradeIn_Index)" third-btn-action="F_CO.TradeIn.openStockInCOUConfirmationPopup(tradeIn_Index, $event)" active-order-action = "" third-img-action = "F_CO.editNotes(tradeItem.UnitId,tradeItem.Notes,tradeItem.VIN,'Tradin',tradeIn_Index)" third-button-action ="F_CO.editNotes(tradeItem.UnitId,tradeItem.Notes,tradeItem.VIN,'Tradin',tradeIn_Index)"></entity-card>
                                                        <div class = "col-xs-6 deal-item-mileage">
                                                            <label class = "col-xs-12">{{ 'Label_Mileage' | translate }}</label>
                                                            <numbers-only 
                                                                class-value="bp-input-text"
                                                                place-holder-value="{{ 'Placeholder_mileage' | translate }}"
                                                                max-length="6"
                                                                precision-length = "1"
                                                                force-precision-length = "false"
                                                                blur-value="F_CO.Deal.saveDealItemInfo($index, 'Trade-in')"
                                                                input-model-value="tradeItem.Mileage" 
                                                                disabled-value="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'" />
                                                        </div>
                                                        <div class="col-xs-6 deal-item-mileage-type">
                                                            <label class = "col-xs-12">{{ 'Label_Type' | translate }}</label>
                                                            <span class = "bp-autocomplete-image-icon">
                                                                <i class="bp-icons bp-blue-font bp-font-14 stroke-5 size-unset" ng-click = "F_CO.setFocusOnInput('MileageTypeTradeInUnit' + tradeIn_Index)">arrowDown</i>
                                                            </span>
                                                            <div class="bp-cell searchInputArea">
                                                                <input  type="text" id="MileageTypeTradeInUnit{{tradeIn_Index}}" class="bp-input-text" placeholder="{{ 'Mileage_type' | translate }}"
                                                                    autocomplete="off" ng-focus="F_CO.Deal.getMileageTypes(tradeIn_Index, 'Trade-in')" ng-blur="F_CO.Deal.hideMileageTypes(tradeIn_Index, 'Trade-in')"
                                                                    ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                    ng-model="tradeItem.MileageType" />
                                                                <div class="bp-autocomplete-dropdown-wrapper" id="MileageTypeTradeInScrollDiv{{tradeIn_Index}}" 
                                                                    ng-if="tradeItem.showMileageTypes">
                                                                    <ul>
                                                                        <li ng-repeat="type in M_CO.MileageTypeList" ng-mousedown="F_CO.Deal.selectMileageType(type, tradeIn_Index, 'Trade-in')">
                                                                            <div class="fullName">{{type}}</div>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="deal-tax-details" ng-if="tradeItem.UnitId != null">
                                                            <div class="row M0">
                                                                           <label class="col-xs-12 M0 MB5">{{'Category_Object_Display_Label' | translate}}</label>
                                                                           <div class="col-xs-12 P0">
                                                                             <div class="account-type-container col-xs-12 P0">
                                                                                 <div class = "bp-autocomplete-Wrapper autocomplete_v2">
                                                                                     <span class = "bp-autocomplete-image-icon">
                                                                                        <i class="bp-icons bp-blue-font bp-font-14 stroke-5 size-unset" ng-click = "F_CO.setFocusOnInput('tradeInCategoryId')">arrowDown</i>
                                                                                     </span>
                                                                                     <input  type="text" id="tradeInCategoryId" class="bp-autocomplete-input bp-cursor-pointer bp-input-text  manage-long-salesperson-person" placeholder="{{'Please_select' | translate }}"
                                                                                         autocomplete="off" ng-keyup="F_CO.keyPressNavigationOnDropdownElements($event, 'tradeInCategoryRecDropdownDiv', 'tradeInCategoryRec', M_CO.applicableSalesTaxList)"
                                                                                         ng-model="tradeItem.CategoryName" ng-disabled="M_CO.disableDealItemEdit() ||  tradeItem.IsSctockedIn"
                                                                                         ng-focus = "M_CO.showCategoryListDropdown = true;  F_CO.setDealApplicableTaxDefaultDataOnFocus(tradeItem.Id, tradeIn_Index, 'tradeIn', tradeItem.Taxable);"
                                                                                         ng-blur="M_CO.showCategoryListDropdown = false; F_CO.hideDropdown();" readonly="readonly" 
                                                                                        />
                                                                                     <div class = "bp-autocomplete-dropdown-wrapper" ng-if="M_CO.showCategoryListDropdown" id="tradeInCategoryRecDropdownDiv">
                                                                                         <ul>
                                                                                             <li ng-repeat="tradCatRec in M_CO.tradeInCategory track by $index" id="tradeInCategoryRec_{{$index}}"
                                                                                                 ng-class="{'selected-row': $index == M_CO.currentDropDownIndex}"
                                                                                                 ng-mousedown="F_CO.selcectDealItemCategory(tradCatRec)">
                                                                                                 <div class="form-group-info col-xs-12 P0">
                                                                                                     <span >{{tradCatRec.Name}}</span>
                                                                                                 </div>
                                                                                             </li> 
                                                                                         </ul>
                                                                                          <ul ng-If="M_CO.tradeInCategory.length == 0">
                                                                                             <li id="unitSalesTaxNoResults" class="BP_angucomplete-row-NoResults-Msg">
                                                                                                 <div class="">{{'No_Results_Found' | translate}}</div>
                                                                                             </li>
                                                                                         </ul>
                                                                                     </div>
                                                                                 </div>
                                                                              </div>
                                                                         </div>
                                                                    </div>
                                                            
                                                                    <div class="row M0 customer-address-tax" ng-if="M_CO.IsAutomaticTaxRates && M_CO.coHeaderRec.CustomerId != undefined && M_CO.coHeaderRec.COType != 'Cash Sale'">
                                                                        <div class="col-xs-3 P0">
                                                                            <div class="col-lg-12 col-xs-12 values bp-dark-grey1-font MT15">
                                                                                <label class="bp-switch"> 
                                                                                    <input ng-model="M_CO.Deal.DealInfo.IsTaxBasedOnCustomerAddress" type="checkbox" ng-disabled="(!GroupOnlyPermissions['Sales Taxes']['assign']) || M_CO.disableDealItemEdit()"
                                                                                    ng-change="F_CO.toggleTaxBasedOnCustomerAddress('tradeInSection', tradeIn_Index)"/>
                                                                                    <div class="bp-slider round"></div>
                                                                                </label>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-xs-9 P0 MT6">
                                                                            <p class="bp-lh-19 bp-font-16 modified-p-margin-bottom MT15">Tax based on the customer address</p>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row M0 customer-address-tax">
                                                                        <div class="bp-alert-info">
                                                                            <bp-alert id="tradeInSection{{tradeIn_Index}}" duration="5000" color="info" closable="true">
                                                                                <bp-icon slot="icon" color="inherit">info</bp-icon>
                                                                                The selected customer tax control will apply to the entire deal.
                                                                            </bp-alert>
                                                                        </div>
                                                                    </div>

                                                            <div class="row M0 mt-medium" ng-class="{'MT15': M_CO.IsAutomaticTaxRates && M_CO.coHeaderRec.CustomerId != undefined && M_CO.coHeaderRec.COType != 'Cash Sale'}">
	                                                                <div class="col-xs-3 P0">
	                                                                	<div class="col-lg-12 col-xs-12 lables bp-bold-font bp-dark-grey1-font P0 bp-font-16">{{'ViewLabour_Taxable' | translate}}</div>
	                                                                    <div class="col-lg-12 col-xs-12 values bp-dark-grey1-font MT18">
	                                                                        <label class="bp-switch"> 
	                                                                            <input ng-model="tradeItem.Taxable" type="checkbox" ng-disabled="(!GroupOnlyPermissions['Sales Taxes']['assign']) || M_CO.disableDealItemEdit()"
	                                                                                ng-change="F_CO.saveDealItemTaxInfo(tradeItem.Taxable, tradeItem.ApplicableTaxId, tradeItem.Id, tradeIn_Index, 'tradeIn')"/>
	                                                                            <div class="bp-slider round"></div>
	                                                                        </label>
	                                                                    </div>
	                                                                </div>
	                                                                <div class = "col-xs-9 P0" ng-if="tradeItem.Taxable">
	                                                                	<p class="bp-lh-19 bp-font-16 modified-p-margin-bottom">{{'Applicable_tax_Label' | translate}}</p>
	                                                                	 <div class="col-lg-12 P0">
                                                                         <div class="account-type-container">
                                                                             <div class = "bp-autocomplete-Wrapper autocomplete_v2">
                                                                                 <span class = "bp-autocomplete-image-icon">
                                                                                    <i class="bp-icons bp-blue-font bp-font-14 stroke-5 size-unset" ng-click = "M_CO.Deal.PrevApplicableTaxName=tradeItem.ApplicableTaxName; 
                                                                                        F_CO.setFocusOnInput('tradeInSalesTaxRecInput_'+$index)">arrowDown</i>
                                                                                 </span>
                                                                                 <input  type="text" id="tradeInSalesTaxRecInput_{{$index}}" class="bp-autocomplete-input bp-cursor-pointer bp-input-text  manage-long-salesperson-person" placeholder="{{'Please_select' | translate }}"
                                                                                     autocomplete="off" ng-keyup="F_CO.keyPressNavigationOnDropdownElements($event, 'tradeInSalesTaxRecDropdownDiv', 'tradeInSalesTaxRec', M_CO.applicableSalesTaxList, tradeItem.ApplicableTaxName, ('tradeInSalesTaxRecInput_' + $index))"
                                                                                     ng-model="tradeItem.ApplicableTaxName" 
                                                                                     ng-focus = "M_CO.showSalesTaxListDropdown = true; F_CO.setDealApplicableTaxDefaultDataOnFocus(tradeItem.Id, tradeIn_Index, 'tradeIn', tradeItem.Taxable);"
                                                                                     ng-blur="F_CO.setApplicableTaxPrevValue(); M_CO.showSalesTaxListDropdown = false; F_CO.hideDropdown();" 
                                                                                     ng-disabled="(!GroupOnlyPermissions['Sales Taxes']['assign']) || M_CO.disableDealItemEdit()"/>
                                                                                 <div class = "bp-autocomplete-dropdown-wrapper" ng-if="M_CO.showSalesTaxListDropdown" id="tradeInSalesTaxRecDropdownDiv">
                                                                                     <ul>
                                                                                         <li ng-repeat="salesTax in M_CO.filteredApplicableSalesTaxList track by $index" id="tradeInSalesTaxRec_{{$index}}"
                                                                                             ng-class="{'selected-row': $index == M_CO.currentDropDownIndex}"
                                                                                             ng-mousedown="F_CO.selcectDealItemSalesTax(salesTax)">
                                                                                             <div class="form-group-info col-xs-12 P0">
                                                                                                 <span >{{salesTax.Name}}</span>
                                                                                             </div>
                                                                                         </li> 
                                                                                     </ul>
                                                                                      <ul ng-If="M_CO.filteredApplicableSalesTaxList.length == 0">
                                                                                         <li id="unitSalesTaxNoResults" class="BP_angucomplete-row-NoResults-Msg">
                                                                                             <div class="">{{'No_Results_Found' | translate}}</div>
                                                                                         </li>
                                                                                     </ul>
                                                                                 </div>
                                                                             </div>
                                                                          </div>
                                                                     </div>
	                                                                </div>
                                                             </div>

                                                          </div>
                                                    </div>
                                                    <div class="dollar-svg mt-medium">
                                                        <p class="bp-lh-19 bp-font-16 modified-p-margin-bottom">{{ 'Agreed_value' | translate }}</p>
                                                        <span class="dollar bp-grey-font">{{ 'Currency_Symbol' | translate }}</span>
                                                        <numbers-only id-value = "AgreedValueForCOU"
                                                                 class-value="bp-input-text padding-from-icon"
                                                                 input-model-value = "tradeItem.AgreedValue" 
                                                                 place-holder-value ="$"
                                                                 precision-length = "2"
                                                                 disabled-value = "M_CO.disableDealItemEdit()"
                                                                 blur-value = "F_CO.TradeIn.setAgreedValue(tradeItem.AgreedValue,tradeIn_Index);F_CO.hideTooltip('AgreedValueForCOUTooltip'+tradeIn_Index)"
                                                                 input-keyup-value="F_CO.TradeIn.changeField(tradeItem.AgreedValue, oldValue)"
                                                                 focus-value="F_CO.TradeIn.copyCurrentAgreedValue(tradeIn_Index);F_CO.showTooltip('AgreedValueForCOUTooltip'+tradeIn_Index)" />
                                                                <span class="HelperText BlueTooltip" id="AgreedValueForCOUTooltip{{tradeIn_Index}}">
                                                                    <i aria-hidden="true" class="fa fa-info-circle" 
                                                                    data-customtoggle="tooltip" title="The amount of credit the customer will get on the deal for the trade-in."></i>
                                                                </span> 
                                                   </div>
                                                   <div class="dollar-svg mt-medium" ng-if="GroupOnlyPermissions['Costs'].modify">
                                                        <p class="bp-lh-19 bp-font-16 modified-p-margin-bottom">{{ (!M_CO.coHeaderRec.IsTaxIncludedPricing ? 'Label_actual_cash_value' : 'Label_actual_cash_value_excluding_tax') | translate }}</p>
                                                        <span class="dollar bp-grey-font">{{ 'Currency_Symbol' | translate }}</span>
                                                        <numbers-only id-value = "ActualCashValueForCOU"
                                                                 class-value="bp-input-text padding-from-icon"
                                                                 input-model-value = "tradeItem.ActualCashValue" 
                                                                 place-holder-value ="$"
                                                                 precision-length = "2"
                                                                 focus-value="F_CO.showTooltip('ActualCashValueForCOUTooltip'+tradeIn_Index)"
                                                                 disabled-value = "M_CO.disableDealItemEdit() || tradeItem.IsSctockedIn || M_CO.Deal.DealInfo.isDealSectionTradeOnly"
                                                                 blur-value = "F_CO.TradeIn.setActualCashValue(tradeItem.ActualCashValue, tradeIn_Index);F_CO.hideTooltip('ActualCashValueForCOUTooltip'+tradeIn_Index)" />
                                                                 <span class="HelperText BlueTooltip" id="ActualCashValueForCOUTooltip{{tradeIn_Index}}">
                                                                    <i aria-hidden="true" class="fa fa-info-circle" 
                                                                    data-customtoggle="tooltip" title="The resulting inventory cost when stocked in. For tax included pricing this is net of taxes."></i>
                                                                </span> 
                                                   
                                                   </div>
                                                   
                                                   <div class="dollar-svg mt-medium">
                                                        <p class="bp-lh-19 bp-font-16 modified-p-margin-bottom">{{ 'Lien_payout' | translate }}</p>
                                                        <span class="dollar bp-grey-font">{{ 'Currency_Symbol' | translate }}</span>
                                                        <numbers-only id-value = "tradeInLienPayout"
                                                                 class-value="bp-input-text padding-from-icon"
                                                                 min-value = "0"
                                                                 include-zero = "true"
                                                                 include-negative = "false"
                                                                 place-holder-value ="$"
                                                                 precision-length = "2"
                                                                 input-model-value = "tradeItem.LienPayout" 
                                                                 disabled-value = "M_CO.disableDealItemEdit() || (M_CO.Deal.DealFinanceObj.Status === 'Approved')"
                                                                 blur-value = "F_CO.TradeIn.saveLienPayout(tradeItem.LienPayout,tradeIn_Index)"/>
                                                   </div>
                                                    
                                                   <div class="row M0" ng-if="tradeItem.LienPayout > 0">
                                                        <label class="col-xs-12">{{'Finance_company' | translate}}</label>
                                                        <div class="col-xs-12 P0"> 
                                                            <div class="account-type-container">
                                                                <div class = "bp-autocomplete-Wrapper autocomplete_v2">
                                                                    <span class = "bp-autocomplete-image-icon">
                                                                        <i class="bp-icons bp-blue-font bp-font-14 stroke-5 size-unset" ng-click = "F_CO.setFocusOnInput('tradeInFinanceCompany')">arrowDown</i>
                                                                 </span>
                                                                 <input  type="text" id="tradeInFinanceCompany" class="bp-autocomplete-input bp-cursor-pointer 
                                                                    bp-input-text  manage-long-salesperson-person" placeholder="{{'Please_select' | translate }}"
                                                                    autocomplete="off" ng-keyup="F_CO.keyPressNavigationOnDropdownElements($event, 'tradeInFinanceCompanyDropdownDiv', 'tradeInFinanceCompany', M_CO.DealFinance.FinanceCompanyList)"
                                                                     ng-model="tradeItem.FinanceCompanyName" ng-focus = "M_CO.showFinanceCompanyDropdown = true;"
                                                                     ng-blur="M_CO.showFinanceCompanyDropdown = false; F_CO.hideDropdown();"  
                                                                     ng-class="{'bp-redborder': !tradeItem.FinanceCompanyName}"
                                                                     ng-disabled="M_CO.disableDealItemEdit() || (M_CO.Deal.DealFinanceObj.Status === 'Approved')" readonly="readonly" />                       
                                                                 <div class = "bp-autocomplete-dropdown-wrapper" ng-if="M_CO.showFinanceCompanyDropdown" id="tradeInFinanceCompanyDropdownDiv">
                                                                     <ul>
                                                                         <li ng-repeat="financeCompany in M_CO.DealFinance.FinanceCompanyList track by $index" id="tradeInFinanceCompany_{{$index}}"
                                                                            ng-class="{'selected-row': $index == M_CO.currentDropDownIndex}"
                                                                            ng-mousedown="F_CO.selectDealItemFinanceCompany(financeCompany, 'tradeIn', tradeIn_Index)">
                                                                             <div class="form-group-info col-xs-12 P0">
                                                                                 <span >{{financeCompany.Name}}</span>
                                                                             </div>
                                                                         </li> 
                                                                     </ul>
                                                                      <ul ng-If="M_CO.DealFinance.FinanceCompanyList.length == 0">
                                                                         <li id="tradeInFinanceCompanyNoResults" class="BP_angucomplete-row-NoResults-Msg">
                                                                             <div class="">{{'No_Results_Found' | translate}}</div>
                                                                         </li>
                                                                     </ul>
                                                                 </div>
                                                              </div>
                                                          </div>
                                                    </div>
                                                </div>
                                                </div>
                                                
                                                <div class="col-sm-6 right-container">
                                                    <div class="form-input">
                                                         <p class="print-item-label cou-card-font bp-font-16 bp-bold-font modified-p-margin-bottom bp-font-16">{{ 'Appraisal_method' | translate }}</p>
                                                        <div class="bp-cell  searchInputArea " ng-class = "{'showingOverlay' : M_CO.TradeIn.showAppraisalMethodList }">
                                                            <input  type="text" id="AppraisalMethod" class="bp-input-text searchInput" placeholder="Please select"
                                                                autocomplete="off" ng-focus = "F_CO.TradeIn.getAppraisalMethodList()" ng-blur = "F_CO.TradeIn.hideAppraisalMethodList()"
                                                                ng-model="tradeItem.AppraisalMethod" readonly="readonly"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-keyup="M_CO.TradeIn.keyBoardavigation($event, M_CO.TradeIn.AppraisalMethodList, 'appraisalMethod',tradeIn_Index)"
                                                                />
                                                            <i class="bp-icons bp-blue-font bp-font-14 stroke-5 size-unset" ng-click = "F_CO.setFocusOnInput('AppraisalMethod')">arrowDown</i>
                                                            <div class="searchResultOverlay" id="appraisalMethodDropDownDiv">
                                                                <ul>
                                                                    <li ng-repeat="method in M_CO.TradeIn.AppraisalMethodList "
                                                                        ng-mousedown="F_CO.TradeIn.setAppraisalMethod($index,tradeIn_Index)"
                                                                        ng-class="{'selected-row': $index == M_CO.TradeIn.appraisalMethodCurrentIndex}"
                                                                        id="appraisalMethod{{$index}}">
                                                                        <div class="fullName text-capitalize">{{method}}  </div>
                                                                    </li>  
                                                                </ul> 
                                                            </div>  
                                                        </div>
                                                    </div>
                                                
                                                    <div class="form-input">
                                                        <label class="print-item-label">{{ 'Appraisal_status' | translate }}</label>
                                                        <div class="bp-cell  searchInputArea " ng-class = "{'showingOverlay' : M_CO.TradeIn.showAppraisalStatusList }">
                                                            <input  type="text" id="AppraisalStatus" class="bp-input-text searchInput bp-red-font" placeholder="Please select"
                                                                autocomplete="off" ng-focus = "F_CO.TradeIn.getAppraisalStatusList()" ng-blur = "F_CO.TradeIn.hideAppraisalStatusList()"
                                                                ng-model="tradeItem.AppraisalStatus" readonly="readonly"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-class=" {'bp-red-font' : tradeItem.AppraisalStatus=='Pending Appraisal' , 'bp-green-font' : tradeItem.AppraisalStatus=='Appraisal Complete' }"
                                                                ng-keyup="M_CO.TradeIn.keyBoardavigation($event, M_CO.TradeIn.AppraisalStatusList, 'appraisalStatus',tradeIn_Index)"
                                                                />
                                                            <i class="bp-icons bp-blue-font bp-font-14 stroke-5 size-unset" ng-click = "F_CO.setFocusOnInput('AppraisalStatus')">arrowDown</i>
                                                            <div class="searchResultOverlay" id="appraisalStatusDropDownDiv">
                                                                <ul>
                                                                    <li ng-repeat="status in M_CO.TradeIn.AppraisalStatusList"
                                                                        ng-mousedown="F_CO.TradeIn.setAppraisalStatus($index,tradeIn_Index)"
                                                                        ng-class="{'selected-row': $index == M_CO.TradeIn.appraisalStatusCurrentIndex}"
                                                                        id="appraisalStatus{{$index}}">
                                                                        <div class="fullName text-capitalize">{{status}}</div>
                                                                    </li>  
                                                                </ul> 
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="form-input">
                                                        <label class="print-item-label">{{ 'Appraisal_notes' | translate }}</label>
                                                        <div class="bp-cell  searchInputArea " >
                                                            <textArea  type="text" id="AppraisalNote" class="bp-input-text send-message-text-area" placeholder="Notes about the unit"
                                                                maxlength="255"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-model="tradeItem.AppraisalNotes" 
                                                                ng-blur="F_CO.TradeIn.setAppraisalNotes(tradeItem.AppraisalNotes,tradeIn_Index)"
                                                                />
                                                        </div>
                                                    </div>
                                                
                                                    <div class="form-input">
                                                        <label class="print-item-label">{{ 'Approved_by' | translate }}</label> 
                                                        <div class="bp-cell  searchInputArea " ng-class = "{'showingOverlay' : M_CO.TradeIn.showApprovedList }">
                                                            <input  type="text" id="ApprovedBy" class="bp-input-text searchInput" placeholder="Please select"
                                                                autocomplete="off" ng-focus = "F_CO.TradeIn.getApprovedList()" ng-blur = "F_CO.TradeIn.hideApprovedList()"
                                                                ng-model="tradeItem.ApprovedByName" readonly="readonly"
                                                                ng-class=" {'bp-red-font' : tradeItem.ApprovedBy=='Pending Approval' }"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-keyup="F_AddEditUnit.keyBoardavigation($event, M_CO.TradeIn.ApprovedList, 'approvedBy',tradeIn_Index)"
                                                                 />
                                                            <i class="bp-icons bp-blue-font bp-font-14 stroke-5 size-unset" ng-click = "F_CO.setFocusOnInput('ApprovedBy')">arrowDown</i>
                                                            <div class="searchResultOverlay" id="approvedByDropDownDiv">
                                                                <ul>
                                                                    <li ng-repeat="approved in M_CO.TradeIn.ApprovedList"
                                                                        ng-mousedown="F_CO.TradeIn.setApprovedBy($index,tradeIn_Index)"
                                                                        ng-class="{'selected-row': $index == M_CO.TradeIn.approvedByCurrentIndex}"
                                                                        id="approvedBy{{$index}}">
                                                                        <div class="fullName text-capitalize">{{approved.name}}</div>
                                                                    </li>  
                                                                </ul> 
                                                            </div>
                                                        </div>
                                                    </div>
                                                <div class="transfer-plate" ng-if="M_CO.Deal.UnitList.length">
                                                    <label class="print-item-label">{{ 'Plate/Registration transfer' | translate }}</label>
                                                    <div class="form-input">
                                                        <label class="print-item-label">{{ 'Plate/Reg#:' | translate }}</label>
                                                        <div class="bp-cell  searchInputArea " >
                                                            <input type="text" class="bp-input-text searchInput" placeholder="{{ 'Plate/Reg#:' | translate }}"
                                                                maxlength="255"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-model="tradeItem.REGO" 
                                                                ng-blur="F_CO.TradeIn.updateUnitDetails(tradeItem)"
                                                            />
                                                </div>
                                            </div>
                                                    <div class="form-input">
                                                        <label class="print-item-label">{{ 'Expiry Date:' | translate }}</label>
                                                        <div class="bp-cell  searchInputArea " >
                                                            <input type="text" class="date-picker bp-input-text searchInput" placeholder="{{ 'Expiry Date:' | translate }}" ng-model="tradeItem.RegExpiryDate"
                                                            date-format="M_CO.dateOptions.dateFormat" datepicker="datepicker" autocomplete="off"
                                                            ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                            ng-change="F_CO.TradeIn.updateUnitDetails(tradeItem)"
                                                            readonly="readonly" />
                                                        </div>
                                                    </div>
                                                    <div class="form-input">
                                                        <div class="col-xs-12 P0 MT20">
                                                            <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font P0 bp-font-16 MT20">{{'Transfer plate/reg to new unit?' | translate}}</div>
                                                            <div class="col-lg-4 col-xs-4 values bp-dark-grey1-font">
                                                                <label class="bp-switch"> 
                                                                    <input ng-model="tradeItem.TransferPlateRegToNewUnit" type="checkbox" ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'" ng-change="F_CO.TradeIn.updatePlateTransferToggle(tradeIn_Index, tradeItem)"/>
                                                                    <div class="bp-slider round"></div>
                                                                </label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="form-input" ng-if="tradeItem.TransferPlateRegToNewUnit">
                                                        <label class="print-item-label">{{ 'Transfer to' | translate }}</label>
                                                        <div class="bp-cell  searchInputArea" ng-class = "{'showingOverlay' : M_CO.TradeIn.showTransferToList}">
                                                            <input  type="text" id="TransferTo{{tradeIn_Index}}" class="bp-input-text searchInput" placeholder="{{'Please Select'}}"
                                                                autocomplete="off" ng-focus = "F_CO.TradeIn.getTransferToList()" ng-blur = "F_CO.TradeIn.hideTransferToList();"
                                                                ng-value="F_CO.TradeIn.getSelectedTransferToUnitName(tradeItem)" 
                                                                ng-keyup="M_CO.TradeIn.keyBoardavigation($event, M_CO.TradeIn.transferToUnitList, 'TransferTo',tradeIn_Index);"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced' || F_CO.TradeIn.transferToUnitListDisableCheck()"
                                                            />
                                                            <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="bp-blue downArrow" ng-class = "{'bp-cursorNotAllowed': M_CO.TradeIn.transferToUnitList.length == 0}" ng-click = "F_CO.setFocusOnInput('TradeIn')"></i>
                                                            <div class="searchResultOverlay dropdown-wrapper" id="TransferToDiv" ng-class="{'JobNoResult' : M_CO.TradeIn.transferToUnitList.length == 0 }">
                                                                <ul ng-If="M_CO.TradeIn.transferToUnitList.length > 0">
                                                                    <li ng-repeat="unitModel in M_CO.TradeIn.transferToUnitList track by $index"
                                                                       ng-mousedown="F_CO.TradeIn.selectedTransferToUnit(unitModel, tradeItem, tradeIn_Index)"
                                                                       ng-class="{'selected-row': unitModel.DealItemObj.UnitId == tradeItem.TransferToUnitId}"
                                                                       id="Transfer{{$index}}">
                                                                       <div class="customer-icon">
                                                                          <i ng-include="trustSrc(M_CO.UnitIconPath)" class="blue_3384FF"></i>
                                                                       </div>
                                                                       <div class="customer-info">
                                                                            <span class="bp-autocomplete-text">{{unitModel.DealItemObj.StockNumber ? unitModel.DealItemObj.StockNumber + ', ' : ''}}{{unitModel.DealItemObj.FormattedName}}</span>
                                                                            <span class="bp-section-info">{{ 'Label_Stock' | translate }}#:</span>
                                                                            <span class="bp-section-info">{{unitModel.DealItemObj.StockNumber}}</span>
                                                                            <span class="bp-section-info"> - {{ 'Label_VIN' | translate }}:</span>
                                                                            <span class="bp-section-info">{{unitModel.DealItemObj.VIN}}</span>
                                                                        </div>
                                                                        <div class = "customer-type">
                                                                            <span class="bp-autocomplete-title">{{ 'Stock_unit' | translate }}</span>
                                                                        </div>
                                                                       </li>
                                                                </ul>
                                                                <ul ng-If="M_CO.TradeIn.transferToUnitList.length == 0">
                                                                    <li id="TradeInNoResults" class="BP_angucomplete-row-NoResults-Msg">
                                                                        <div class="">{{ 'No_Results_Found' | translate }}</div>
                                                                    </li>
                                                                </ul>
                                                            </div> 
                                                        </div>
                                                    </div>
                                                </div>
                                                </div>
                                            </div>
                                            <div class="select-customer-section unit tradeInCOUList " ng-If ="M_CO.Deal.TradeInsList[tradeIn_Index].UnitId == null || M_CO.TradeIn.IsCOUSelected">  
                                                <div class="left TradeInput">
                                                    <label class="print-item-label bp-dark-grey2-font">{{ 'Customer_owned_unit_to_trade' | translate }}</label>
                                                    <div class="bp-cell  searchInputArea " ng-class = "{'showingOverlay' : M_CO.TradeIn.showCOUList }">
                                                        <input  type="text" id="TradeIn{{tradeIn_Index}}" class="bp-input-text searchInput" placeholder="{{M_CO.TradeIn.COUList.length > 0 ? 'Please Select' : 'No customer unit to trade'}}"
                                                            autocomplete="off" ng-focus = "F_CO.TradeIn.getCOUList()" ng-blur = "F_CO.TradeIn.hideCOUList()"
                                                            ng-model="M_CO.TradeIn.selectedUnitName" 
                                                            ng-keyup="M_CO.TradeIn.keyBoardavigation($event, M_CO.COUList, 'TradeIn',tradeIn_Index);"
                                                            ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.Deal.DealInfo.DealStatus == 'Invoiced' || M_CO.TradeIn.COUList.length == 0"
                                                                 />

                                                        <i class="bp-icons bp-blue-font bp-font-14 stroke-5 size-unset downArrow" ng-class = "{'bp-cursorNotAllowed': M_CO.TradeIn.COUList.length == 0}" ng-click = "F_CO.setFocusOnInput('TradeIn')">arrowDown</i>
                                                        <div class="searchResultOverlay dropdown-wrapper" id="TradeInDropDownDiv" ng-class="{'JobNoResult' : M_CO.TradeIn.COUList.length == 0 }">
                                                            <ul ng-If="M_CO.COUList.length > 0">
                                                                <li ng-repeat="unitModel in M_CO.TradeIn.COUList | filter:M_CO.TradeIn.selectedUnitName track by $index"
                                                                   ng-mousedown="F_CO.TradeIn.selectedUnit(unitModel)"
                                                                   ng-class="{'selected-row': $index == M_CO.TradeIn.TradeInCurrentIndex}"
                                                                   id="TradeIn{{$index}}">
                                                                   <div class="customer-icon">
                                                                      <i class="bp-icons bp-blue-font bp-font-20 stroke-3">{{M_CO.UnitIconName}}</i>
                                                                   </div>
                                                                   <div class="customer-info">
                                                                        <span class="bp-autocomplete-text">{{unitModel.FormattedName}}</span>
                                                                        <span class="bp-section-info">{{ 'Unit_number' | translate }}:</span>
                                                                        <span class="bp-section-info">{{unitModel.UnitId}}</span>
                                                                        <span class="bp-section-info"> - {{ 'Label_VIN' | translate }}:</span>
                                                                        <span class="bp-section-info">{{unitModel.VIN}}</span>
                                                                    </div>
                                                                    <div class = "customer-type">
                                                                        <span class="bp-autocomplete-title">{{ 'Label_Unit' | translate }}</span>
                                                                    </div>
                                                                   </li>
                                                            </ul>
                                                            <ul ng-If="M_CO.TradeIn.COUList.length == 0">
                                                                <li id="TradeInNoResults" class="BP_angucomplete-row-NoResults-Msg">
                                                                    <div class="">{{ 'No_Results_Found' | translate }}</div>
                                                                </li>
                                                            </ul>
                                                        </div> 
                                                    </div>
                                                </div>
                                                <div class="rightside MT1">
                                                    <button class="bp-btn bp-btn-normal temporary-unit-btn" ng-click="F_CO.saveTradeInUnit(tradeIn_Index)" ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || F_CO.isArchivedQuote() || M_CO.TradeIn.isUnitSelected">{{ 'Label_Select' | translate }}</button>
                                                </div>
                                            </div>
                                            <div class="TradeInput add-customer-owned" ng-if="GroupOnlyPermissions['Deal']['create/modify'] && !F_CO.isArchivedQuote() && (M_CO.Deal.TradeInsList[tradeIn_Index].UnitId == null || M_CO.TradeIn.IsCOUSelected)">
                                                    <a class="bp-blue-font bp-font-14 bp-bold-font" ng-click="F_CO.openAddEditTempUnitPopup(tradeItem.Id, tradeIn_Index, 'Trade In', 'COU')">{{ 'Add_a_new_customer_owned_unit' | translate }}</a>
                                            </div>
                                       </div> 
                                    </div> 
                                </div>
                                <!-- Trade in section ends -->
                                <!-- Start: notes for customer -->
                                <div class="bp-inner-accordian bp-inner-accordian-deal open job-item-notes" ng-if="(M_CO.Deal.DealInfo.NotesForCustomer != null || M_CO.Deal.DealInfo.ShowNotesForCustomer)"
                                    ng-class="{'bp-inner-accordian-opened': M_CO.expandedInnerSectionName == 'Deal_NotesForCustomer'}">
                                    <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInnerSection('Deal_NotesForCustomerSectionId', 'Deal_NotesForCustomer')">
                                        <div class="inner-accordian-header-left">
                                            <h2 class="accordian-left-details">{{ 'Notes_for_customer' | translate }}</h2>
                                        </div>
                                        <div class="accordian-right-details">
                                            <a href="" class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_NotesForCustomer'">
                                                <i class="bp-icons bp-blue-font bp-font-14 stroke-1 size-unset">arrowDown</i>
                                            </a>    
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName == 'Deal_NotesForCustomer'">
                                                <i class="bp-icons bp-blue-font bp-font-14 stroke-1 size-unset">arrowUp</i>
                                            </a>    
                                        </div>
                                    </div>
                                    <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition" id="Deal_NotesForCustomerSectionId"
                                        ng-class="{'bp-expand-div-transition': M_CO.expandedInnerSectionName == 'Deal_NotesForCustomer'}">
                                        <div class="col-md-7 padding-bottom30 padding-top1">
                                            <div class="bp-multiselect" ng-click="F_CO.displayInputForDeal($event, 'NewNote', 'NotesForCustomer', 'Notes')">
                                                <div ng-class="{'padding10': M_CO.Deal.DealInfo.NotesForCustomer.length > 0,'PB0':!(M_CO.displayInputForDeal == 'NotesForCustomer' || F_CO.displayNotesInputForDeal('NotesForCustomer'))}">
                                                    <div ng-repeat="note in M_CO.Deal.DealInfo.NotesForCustomer track by $index" class="d-flex"> 
                                                        <input id="NotesTag{{$index}}" type="text" class="bp-input-text MB10" ng-show="M_CO.editModeIndexMultiSelect['Notes'] == $index" 
                                                               ng-model="M_CO.Deal.DealInfo.NotesForCustomer[$index]"
                                                               ng-blur="F_CO.updateMultiSelectForDeal($event,$index, 'NotesForCustomer', 'Notes')"
                                                               ng-keydown="F_CO.updateMultiSelectForDeal($event,$index, 'NotesForCustomer', 'Notes')"
                                                               ng-disabled="!(GroupOnlyPermissions['Deal']['create/modify'])"
                                                               maxlength="1500" />
                                                        <span ng-click="F_CO.editMultiselectTagForDeal($event,'NotesForCustomer','Notes',$index);" ng-show="M_CO.editModeIndexMultiSelect['Notes'] != $index">
                                                            {{note}}
                                                         <i  ng-if="(GroupOnlyPermissions['Deal']['create/modify'])" 
                                                         ng-click = "F_CO.showNotesFlyoutForDeal($event,$index, 'NotesForCustomer','Notes')" class="bp-icons bp-blue-font bp-font-14 LIDeleteBtn">moreAction</i>
                                                        </span>
                                                    </div>
                                                    <input type="text" class="bp-input-text" ng-show="M_CO.displayInputForDeal == 'NotesForCustomer' || F_CO.displayNotesInputForDeal('NotesForCustomer')" id="Notes"
                                                        ng-model="M_CO.Deal.DealInfo.NewNotesForCustomer"
                                                        ng-keydown="F_CO.addAndRemoveFromMultiSelectForDeal($event,'NewNotesForCustomer','NotesForCustomer','Notes')"
                                                        ng-blur="F_CO.addAndRemoveFromMultiSelectForDeal($event,'NewNotesForCustomer','NotesForCustomer','Notes')"
                                                        placeholder="{{ 'Label_Notes' | translate }}" rel="Note"
                                                        ng-disabled="!(GroupOnlyPermissions['Deal']['create/modify'])"
                                                        maxlength="1500" />
                                                </div>  
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- End: notes for customer -->
                                 <!-- Start: Deal: Document Section -->
                                <co-document-section inner-accordian-wrapper-class-value="bp-inner-accordian bp-inner-accordian-deal open" 
                                    expand-collapse-inner-accordian="F_CO.expandOrCollapseInnerSection('Deal_DocumentSectionId', 'Deal_DocumentSection')"
                                    is-inner-section-expanded="M_CO.expandedInnerSectionName === 'Deal_DocumentSection'"
                                    inner-accordian-body-wrapper-id-value="Deal_DocumentSectionId"
                                    is-co-closed="M_CO.coHeaderRec.OrderStatus === 'Closed'"
                                    form-list="M_CO.documents.forms.deal[M_CO.Deal.DealInfo.Id]"
                                    attachment-list="M_CO.documents.attachments.deal[M_CO.Deal.DealInfo.Id]"
                                    add-form-action="F_CO.addFormsToSection(M_CO.Deal.DealInfo.Id, 'deal');"
                                    delete-form-action="F_CO.deleteFormsFromSection(formId, M_CO.Deal.DealInfo.Id, 'deal');"
                                    delete-attachment-action="F_CO.deleteAttachmentFromSection(attachmentId, M_CO.Deal.DealInfo.Id, 'deal');"
                                    print-document-action="F_CO.printDocument(docUrl, coFormId, isEditable, formEditConfig, editModalName,formName,isLandscapeMode,isAttachment)"
                                    attachment-file-upload-interface-modal="FileUpload.interface"
                                    set-add-attachment-data="F_CO.setAttachmentData(M_CO.Deal.DealInfo.Id, 'deal');"
                                    active-form-count="M_CO.documents.sectionNameToActiveFormCountMap['Deal']"
                                    active-forms="M_CO.documents.activeForms.deal[M_CO.Deal.DealInfo.Id]"
                                    section-status="M_CO.Deal.DealInfo.DealStatus"
                                    section-name="Deal"
                                    print-all-form-action="F_CO.printAllFormAction(M_CO.documents.forms.deal[M_CO.Deal.DealInfo.Id])" />
                                <!-- End: Deal: Document Section -->
                                
                                 <!-- Start: Deal actions accordian start here -->
                                <div class="bp-inner-accordian open always-open deal-action bp-inner-accordian-last-child" ng-if = "F_CO.showActionSubSection('Deal')">
                                    <div class="inner-accordian-header col-md-12">
                                        <div class="inner-accordian-header-left">
                                            <h2 class="accordian-left-details">{{ 'Deal_actions' | translate }}</h2>
                                        </div>
                                        <div class="accordian-action-right"
                                            ng-if="GroupOnlyPermissions['Deal']['create/modify'] && !F_CO.isArchivedQuote() &&
                                            M_CO.Deal.DealInfo.DealStatus == 'Quotation' &&
                                            (M_CO.Deal.UnitList.length == 0 || (M_CO.Deal.UnitList.length == 1 && !M_CO.Deal.UnitList[0].DealItemObj.UnitId && M_CO.Deal.UnitList[0].DealKitHeaderList.length == 0))
                                            && !F_CO.TradeIn.isAnyCOUStocked()">
                                            <span class="icon-container" ng-click="F_CO.openConfirmationDialog('RemoveSection', false, 'Deal');">
                                                <i class="bp-icons bp-blue-font bp-fw-100 bp-lh-20 bp-font-19">delete</i>
                                                <span class="bp-font-14 bp-blue-font bp-cursor-pointer">{{'Remove_deal_Label' | translate }}</span>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="inner-accordian-body col-md-12">
                                        <ul class="job-actions-buttons">
                                            <li ng-repeat = "dealAction in M_CO.DealAction" 
                                                id="deal_Action{{$index}}" ng-if="F_CO.displayDealAction(dealAction)" ng-click="F_CO.dealActionToBePerformed(dealAction)"
                                                ng-class = "{'disableDealAction':F_CO.disabledDealAction(dealAction)}">
                                                <a>
                                                    <i class="bp-icons stroke-5">addCircle</i> 
                                                    {{ dealAction | translate }}
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <!-- End: Deal actions accordian end here -->
                             </div>
                        </div>
                    </div>
                    <bp-ng-modal-window id-val="priceVarianceWarning" mobal-window-payload="M_CO.ModalWindowPayload" cancel-btn-action="F_CO.closePriceVarianceWarningModal()" primary-btn-action="F_CO.closePriceVarianceWarningModal()">
                        <div>
                            <span>
                                <p class="modal-window-message-info">{{ 'Price_variance_warning_message' | translate }}</p>
                            </span>
                        </div>
                    </bp-ng-modal-window>
                    <!-- End: unit deal -->
</apex:component>